<html>
<head>
<title>Displaying IPFS and Arweave TxIDs With Stored Bytes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用存储的字节显示IPFS和Arweave TxIDs</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/displaying-ipfs-and-arweave-txids-with-stored-bytes-f9a40a8d2317?source=collection_archive---------14-----------------------#2022-02-07">https://medium.com/coinmonks/displaying-ipfs-and-arweave-txids-with-stored-bytes-f9a40a8d2317?source=collection_archive---------14-----------------------#2022-02-07</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/923cbc3c5ddd0c8f4fbd3852f735bb7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*arnUkDrPCEhXpxI35DTHKQ.png"/></div></div></figure><p id="e5d2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在我们的<a class="ae jz" rel="noopener" href="/@21MMPixels/efficiently-storing-ipfs-hashes-in-our-nft-2ff972590c8c">上一篇文章</a>中，我介绍了<a class="ae jz" href="https://21mmpixels.com" rel="noopener ugc nofollow" target="_blank">21兆像素</a>合同视图函数，这些函数将<a class="ae jz" href="https://ipfs.io" rel="noopener ugc nofollow" target="_blank"> IPFS </a> Base32内容标识符(IPFS cidV1)和<a class="ae jz" href="https://arweave.org" rel="noopener ugc nofollow" target="_blank"> Arweave </a> Base64URL事务id编码到我们用来存储2100万像素的NFT瓦片的图像链接的结构中。接下来，我将简要解释将存储的信息转换回人类可读格式的contracts视图函数。</p><p id="77aa" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">21MMpixels<a class="ae jz" href="https://etherscan.io/address/0x7dd7aa4b560692c882d982312c0b53b24c51523a#code" rel="noopener ugc nofollow" target="_blank">contract</a><em class="ka">token img</em>函数是查看组成21 mmpixels映像的任何NFT的映像集的入口点。该功能从读取给定图块的<em class="ka">赎回指令</em>开始。<em class="ka">resumed struct</em>的bytes1 <em class="ka"> multibase </em>域决定了我们用来解码图像链接的函数。今天，我们将重点关注契约定义的<em class="ka">多基</em>的两种可能性，编码为0x62 (Base32大写)或0x42 (Base32小写)的IPFS，以及编码为0x01的Arweave事务id。</p><p id="5dc0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在IPFS图像链接的情况下，我们首先使用两个字节30摘要、<em class="ka">多库</em>和存储的<em class="ka">长度</em>来调用我们的<em class="ka">bytearraystobase 32 string</em>函数。如果使用的<em class="ka">长度</em>超过240位(30字节* 8位/字节)，我们将调用<em class="ka">_ bytes 30 torsing</em>两次，首先调用长度为48 (240位除以5位/字符)的第一个摘要和<em class="ka">多基址</em>，然后调用长度为(存储长度减去240)除以5的第二个摘要和<em class="ka">多基址</em>。如果使用的长度小于241位，我们将简单地使用第一个摘要的<em class="ka">_ bytes 30 torting</em>的结果，长度<em class="ka">除以5的大小，以及<em class="ka">多基址</em>。</em></p><p id="ca3e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">用3个变量调用的<em class="ka">_ Bytes 30 transisting</em>函数返回一个字节数组，代表一个UTF8编码的字符串。该函数创建一个新的字节变量(<em class="ka">字节数组</em>)，其长度等于被调用的<em class="ka">长度</em>，表示字符数。对于Base32，我们基于<em class="ka">多基</em>定义了uint 8<em class="ka">add和</em>，base 32 low等于65，Base32Upper等于97。然后，我们进入for循环，该循环利用两个功能，将<em class="ka"> i </em>从0设置为<em class="ka">长度</em>。在每个循环中，我们首先调用函数<em class="ka"> _get5BitsAsUint </em>，用byes 30<em class="ka">输入</em>，用<em class="ka"> i </em>。</p><p id="197f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="ka"> _get5BitsAsUint </em>函数从字节30的输入(<em class="ka"> temp </em>)创建一个临时变量，左移(<em class="ka"> &lt; &lt; </em>)调用函数中的<em class="ka"> i </em>生成temp变量，在该函数中被命名为<em class="ka"> position </em>，乘以5。然后，我们创建一个字节30掩码0xf8，后跟28个零，在二进制中是5个1，后跟235个零。我们使用按位“与”运算符(<em class="ka"> &amp; </em>)来组合掩码和<em class="ka"> temp </em>变量。最后，我们将<em class="ka">&gt;&gt;</em>)<em class="ka">temp</em>右移235°，并返回一个uint8与<em class="ka">uint 8(uint 240)((temp))</em>。</p><p id="a721" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="ka"> _get5BitsAsUint </em>函数的结果用于将结果和<em class="ka">add及</em>一起调用<em class="ka"> _uintToChar </em>。此<em class="ka"> _uintToChar </em>函数返回一个代表UTF8字符代码的字节1。如果转换后的uint8小于26(代表一个字母)，则返回uint8加上<em class="ka">add和</em>。如果转换后的uint8大于25(代表一个数字)，它将返回uint 8+24。<em class="ka"> _uintToChar </em>返回的结果被添加到<em class="ka">by array</em>变量中的<em class="ka"> i </em>字节位置。</p><p id="5940" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">使用函数<em class="ka">将<em class="ka">_ bytes 30 testing】返回的字节转换为UTF8字符串(bytes . concat(_ bytes 30 testing result))</em>。</em></p><p id="2db6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">存储的Arweave交易id的转换功能与IPFS转换非常相似。我将简要介绍这些差异。</p><p id="f842" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="ka">bytearraytabase 64 string</em>函数使用了不同的<em class="ka">_ bytes30 thrusting</em>函数，这个函数与bytes 30摘要和<em class="ka">长度</em>一起调用。该函数用一个变量调用两个函数<em class="ka"> _get6BitsAsUint </em>和<em class="ka"> _uintToChar </em>。</p><p id="ec4b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="ka"> _get6BitsAsUint </em>函数与<em class="ka"> _get5BitsAsUint </em>函数的不同之处在于，它首先左移<em class="ka">位置</em>乘以6 (Base64使用每个字符6位)，字节30掩码以0xfc开始，代表6个1，后跟234个0，最后右移234。</p><p id="0fd8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">用于Arweave Base64转换的<em class="ka"> _uintToChar </em>函数由<em class="ka"> _get6BitsAsUint </em>的uint8结果(<em class="ka"> _conv </em>)调用，没有<em class="ka">add和</em>。该函数返回<em class="ka"> _conv </em> + 65中的字节1，代表<em class="ka"> _conv </em> &lt; 26(字母字符“A”—“Z”)；返回<em class="ka"> _conv </em> + 71，代表<em class="ka"> _conv </em> &lt; 52(字母字符“A”—“Z”)；返回<em class="ka"> _conv </em> — 4(数字“0”—“9”)；返回<em class="ka"> _conv </em> — 17，代表<em class="ka"> _conv</em></p><p id="ac04" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">由于Base32和Base64操作的2100万像素合约中使用的所有函数都是视图函数，因此我们没有必要对这些函数进行gas优化。我们很乐意回答任何问题，并欢迎任何反馈。</p><blockquote class="kb"><p id="e4a0" class="kc kd ht bd ke kf kg kh ki kj kk jy ek translated">加入Coinmonks <a class="ae jz" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jz" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h2 id="594f" class="kl km ht bd kn ko kp kq kr ks kt ku kv jm kw kx ky jq kz la lb ju lc ld le lf dt translated">也阅读</h2><div class="lg lh fm fo li lj"><a href="https://coincodecap.com/blockfi-review" rel="noopener  ugc nofollow" target="_blank"><div class="lk ab ej"><div class="ll ab lm cl cj ln"><h2 class="bd hu fv z el lo eo ep lp er et hs dt translated">BlockFi评论:2022年的利弊和利率</h2><div class="lq l"><h3 class="bd b fv z el lo eo ep lp er et ek translated">今天，我们提出了一个全面的BlockFi评论，这是一个成立于2017年的加密贷款平台，拥有其…</h3></div><div class="lr l"><p class="bd b gc z el lo eo ep lp er et ek translated">coincodecap.com</p></div></div><div class="ls l"><div class="lt l lu lv lw ls lx iz lj"/></div></div></a></div><div class="lg lh fm fo li lj"><a rel="noopener follow" target="_blank" href="/coinmonks/buy-bitcoin-in-india-feb50ddfef94"><div class="lk ab ej"><div class="ll ab lm cl cj ln"><h2 class="bd hu fv z el lo eo ep lp er et hs dt translated">如何在印度购买比特币？2021年购买比特币的7款最佳应用[手机版]</h2><div class="lq l"><h3 class="bd b fv z el lo eo ep lp er et ek translated">如何使用移动应用程序购买比特币印度</h3></div><div class="lr l"><p class="bd b gc z el lo eo ep lp er et ek translated">medium.com</p></div></div><div class="ls l"><div class="ly l lu lv lw ls lx iz lj"/></div></div></a></div><div class="lg lh fm fo li lj"><a rel="noopener follow" target="_blank" href="/coinmonks/best-crypto-tax-tool-for-my-money-72d4b430816b"><div class="lk ab ej"><div class="ll ab lm cl cj ln"><h2 class="bd hu fv z el lo eo ep lp er et hs dt translated">加密税务软件——五大最佳比特币税务计算器[2021]</h2><div class="lq l"><h3 class="bd b fv z el lo eo ep lp er et ek translated">不管你是刚接触加密还是已经在这个领域呆了一段时间，你都需要交税。</h3></div><div class="lr l"><p class="bd b gc z el lo eo ep lp er et ek translated">medium.com</p></div></div><div class="ls l"><div class="lz l lu lv lw ls lx iz lj"/></div></div></a></div><div class="lg lh fm fo li lj"><a href="https://coincodecap.com/crypto-to-buy-in-2022" rel="noopener  ugc nofollow" target="_blank"><div class="lk ab ej"><div class="ll ab lm cl cj ln"><h2 class="bd hu fv z el lo eo ep lp er et hs dt translated">9个2022年最值得购买的密码| CoinCodeCap</h2><div class="lq l"><h3 class="bd b fv z el lo eo ep lp er et ek translated">9个2022年最值得购买的加密产品阅读加密产品评论和比较，了解比特币交易和…</h3></div><div class="lr l"><p class="bd b gc z el lo eo ep lp er et ek translated">coincodecap.com</p></div></div><div class="ls l"><div class="ma l lu lv lw ls lx iz lj"/></div></div></a></div><div class="lg lh fm fo li lj"><a href="https://coincodecap.com/best-hardware-wallet-bitcoin" rel="noopener  ugc nofollow" target="_blank"><div class="lk ab ej"><div class="ll ab lm cl cj ln"><h2 class="bd hu fv z el lo eo ep lp er et hs dt translated">存储比特币的最佳加密硬件钱包2022 | CoinCodeCap</h2><div class="lq l"><h3 class="bd b fv z el lo eo ep lp er et ek translated">硬件钱包是我们存储加密资产的唯一可靠选择。在本文中，我们将讨论8个…</h3></div><div class="lr l"><p class="bd b gc z el lo eo ep lp er et ek translated">coincodecap.com</p></div></div><div class="ls l"><div class="mb l lu lv lw ls lx iz lj"/></div></div></a></div><div class="lg lh fm fo li lj"><a rel="noopener follow" target="_blank" href="/coinmonks/pionex-review-exchange-with-crypto-trading-bot-1e459d0191ea"><div class="lk ab ej"><div class="ll ab lm cl cj ln"><h2 class="bd hu fv z el lo eo ep lp er et hs dt translated">Pionex评论2021 |免费加密交易机器人和交换</h2><div class="lq l"><h3 class="bd b fv z el lo eo ep lp er et ek translated">Pionex是为交易自动化提供工具的后起之秀。Pionex上提供了9个加密交易机器人…</h3></div><div class="lr l"><p class="bd b gc z el lo eo ep lp er et ek translated">medium.com</p></div></div><div class="ls l"><div class="mc l lu lv lw ls lx iz lj"/></div></div></a></div></div></div>    
</body>
</html>