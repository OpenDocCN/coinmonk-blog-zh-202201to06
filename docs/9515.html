<html>
<head>
<title>Analysis of the Harmony astronomical price loss</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">和谐天价损失分析</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/analysis-of-the-harmony-astronomical-price-loss-b0d18864f29?source=collection_archive---------23-----------------------#2022-06-28">https://medium.com/coinmonks/analysis-of-the-harmony-astronomical-price-loss-b0d18864f29?source=collection_archive---------23-----------------------#2022-06-28</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/0fa85fdd57b83e4e8f4a8baf2a411d20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lYGDdE9JsZzzvBbwyZPcCw.jpeg"/></div></div></figure><p id="8f1c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> 0x01事件背景</strong></p><p id="d018" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">2022年6月24日，以太坊与和谐之间由Layer1公链Harmony开发的资产跨链桥Horizon遭到攻击，损失约1亿美元。</p><p id="4d0c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> 0x02攻击者信息</strong></p><p id="fa9f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">攻击者钱包</strong></p><p id="7637" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">0x0d 043128146654 c 7683 fbf 30 AC 98d 7 b 2285 ded 00</p><p id="ce52" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">0x 9 e 91 AE 672 e 7 f 7330 fc 6b 9 Bab 9 c 259 BD 94 CD 08715</p><p id="73cc" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">0x 58 F4 baccb 411 acef 70 a5 F6 DD 174 af 7854 fc 48 fa 9</p><p id="7b2a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> MultiSigWallet </strong></p><p id="295e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">0x 715 cdda 5 e 9 ad 30a ced 14940 f 9997 ee 611496 de 6</p><p id="6baa" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">艾思曼纳格</strong></p><p id="5290" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">0 xf 9 fb1 c 508 ff 49 f 78 b 60d 3 a 96 de a99 fa 5d 7 F3 A8 a 6</p><p id="df86" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> 0x03攻击分析</strong></p><p id="5357" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">攻击者获得13，100 ETH和5，000 BNB的契约调用过程是相同的。本文主要分析这两种交易。<br/>这两笔交易是</p><p id="0f1a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><a class="ae jz" href="https://etherscan.io/tx/0x27981c7289c372e601c9475e5b5466310be18ed10b59d1ac840145f6e7804c97" rel="noopener ugc nofollow" target="_blank">https://ethers can . io/tx/0x 27981 c 7289 c 372 e 601 c 9475 e5b 5466310 be 18 ed 10 b 59 D1 AC 840145 f 6e 7804 c 97</a></p><p id="81cb" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><a class="ae jz" href="https://bscscan.com/tx/0xa72c7262340c25b9258b33dcad089cb3473ed048d1f808f436a96b8ed577cdb1" rel="noopener ugc nofollow" target="_blank">https://bscscan . com/tx/0xa 72 c 7262340 c 25 b 9258 b 33 dcad 089 CB 3473 ed 048 D1 f 808 f 436 a 96 b 8 ed 577 CD 1</a></p><p id="d28e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">上述交易流程如下:</p><p id="dfc3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">第一步</p><p id="6518" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">地址0 xf 845 a7ee 8477 ad 1 FB 4446651 e 548901 a 2635 a 915调用MultiSigWallet组合系统中的<strong class="jd hu"> addTransaction </strong>方法，向事务映射添加新事务。</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ka"><img src="../Images/d274c378388141fa2bc7c159565398b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*49YbzG7quN1t6bsIkT18SA.png"/></div></div></figure><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff kf"><img src="../Images/6b62a01856fecb64207d16aa95ce151f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vLdnx3Ez3gWhFyK-34yhQw.png"/></div></div></figure><p id="ca37" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">第二步</p><p id="9d52" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">0x 812d 8622 c6f 3c 45959439 e 7 ede 3c 580 da 06 F8 f 25</strong>地址调用MultiSigWallet契约中的<strong class="jd hu"> confirmTransaction </strong>方法传入映射的交易id。</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff kg"><img src="../Images/631ce2e71af118c877592652b12f9152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kEa9Fy_czfD0VKfxplN0tA.png"/></div></div></figure><p id="0ec6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">注意:<strong class="jd hu"> confirmTransaction </strong>只能由钱包管理员调用。通过分析，管理员是部署合同时已经确定的管理员地址。按如下方式部署合同事务:</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div class="fe ff kh"><img src="../Images/ed22ac6c2c931693562d5e8da01e81af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*MKc082rDj-09xT1LooWObg.png"/></div></figure><p id="481b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">很明显，以上两个步骤是管理员调用的。</p><p id="b37f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">第三步:</p><p id="9348" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">第二步，方法内部最终调用<strong class="jd hu"> executeTransaction </strong>方法，然后调用<strong class="jd hu"> isConfirmed </strong>方法进行判断。</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div class="fe ff ki"><img src="../Images/5c644f7ebcd1d1160304542055727a4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*WAM20rRUnX7_St8u5GD2kQ.png"/></div></figure><p id="1ff6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> isConfirmed </strong>方法根据该值决定事件是否通过，需要两个管理员成功执行。</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div class="fe ff kj"><img src="../Images/845a7978efa5f57936418e77c692ef2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*u5njgj7dfS2ZYRWSzmJz6w.png"/></div></figure><p id="db0d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在方法内部调用<strong class="jd hu">ETH manager</strong>contract<strong class="jd hu">unlocket</strong>方法，最终将ETH/BNB资金发送到攻击者的钱包。</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff kk"><img src="../Images/bf4989c6e2e73b9eb65af171298cf820.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*ovMwAna0w1exh6XsWz3GWQ.png"/></div></div></figure><p id="dd82" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> 0x05资金流向</strong></p><p id="9fef" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">令牌信息被ETH链中的攻击者窃取:</p><p id="3e8e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">13100乙醚</p><p id="f593" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">4120万USDC</p><p id="960f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">WBTC街592号</p><p id="9fa8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">998.1万USDT</p><p id="bfd5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">607万戴</p><p id="c5b5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">553万BUSD</p><p id="5317" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">8462万AAG</p><p id="19b1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">11万FXS</p><p id="bf53" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">415，000个寿司</p><p id="bba0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">990号</p><p id="c855" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">43 WETH</p><p id="7cf5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">562万FRAX</p><p id="8e9c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">攻击者通过一系列交换交易将获得的一部分Erc20令牌转换成以太网</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff kl"><img src="../Images/d70b5f5b5be69b7710e16a429856dfa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tosa99KcEYSP9bmCIM7FSw.png"/></div></div></figure><p id="8d35" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">BSC链中攻击者窃取的令牌信息:</p><p id="5bf1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">5000 BNB 64万BUSD</p><p id="8766" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">攻击者通过这两个连锁店总共获利1亿美元。</p><p id="c381" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> 0x06摘要</strong></p><p id="ac8e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">从上面的攻击来看，攻击方法是在多重签名契约中控制钱包的私钥。由于资金的转移只需要两个地址的同意，当攻击者控制了这两个地址的钱包私钥时，攻击者的转移就在跨链中被批准了。资金交易会导致资金被盗。</p><p id="fad3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> </strong>建议转账时增加多签名地址的数量，避免通过控制少量地址的私钥进行转账；</p><p id="71aa" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> </strong>建议安全存储多签名地址的私钥，避免将私钥存储在云端或易受攻击的服务器上<strong class="jd hu">。</strong></p><blockquote class="km"><p id="c7b6" class="kn ko ht bd kp kq kr ks kt ku kv jy ek translated">加入Coinmonks <a class="ae jz" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jz" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="8967" class="kw kx ht bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt dt translated">另外，阅读</h1><ul class=""><li id="07d2" class="lu lv ht jd b je lw ji lx jm ly jq lz ju ma jy mb mc md me dt translated"><a class="ae jz" href="https://coincodecap.com/bookmap-review-2021-best-trading-software" rel="noopener ugc nofollow" target="_blank"> Bookmap评论</a> | <a class="ae jz" href="https://coincodecap.com/crypto-exchange-usa" rel="noopener ugc nofollow" target="_blank">美国5大最佳加密交易所</a></li><li id="7923" class="lu lv ht jd b je mf ji mg jm mh jq mi ju mj jy mb mc md me dt translated"><a class="ae jz" href="https://coincodecap.com/ftx-futures-trading" rel="noopener ugc nofollow" target="_blank">如何在FTX交易所交易期货</a> | <a class="ae jz" href="https://coincodecap.com/okex-vs-binance" rel="noopener ugc nofollow" target="_blank"> OKEx vs币安</a></li><li id="8f28" class="lu lv ht jd b je mf ji mg jm mh jq mi ju mj jy mb mc md me dt translated"><a class="ae jz" href="https://coincodecap.com/coinloan-review" rel="noopener ugc nofollow" target="_blank"> CoinLoan评论</a> | <a class="ae jz" rel="noopener" href="/coinmonks/youhodler-4-easy-ways-to-make-money-98969b9689f2"> YouHodler评论</a> | <a class="ae jz" href="https://coincodecap.com/blockfi-review" rel="noopener ugc nofollow" target="_blank"> BlockFi评论</a></li><li id="790e" class="lu lv ht jd b je mf ji mg jm mh jq mi ju mj jy mb mc md me dt translated"><a class="ae jz" href="https://coincodecap.com/profittradingapp-for-binance" rel="noopener ugc nofollow" target="_blank">XT.COM评论</a>币安评论 | <a class="ae jz" href="https://coincodecap.com/xt-com-review" rel="noopener ugc nofollow" target="_blank"/></li><li id="4c97" class="lu lv ht jd b je mf ji mg jm mh jq mi ju mj jy mb mc md me dt translated"><a class="ae jz" href="https://coincodecap.com/smithbot-review" rel="noopener ugc nofollow" target="_blank"> SmithBot评论</a> | <a class="ae jz" href="https://coincodecap.com/free-open-source-trading-bots" rel="noopener ugc nofollow" target="_blank"> 4款最佳免费开源交易机器人</a></li><li id="41ce" class="lu lv ht jd b je mf ji mg jm mh jq mi ju mj jy mb mc md me dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/coinbase-bots-ac6359e897f3">比特币基地僵尸程序</a> | <a class="ae jz" rel="noopener" href="/coinmonks/ascendex-review-53e829cf75fa"> AscendEX审查</a> | <a class="ae jz" rel="noopener" href="/coinmonks/okex-trading-bots-234920f61e60"> OKEx交易僵尸程序</a></li></ul></div></div>    
</body>
</html>