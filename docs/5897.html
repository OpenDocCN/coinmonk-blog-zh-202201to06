<html>
<head>
<title>Loss Exceeds $80M Due to Reentrancy Vulnerability in Contract: Beosin’s Analysis of the FeiProtocol Exploit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">由于合同中的可重入漏洞，损失超过8000万美元:Beosin对FeiProtocol漏洞的分析</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/loss-exceeds-80m-due-to-reentrancy-vulnerability-in-contract-beosins-analysis-of-the-882742f5f248?source=collection_archive---------15-----------------------#2022-04-30">https://medium.com/coinmonks/loss-exceeds-80m-due-to-reentrancy-vulnerability-in-contract-beosins-analysis-of-the-882742f5f248?source=collection_archive---------15-----------------------#2022-04-30</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="9c60" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2022年4月30日<strong class="is hu">据Beosin EagleEye报道，FeiProtocol的Rari熔丝池被开采了约28380美元ETH。</strong> Beosin安全团队对事件进行了分析，结果如下所示。</p><h1 id="6a39" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated"><strong class="ak">费协议简介</strong></h1><p id="505d" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated">Rari Capital通过创造新的机会、社区和金融产品，让个人能够挣脱束缚。官网:【https://rari.capital/】T4</p><h1 id="9c93" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated"><strong class="ak">相关信息</strong></h1><p id="bda1" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated">由于利用了多个合同，这里只分析一个交易。</p><p id="8632" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">交易哈希:</strong></p><p id="9a1c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">0 xab 486012 f 21 be 741 c 9 e 674 ffda 227 e 30518 E8 a1 e 37 a5 f1 d 58d 0 b 0d 41 f 6e 76530</p><p id="6ed3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">黑客地址:</strong></p><p id="ce62" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">0x 6162759 edad 730152 f0df 8115 c 698 a 42e 666157 f</p><p id="80a7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">黑客契约:</strong></p><p id="e219" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">0x 32075 bad 9050d 4767018084 f 0 CB 87 b 3182d 36 c 45</p><p id="3b8d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">受害人合同:</strong></p><p id="9721" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">0x 26267 e 41 ECA 7 c8 e0f 143554 af 707336 f 27 fa 051</strong></p><h1 id="618b" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated"><strong class="ak">开采流程</strong></h1><ol class=""><li id="85c4" class="ks kt ht is b it km ix kn jb ku jf kv jj kw jn kx ky kz la dt translated">黑客第一次flashloans从平衡器:金库。</li></ol><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lb"><img src="../Images/f63dd6aaa72c2cac3f1287d0fd3bae7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AdYOv_czZFBhpGRABWCfwQ.png"/></div></div></figure><p id="8ecc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2.由于在Rari Capital的其他实施合同中存在可重入性，使用flashloan中的资金在Rari Capital中进行抵押贷款。</p><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff ln"><img src="../Images/8e58bc8bd01083b207574602c6281364.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rTUrhQ6GZePocdi6fbYgxw.png"/></div></div></figure><p id="d9ee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">攻击者通过回调契约中构造的攻击函数，收回池中受协议影响的所有令牌。</p><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lo"><img src="../Images/95ee54d4e487414b04832e1f7e379149.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SHrM1aIAarhJaDFfDdpl8w.png"/></div></div></figure><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lp"><img src="../Images/ccb028891fc68a93391ff068f5ce698d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z49JW2NfFRCVKCKmuhEbxw.png"/></div></div></figure><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lq"><img src="../Images/27b5dbaa663ebdead5207411b972f5b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*urc1q5Pj5N5cxA1v6TeWWA.png"/></div></div></figure><p id="22ab" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">3.返回flashlaon并将获利资金发送到0xe39f合约。</p><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lb"><img src="../Images/9b04d6d1898751857e6db9d9de32bc4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_7h0oILgapLZuKdKrccnhw.png"/></div></div></figure><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lr"><img src="../Images/aa6af446ccee0f191ed4e11df0f59435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B1eG6N2SXtOGXzwq6byD8A.png"/></div></div></figure><h1 id="be5c" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated"><strong class="ak">漏洞分析</strong></h1><p id="be41" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated">这次攻击主要利用了Rari Capital的其他实现合同中的一个可重入漏洞<strong class="is hu">。</strong></p><h1 id="53de" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated"><strong class="ak">资金追踪</strong></h1><p id="5d69" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated">截至本文撰写之时，被盗资金估计超过<strong class="is hu">28，380 ETH(约8034万美元)</strong>和<strong class="is hu">目前正存入TornadoCash </strong>，其中大部分仍在黑客的地址。</p><h1 id="f7d3" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated"><strong class="ak">总结</strong></h1><p id="ef15" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated">针对这一事件，Beosin安全团队建议:</p><p id="e396" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">1.<strong class="is hu">进行ETH传输时，请谨慎使用call.value。确保不会发生重入。</strong></p><p id="e873" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2.项目上线前，强烈建议选择专业的安全审计公司进行全面的安全审计，规避安全风险。</p><p id="44f3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您需要任何区块链安全服务，请联系我们:</p><p id="160f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae kr" href="https://beosin.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">网站</strong> </a> <strong class="is hu"> </strong> <a class="ae kr" href="http://contact@beosin.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">邮箱</strong> </a> <strong class="is hu"> </strong> <a class="ae kr" href="https://twitter.com/Beosin_com" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">官方推特</strong> </a> <strong class="is hu"> </strong> <a class="ae kr" href="https://twitter.com/BeosinAlert" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">预警</strong> </a> <strong class="is hu"> </strong> <a class="ae kr" href="https://t.me/beosin" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">电报</strong></a><strong class="is hu"/><a class="ae kr" href="https://www.linkedin.com/company/beosin" rel="noopener ugc nofollow" target="_blank"><strong class="is hu">LinkedIn</strong></a></p><blockquote class="ls"><p id="e281" class="lt lu ht bd lv lw lx ly lz ma mb jn ek translated">加入Coinmonks <a class="ae kr" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae kr" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="0e0c" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz mc kb kc kd md kf kg kh me kj kk kl dt translated">另外，阅读</h1><ul class=""><li id="5112" class="ks kt ht is b it km ix kn jb ku jf kv jj kw jn mf ky kz la dt translated"><a class="ae kr" href="https://coincodecap.com/5-best-crypto-trading-bots-in-canada" rel="noopener ugc nofollow" target="_blank">加拿大最佳加密交易机器人</a> | <a class="ae kr" href="https://coincodecap.com/bybit-binance-moonxbt" rel="noopener ugc nofollow" target="_blank"> Bybit vs币安</a></li><li id="3ac7" class="ks kt ht is b it mg ix mh jb mi jf mj jj mk jn mf ky kz la dt translated"><a class="ae kr" href="https://coincodecap.com/best-crypto-exchanges-in-uae" rel="noopener ugc nofollow" target="_blank">阿联酋5大最佳加密交易所</a> | <a class="ae kr" href="https://coincodecap.com/simpleswap-review" rel="noopener ugc nofollow" target="_blank"> SimpleSwap评论</a></li><li id="9601" class="ks kt ht is b it mg ix mh jb mi jf mj jj mk jn mf ky kz la dt translated"><a class="ae kr" href="https://coincodecap.com/ways-to-buy-dogecoin" rel="noopener ugc nofollow" target="_blank">购买Dogecoin的7种最佳方式</a> | <a class="ae kr" href="https://coincodecap.com/zebpay-review" rel="noopener ugc nofollow" target="_blank"> ZebPay评论</a></li><li id="4bd2" class="ks kt ht is b it mg ix mh jb mi jf mj jj mk jn mf ky kz la dt translated"><a class="ae kr" href="https://coincodecap.com/futures-trading-signals" rel="noopener ugc nofollow" target="_blank">最佳期货交易信号</a> | <a class="ae kr" href="https://coincodecap.com/liquid-exchange-review" rel="noopener ugc nofollow" target="_blank">流动性交易所评论</a></li><li id="8d23" class="ks kt ht is b it mg ix mh jb mi jf mj jj mk jn mf ky kz la dt translated"><a class="ae kr" href="https://coincodecap.com/huobi-crypto-trading-signals" rel="noopener ugc nofollow" target="_blank">用于Huobi的加密交易信号</a> | <a class="ae kr" rel="noopener" href="/coinmonks/swapzone-review-crypto-exchange-data-aggregator-e0ad78e55ed7"> Swapzone审查</a></li></ul></div></div>    
</body>
</html>