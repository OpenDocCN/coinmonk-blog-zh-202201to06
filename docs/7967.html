<html>
<head>
<title>BLS Signatures on Bitcoin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">比特币上的BLS签名</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/bls-signatures-on-bitcoin-fc837c799380?source=collection_archive---------10-----------------------#2022-06-03">https://medium.com/coinmonks/bls-signatures-on-bitcoin-fc837c799380?source=collection_archive---------10-----------------------#2022-06-03</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="3856" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">基于配对的密码学:第2部分</h2></div><p id="f118" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">Boneh-Lynn-Shacham  (BLS)是基于<a class="ae ke" href="https://xiaohuiliu.medium.com/bilinear-pairings-on-bitcoin-57260fdbc81a" rel="noopener">双线性对</a>的签名方案。</p><p id="ebbb" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">与<a class="ae ke" href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" rel="noopener ugc nofollow" target="_blank"> ECDSA </a>或<a class="ae ke" href="https://en.wikipedia.org/wiki/Schnorr_signature" rel="noopener ugc nofollow" target="_blank"> Schnorr </a>签名相比，它有几个显著的优势:</p><ul class=""><li id="42c6" class="kf kg ht jk b jl jm jo jp jr kh jv ki jz kj kd kk kl km kn dt translated">短2倍</li><li id="3f00" class="kf kg ht jk b jl ko jo kp jr kq jv kr jz ks kd kk kl km kn dt translated">对签名和密钥聚合友好</li><li id="db82" class="kf kg ht jk b jl ko jo kp jr kq jv kr jz ks kd kk kl km kn dt translated">确定性:它不依赖于随机数生成器。</li></ul><p id="a0f1" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">由于其最小的存储和带宽需求，它已经被多个区块链采用，如Ethereum、Dfinity、Algorand和Chia。我们举例说明如何在比特币上实现它。</p><h1 id="586e" class="kt ku ht bd kv kw kx ky kz la lb lc ld iz le ja lf jc lg jd lh jf li jg lj lk dt translated">BLS签名:理论</h1><h2 id="2f06" class="ll ku ht bd kv lm ln lo kz lp lq lr ld jr ls lt lf jv lu lv lh jz lw lx lj ly dt translated">散列到曲线:H(m)</h2><p id="a055" class="pw-post-body-paragraph ji jj ht jk b jl lz iu jn jo ma ix jq jr mb jt ju jv mc jx jy jz md kb kc kd hm dt translated">在ECDSA中，消息<strong class="jk hu"> <em class="me"> m </em> </strong>被散列成一个数字。在BLS，我们把它散列到椭圆曲线上的一点。</p><p id="9636" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">一种简单的方法是对消息进行哈希运算，并将结果乘以生成点<strong class="jk hu"> <em class="me"> G </em> </strong>得到一个曲线点。然而就是<a class="ae ke" href="https://crypto.stackexchange.com/questions/83981/mapping-the-hash-of-message-to-a-point-of-elliptic-curve-for-signature" rel="noopener ugc nofollow" target="_blank">不安全</a>。</p><p id="a7ae" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">为了安全地做到这一点，我们首先使用SHA-256对消息进行散列，并将256位的结果作为一个点的x坐标。如果曲线上不存在这样的点，我们增加x坐标并重试，直到找到第一个有效点。</p><h2 id="85e4" class="ll ku ht bd kv lm ln lo kz lp lq lr ld jr ls lt lf jv lu lv lh jz lw lx lj ly dt translated">符号</h2><p id="ccec" class="pw-post-body-paragraph ji jj ht jk b jl lz iu jn jo ma ix jq jr mb jt ju jv mc jx jy jz md kb kc kd hm dt translated">签约是小事。我们简单地相乘:</p><figure class="mg mh mi mj fq mk fe ff paragraph-image"><div class="fe ff mf"><img src="../Images/47fbb9ab4abb149ec1deb5adafd327a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*m0vrtvycwCSTXYLRArq9OQ.png"/></div></figure><p id="514c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="jk hu"> <em class="me"> pk </em> </strong>是私钥<strong class="jk hu"> <em class="me"> m </em> </strong>是消息。注意不需要随机数。<strong class="jk hu"> <em class="me"> S </em> </strong>只是一个曲线点，可以<a class="ae ke" href="https://bitcoin.stackexchange.com/questions/3059/what-is-a-compressed-bitcoin-key" rel="noopener ugc nofollow" target="_blank">压缩</a>到33字节，大约是ECDSA签名大小的一半。</p><figure class="mg mh mi mj fq mk fe ff paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="fe ff mn"><img src="../Images/27f316bf767b2ee78200622c7cbb96cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*B4kLRn5i09aDZ319.png"/></div></div><figcaption class="ms mt fg fe ff mu mv bd b be z ek"><a class="ae ke" rel="noopener" href="/cryptoadvance/bls-signatures-better-than-schnorr-5a7fe30ea716">Signing</a></figcaption></figure><h2 id="f4a6" class="ll ku ht bd kv lm ln lo kz lp lq lr ld jr ls lt lf jv lu lv lh jz lw lx lj ly dt translated">核实</h2><p id="837f" class="pw-post-body-paragraph ji jj ht jk b jl lz iu jn jo ma ix jq jr mb jt ju jv mc jx jy jz md kb kc kd hm dt translated">为了验证签名，我们简单地比较两个配对:</p><figure class="mg mh mi mj fq mk fe ff paragraph-image"><div class="fe ff mw"><img src="../Images/ebec1bf3ebf128aac7c6fc60584f171f.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*PwQAbeefEIQ2Y7WwKHXCaw.png"/></div></figure><figure class="mg mh mi mj fq mk fe ff paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="fe ff mx"><img src="../Images/6e30658b8408ebd8f175a6437c48a49d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0mHt0pqPx2VsnEWJ.png"/></div></div><figcaption class="ms mt fg fe ff mu mv bd b be z ek"><a class="ae ke" rel="noopener" href="/cryptoadvance/bls-signatures-better-than-schnorr-5a7fe30ea716">Verifying</a></figcaption></figure><p id="d445" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">要了解验证工作的原因，</p><figure class="mg mh mi mj fq mk fe ff paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="fe ff my"><img src="../Images/f88e256af9e4e93e18f9aba97271742e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dr7y1JLWpWUFe1ZOYFuiWQ.png"/></div></div></figure><p id="729e" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">双线性配对<strong class="jk hu"> <em class="me"> e </em> </strong>允许我们将标量<strong class="jk hu"> <em class="me"> pk </em> </strong>从第一个输入移动到第二个。</p><h1 id="ca8a" class="kt ku ht bd kv kw kx ky kz la lb lc ld iz le ja lf jc lg jd lh jf li jg lj lk dt translated">在比特币上实现</h1><p id="dc4a" class="pw-post-body-paragraph ji jj ht jk b jl lz iu jn jo ma ix jq jr mb jt ju jv mc jx jy jz md kb kc kd hm dt translated">我们已经使用配对库实现了BLS签名验证。</p><figure class="mg mh mi mj fq mk"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="bd87" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">注意我们让用户通过<strong class="jk hu"><em class="me">y</em></strong>-坐标直接验证，避免计算模平方根。</p><blockquote class="nb"><p id="d22b" class="nc nd ht bd ne nf ng nh ni nj nk kd ek translated">加入Coinmonks <a class="ae ke" href="https://t.me/joinchat/Trz8jaxd6xEsBI4p" rel="noopener ugc nofollow" target="_blank">电报集团</a>，了解加密交易和投资</p></blockquote><h1 id="215f" class="kt ku ht bd kv kw kx ky kz la lb lc ld iz nl ja lf jc nm jd lh jf nn jg lj lk dt translated">摘要</h1><p id="43e7" class="pw-post-body-paragraph ji jj ht jk b jl lz iu jn jo ma ix jq jr mb jt ju jv mc jx jy jz md kb kc kd hm dt translated">我们只演示了如何验证比特币上的单个BLS签名。BLS的主要力量在于<a class="ae ke" rel="noopener" href="/cryptoadvance/bls-signatures-better-than-schnorr-5a7fe30ea716">聚合签名和密钥</a>。我们将它们在比特币上的实现作为练习留给读者。</p></div><div class="ab cl no np hb nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="hm hn ho hp hq"><p id="7c5b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">[1]这种方法被称为Hash and Pray，它在非常数的时间内运行。恒定时间方法是存在的，例如<a class="ae ke" href="https://link.springer.com/chapter/10.1007/978-3-642-33481-8_1" rel="noopener ugc nofollow" target="_blank"> Fouque和Tibouchi </a>，但是更难实现。</p><p id="dce1" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">[2]为了便于说明，我们假设存在具有x坐标的曲线点。可以很容易地添加散列和祈祷方法。</p></div></div>    
</body>
</html>