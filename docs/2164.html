<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://medium.com/coinmonks/detailed-explanation-of-ethereum-yellow-paper-part-3-gas-and-payment-68fb30b296e1?source=collection_archive---------28-----------------------#2022-03-10">https://medium.com/coinmonks/detailed-explanation-of-ethereum-yellow-paper-part-3-gas-and-payment-68fb30b296e1?source=collection_archive---------28-----------------------#2022-03-10</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><h2 id="5b83" class="hr hs ht bd hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip dt translated">以太坊黄皮书详解(三)燃气与支付</h2><figure class="ir is it iu fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff iq"><img src="../Images/ca71bf4105f5def35d2f1faf03f0d136.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0WTonUwg8pswCcs2lP11ag.png"/></div></div></figure><blockquote class="jc jd je"><p id="edfd" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在本帖中，我们将了解更多以太坊中的主要对象及其作用，我们还将简要讨论如何在以太坊中使用Merkle树。</p><p id="cbdd" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">欢迎关注并与我们讨论</p><p id="ceb7" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">作者:<a class="ae ke" href="mailto:support@lunaray.co" rel="noopener ugc nofollow" target="_blank">support@lunaray.co</a></p></blockquote><h2 id="2662" class="hr hs ht bd hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip dt translated">0x01预览</h2><p id="4e38" class="pw-post-body-paragraph jf jg ht ji b jj kf jl jm jn kg jp jq id kh jt ju ih ki jx jy il kj kb kc kd hm dt translated">计算是有成本的——不是你买笔记本电脑和平板电脑，而是分别运行虚拟机、数据存储和信息处理的成本。我们都习惯了免费服务，但我们经常忘记:有人在为这些服务付费！当你免费使用Gmail或Outlook时，邮件提供商必须为服务器、数据存储和基础设施付费，以保持整个服务的正常运行。假设你有一个脸书或Instagram账户，你知道在云中处理和安全存储你上传的照片是有成本的。所以目前的免费服务和Dapp的付费服务，唯一的区别就是谁买单的区别也就是说你不需要直接买单。</p><h2 id="83a7" class="hr hs ht bd hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip dt translated">0x02气体</h2><p id="4f7b" class="pw-post-body-paragraph jf jg ht ji b jj kf jl jm jn kg jp jq id kh jt ju ih ki jx jy il kj kb kc kd hm dt translated">在以太坊区块链上，gas指的是在网络上执行一项交易所必需的成本。矿商根据处理智能合同和其他交易所需的网络计算能力的供需情况来设定天然气价格。，以太坊用气体解决了“谁为服务买单”的问题。你想把钱转到另一个以太坊账户吗？是否要部署智能合约来存储电话联系人？没问题，请先付汽油费。</p><p id="7eb3" class="pw-post-body-paragraph jf jg ht ji b jj jk jl jm jn jo jp jq id js jt ju ih jw jx jy il ka kb kc kd hm dt translated">以汽车和燃料为例:如果你想从A地开车到B地，你必须消耗一部分燃料；同样，如果你想在以太坊<strong class="ji kk"> EVM </strong>上进行某些操作，你也必须支付汽油费。汽车想开得越远，需要的燃料就越多；它想在以太坊上做的计算越多，它要支付的汽油就越多。</p><p id="d5b5" class="pw-post-body-paragraph jf jg ht ji b jj jk jl jm jn jo jp jq id js jt ju ih jw jx jy il ka kb kc kd hm dt translated">每个EVM操作对应于需要消耗的气体量；这些数字看似随意，但背后是有原因的。通常，这些值反映了执行操作的成本(在时间维度中测量)和占用的持久存储资源(当写入数据时)。</p><p id="0bda" class="pw-post-body-paragraph jf jg ht ji b jj jk jl jm jn jo jp jq id js jt ju ih jw jx jy il ka kb kc kd hm dt translated">从另一个角度来说，以太坊采用的是用户付费的模式，可以避免资源的滥用。一旦你必须为每一个操作付费，你会尽可能简洁高效地写代码；Gas的存在还可以防止攻击者通过无效操作来淹没以太坊网络。(除非攻击者愿意花大价钱来执行无效操作)。</p><h2 id="d690" class="hr hs ht bd hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip dt translated">0x03汽油价格和汽油限制</h2><p id="f5a6" class="pw-post-body-paragraph jf jg ht ji b jj kf jl jm jn kg jp jq id kh jt ju ih ki jx jy il kj kb kc kd hm dt translated">所以你可能会问天然气是如何定价的？gasPrice表示交易发送者愿意支付的每单位气体的价格(以Wei为单位),这意味着交易发送者可以定制交易发送者愿意支付的每单位气体的价格。假设一笔交易花费10个气，我们愿意支付3个卫/气，那么这笔交易的总发送成本就是30个卫(不是实际值，只是为了帮助大家理解如何计算)。</p><p id="cae6" class="pw-post-body-paragraph jf jg ht ji b jj jk jl jm jn jo jp jq id js jt ju ih jw jx jy il ka kb kc kd hm dt translated"><strong class="ji kk"> GasLimit </strong>表示交易发送方可以接受多少gas用于执行交易。因为有时候，你无法确切知道执行一个交易需要多少汽油；或者你的智能合约存在一个永远跳不出来的死循环bug。如果没有GasLimit，这将导致发送方的帐户余额错误。耗尽了。GasLimit是一种安全机制，可以防止有人由于计算错误或错误而耗尽帐户中的所有乙醚。</p><h2 id="69a2" class="hr hs ht bd hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip dt translated">0x04矿工</h2><p id="5d10" class="pw-post-body-paragraph jf jg ht ji b jj kf jl jm jn kg jp jq id kh jt ju ih ki jx jy il kj kb kc kd hm dt translated">块是一种包含事务集合的数据结构，以太坊中的miner节点负责在链上创建块。创建块时，矿工将从事务缓冲池(一堆等待打包的事务)中选择事务，并开始产生块。</p><p id="a027" class="pw-post-body-paragraph jf jg ht ji b jj jk jl jm jn jo jp jq id js jt ju ih jw jx jy il ka kb kc kd hm dt translated">在以太坊中，矿工每成功创建一个区块，可以获得固定的区块奖励和参考大叔区块的奖励(此处不展开)，以及此区块包含的所有交易的费用。；因此，交易中的天然气价格定得越高，矿商可以获得的交易费就越多。如果您想了解更多关于矿工奖励的信息，请参见以下示例:</p><p id="d86e" class="pw-post-body-paragraph jf jg ht ji b jj jk jl jm jn jo jp jq id js jt ju ih jw jx jy il ka kb kc kd hm dt translated">假设aBob的账户中有200 wei，John的账户中有100 wei，他们都想发送一笔花费90汽油的交易。</p><p id="cd7e" class="pw-post-body-paragraph jf jg ht ji b jj jk jl jm jn jo jp jq id js jt ju ih jw jx jy il ka kb kc kd hm dt translated">Bob设置gasLimit = 100，gas price = 2；John想设置gasLimit = 200，可惜他只有100魏，这个设置会让交易固定成本高于账户余额；所以约翰最终设置gasLimit = 100，gasPrice = 1。</p><p id="5a4e" class="pw-post-body-paragraph jf jg ht ji b jj jk jl jm jn jo jp jq id js jt ju ih jw jx jy il ka kb kc kd hm dt translated">在进入选择交易打包成块的流程时，矿商倾向于选择收费较高的交易。在我们的例子中，鲍勃的汽油价格是约翰的两倍；由于两个交易都需要90气，选择鲍勃交易的矿工获得两倍的费用奖励。</p><figure class="ir is it iu fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff kl"><img src="../Images/0c0a255e4c416bbd1c231bdd0ff0566d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OfUTb6Z3QhkINDifoXLa1Q.png"/></div></div></figure><p id="e8f6" class="pw-post-body-paragraph jf jg ht ji b jj jk jl jm jn jo jp jq id js jt ju ih jw jx jy il ka kb kc kd hm dt translated">交易发送方以支付奖励矿工的机制，在以太坊形成了一个自我调节的经济体系。交易发送方千方百计降低交易成本，而矿商总是希望收益最大化，两者形成平衡。作为交易发送方，如果你把gasPrice设置得更高，就意味着矿商更有动力打包你的交易，你的交易就能越早被纳入区块。</p><p id="4604" class="pw-post-body-paragraph jf jg ht ji b jj jk jl jm jn jo jp jq id js jt ju ih jw jx jy il ka kb kc kd hm dt translated">一些矿商甚至设定了自己的天然气价格下限，忽略了那些天然气价格低于下限的交易。</p><p id="fccd" class="pw-post-body-paragraph jf jg ht ji b jj jk jl jm jn jo jp jq id js jt ju ih jw jx jy il ka kb kc kd hm dt translated">当发送交易时，很难知道当前有效的最低汽油价格是多少。这些工具可以扫描整个以太坊网络，计算其他交易的当前gasPrice平均值，并帮助发送者选择矿工可以接受的合理gasPrice。</p><h2 id="bdd3" class="hr hs ht bd hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip dt translated">0x05结论</h2><p id="346b" class="pw-post-body-paragraph jf jg ht ji b jj kf jl jm jn kg jp jq id kh jt ju ih ki jx jy il kj kb kc kd hm dt translated">GasPrice保护用户在智能合同中出现错误或计算错误时免受乙醚损失。</p></div></div>    
</body>
</html>