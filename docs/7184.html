<html>
<head>
<title>ERC-1155 NFT Smart Contract Deployment — using Hardhat</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ERC-1155 NFT智能合同部署—使用安全帽</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/erc-1155-nft-smart-contract-deployment-using-hardhat-7425fca60334?source=collection_archive---------1-----------------------#2022-05-21">https://medium.com/coinmonks/erc-1155-nft-smart-contract-deployment-using-hardhat-7425fca60334?source=collection_archive---------1-----------------------#2022-05-21</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><h2 id="7366" class="hr hs ht bd b gc hu hv hw hx hy hz ek ia translated" aria-label="kicker paragraph">NFT系列</h2><div class=""/><div class=""><h2 id="4b17" class="pw-subtitle-paragraph iz ic ht bd b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ek translated">关于如何编写和部署ERC-1155标准智能合同的指南</h2></div><p id="9b56" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated">作为本文的一部分，我们正尝试使用Hardhat配置在Polygon Mumbai Testnet上编写和部署ERC-1155标准智能合同。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="fe ff ko"><img src="../Images/ca5357d22d89f8c9702c1489eaa99ee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OVR6dKM153_lYD8KfKBDzA.png"/></div></div></figure><h1 id="95e8" class="la lb ht bd lc ld le lf lg lh li lj lk ji ll jj lm jl ln jm lo jo lp jp lq lr dt translated">ERC 1155</h1><p id="5b55" class="pw-post-body-paragraph jr js ht jt b ju ls jd jw jx lt jg jz ka lu kc kd ke lv kg kh ki lw kk kl km hm dt translated">ERC-1155支持可替换和不可替换的令牌。一个已部署的契约可以管理多种令牌类型，因此它在区块链上只占用较少的空间。ERC-1155还支持批量转移，因此，通过一次转移，我们可以将多个令牌转移给多方。一个所有者可以拥有多个具有相同令牌Id的令牌。</p><p id="3b28" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated"><em class="kn">让我们开始有趣的部分吧！</em></p><h1 id="c954" class="la lb ht bd lc ld le lf lg lh li lj lk ji ll jj lm jl ln jm lo jo lp jp lq lr dt translated">步骤1:初始化项目</h1><pre class="kp kq kr ks fq lx ly lz ma aw mb dt"><span id="c754" class="mc lb ht ly b fv md me l mf mg">npm init</span></pre><p id="6900" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated">它将创建一个新的package.json文件，您可以对其进行相应的编辑。</p><pre class="kp kq kr ks fq lx ly lz ma aw mb dt"><span id="4eb3" class="mc lb ht ly b fv md me l mf mg">{   <br/>   "name": "MyERC1155NFT",   <br/>   "version": "1.0.0",  <br/>   "description": "",  <br/>   "main": "index.js",  <br/>   "engines": <br/>    {     <br/>       "node": "12.19.0"    <br/>    },   <br/>   "scripts": <br/>    {     <br/>       "test": "echo \"Error: no test specified\" &amp;&amp; exit 1",<br/>       "start": "nodemon index.js"    <br/>    },    <br/>   "keywords": [],    <br/>   "author": "",    <br/>   "license": "ISC",<br/>}</span></pre><h1 id="3428" class="la lb ht bd lc ld le lf lg lh li lj lk ji ll jj lm jl ln jm lo jo lp jp lq lr dt translated">步骤2:编写智能合同</h1><p id="5a01" class="pw-post-body-paragraph jr js ht jt b ju ls jd jw jx lt jg jz ka lu kc kd ke lv kg kh ki lw kk kl km hm dt translated">创建一个文件夹<strong class="jt id"> <em class="kn"> contracts/ </em> </strong>并新建一个名为<strong class="jt id"><em class="kn">myerc 1155 NFT . sol .</em></strong>的文件</p><p id="297f" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated">确保安装<a class="ae mh" href="https://docs.openzeppelin.com/contracts/3.x/erc721#:~:text=ERC721%20is%20a%20standard%20for,across%20a%20number%20of%20contracts." rel="noopener ugc nofollow" target="_blank"> OpenZeppelin </a>库，因为我们正在从OpenZeppelin契约库扩展类。<strong class="jt id"><em class="kn">NPM install @ open zeppelin/contracts。</em> </strong></p><p id="fb33" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated">将以下代码复制到您的智能协定文件中。</p><pre class="kp kq kr ks fq lx ly lz ma aw mb dt"><span id="2b71" class="mc lb ht ly b fv md me l mf mg">// SPDX-License-Identifier: MIT</span><span id="4ecf" class="mc lb ht ly b fv mi me l mf mg">pragma solidity &gt;=0.8.0 &lt;0.9.0;</span><span id="d8e7" class="mc lb ht ly b fv mi me l mf mg">import “@openzeppelin/contracts/token/ERC1155/ERC1155.sol”;</span><span id="54dd" class="mc lb ht ly b fv mi me l mf mg">import “@openzeppelin/contracts/utils/Counters.sol”;</span><span id="6a42" class="mc lb ht ly b fv mi me l mf mg">import “@openzeppelin/contracts/access/Ownable.sol”;</span><span id="d4f1" class="mc lb ht ly b fv mi me l mf mg">contract MyERC1155NFT is ERC1155, Ownable {</span><span id="f787" class="mc lb ht ly b fv mi me l mf mg">     using Counters for Counters.Counter;</span><span id="d5c7" class="mc lb ht ly b fv mi me l mf mg">     Counters.Counter private _tokenIds;</span><span id="2eef" class="mc lb ht ly b fv mi me l mf mg">     mapping(uint256 =&gt; string) private _tokenURIs;</span><span id="9165" class="mc lb ht ly b fv mi me l mf mg">     constructor() ERC1155(“”) {}</span><span id="8611" class="mc lb ht ly b fv mi me l mf mg">     function _setTokenURI(uint256 tokenId, string memory _tokenURI)</span><span id="94d4" class="mc lb ht ly b fv mi me l mf mg">     internal</span><span id="e7a8" class="mc lb ht ly b fv mi me l mf mg">     virtual</span><span id="fe4f" class="mc lb ht ly b fv mi me l mf mg">     {</span><span id="1388" class="mc lb ht ly b fv mi me l mf mg">        _tokenURIs[tokenId] = _tokenURI;</span><span id="1aa7" class="mc lb ht ly b fv mi me l mf mg">     }</span><span id="da96" class="mc lb ht ly b fv mi me l mf mg">     function mintNFT(address recipient, string memory _tokenURI)</span><span id="d402" class="mc lb ht ly b fv mi me l mf mg">     public onlyOwner</span><span id="6fde" class="mc lb ht ly b fv mi me l mf mg">     returns (uint256)</span><span id="7047" class="mc lb ht ly b fv mi me l mf mg">     {</span><span id="8bca" class="mc lb ht ly b fv mi me l mf mg">       _tokenIds.increment();</span><span id="f006" class="mc lb ht ly b fv mi me l mf mg">       uint256 newItemId = _tokenIds.current();</span><span id="2341" class="mc lb ht ly b fv mi me l mf mg">       _mint(recipient, newItemId, 1, “”);</span><span id="d495" class="mc lb ht ly b fv mi me l mf mg">       _setTokenURI(newItemId, _tokenURI);</span><span id="3150" class="mc lb ht ly b fv mi me l mf mg">       return newItemId;</span><span id="e216" class="mc lb ht ly b fv mi me l mf mg">     }</span><span id="f46c" class="mc lb ht ly b fv mi me l mf mg">}</span></pre><h1 id="fe23" class="la lb ht bd lc ld le lf lg lh li lj lk ji ll jj lm jl ln jm lo jo lp jp lq lr dt translated">步骤3:安装Hardhat &amp; Ethers.js</h1><pre class="kp kq kr ks fq lx ly lz ma aw mb dt"><span id="f9c1" class="mc lb ht ly b fv md me l mf mg">npm install --save-dev hardhat <br/>npm install --save-dev @nomiclabs/hardhat-ethers 'ethers@^5.0.0'</span></pre><h1 id="ae82" class="la lb ht bd lc ld le lf lg lh li lj lk ji ll jj lm jl ln jm lo jo lp jp lq lr dt translated">步骤4:创建安全帽项目</h1><pre class="kp kq kr ks fq lx ly lz ma aw mb dt"><span id="105c" class="mc lb ht ly b fv md me l mf mg">npx hardhat</span></pre><p id="4fbc" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated">你会得到如下提示，选择“<strong class="jt id">创建一个空的hardhat.config.js </strong>”。它将在您的项目文件夹中创建一个空的hardhat.config.js文件。</p><pre class="kp kq kr ks fq lx ly lz ma aw mb dt"><span id="5c13" class="mc lb ht ly b fv md me l mf mg">888    888                      888 888               888<br/>888    888                      888 888               888   <br/>888    888                      888 888               888   <br/>8888888888  8888b.  888d888 .d88888 88888b.   8888b.  888888<br/>888    888     "88b 888P"  d88" 888 888 "88b     "88b 888   <br/>888    888 .d888888 888    888  888 888  888 .d888888 888   <br/>888    888 888  888 888    Y88b 888 888  888 888  888 Y88b. <br/>888    888 "Y888888 888     "Y88888 888  888 "Y888888  "Y888Welcome to Hardhat v2.8.0? What do you want to do? ...<br/>  Create a basic sample project<br/>  Create an advanced sample project<br/>  Create an advanced sample project that uses TypeScript<br/>&gt; Create an empty hardhat.config.js<br/>  Quit</span></pre><h1 id="f859" class="la lb ht bd lc ld le lf lg lh li lj lk ji ll jj lm jl ln jm lo jo lp jp lq lr dt translated">步骤5:更新hardhat.config.js</h1><pre class="kp kq kr ks fq lx ly lz ma aw mb dt"><span id="191d" class="mc lb ht ly b fv md me l mf mg">/**<br/> * <a class="ae mh" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a> import(‘hardhat/config’).HardhatUserConfig<br/> */<br/>require(“dotenv”).config();<br/>require(“<a class="ae mh" href="http://twitter.com/nomiclabs/hardhat-ethers" rel="noopener ugc nofollow" target="_blank">@nomiclabs/hardhat-ethers</a>”);<br/>const { API_URL, PRIVATE_KEY } = process.env;<br/>module.exports = {<br/>   solidity: “0.8.9”,<br/>   defaultNetwork: “mumbai”,<br/>   networks: {<br/>     hardhat: {},<br/>     mumbai: {<br/>       url: API_URL,<br/>       accounts: [`0x${PRIVATE_KEY}`],<br/>     },<br/>   },<br/>};</span></pre><p id="9d82" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated">确保你的。env文件包含<strong class="jt id"> <em class="kn"> API_URL </em> </strong>和<strong class="jt id"> <em class="kn">私钥</em> </strong>。</p><p id="b54f" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated">根据您用来请求区块链的节点提供者，API_URL会有所不同。可以使用<a class="ae mh" href="https://infura.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jt id"> Infura </strong> </a>、<a class="ae mh" href="https://www.alchemy.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jt id"> Alchemy </strong> </a>，或者<a class="ae mh" href="https://moralis.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jt id"> Moralis </strong> </a>作为节点提供者。以上所有的节点提供者都提供免费的帐号，你可以创建一个并获得RPC URL来连接。</p><p id="57d6" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated">你的。env文件应该如下所示:</p><pre class="kp kq kr ks fq lx ly lz ma aw mb dt"><span id="e415" class="mc lb ht ly b fv md me l mf mg">API_URL = "RPC Node URL"<br/>PRIVATE_KEY = "Metamask Private Key"</span></pre><h1 id="6326" class="la lb ht bd lc ld le lf lg lh li lj lk ji ll jj lm jl ln jm lo jo lp jp lq lr dt translated">步骤6:编译智能合同</h1><pre class="kp kq kr ks fq lx ly lz ma aw mb dt"><span id="8ce8" class="mc lb ht ly b fv md me l mf mg">npx hardhat compile</span></pre><h1 id="c118" class="la lb ht bd lc ld le lf lg lh li lj lk ji ll jj lm jl ln jm lo jo lp jp lq lr dt translated">步骤7:编写部署脚本</h1><p id="2271" class="pw-post-body-paragraph jr js ht jt b ju ls jd jw jx lt jg jz ka lu kc kd ke lv kg kh ki lw kk kl km hm dt translated">创建另一个名为<strong class="jt id"> <em class="kn"> scripts/ </em> </strong>的文件夹，创建一个名为<strong class="jt id"> <em class="kn"> deploy.js </em> </strong>的新文件，向其中添加以下内容。</p><pre class="kp kq kr ks fq lx ly lz ma aw mb dt"><span id="1a64" class="mc lb ht ly b fv md me l mf mg">async function main() {</span><span id="5b7a" class="mc lb ht ly b fv mi me l mf mg">   const MyNFT = await ethers.getContractFactory("MyERC1155NFT");</span><span id="1fcd" class="mc lb ht ly b fv mi me l mf mg">   const myNFT = await MyNFT.deploy();</span><span id="81cd" class="mc lb ht ly b fv mi me l mf mg">   const txHash = myNFT.deployTransaction.hash;</span><span id="4d8b" class="mc lb ht ly b fv mi me l mf mg">   const txReceipt = await ethers.provider.waitForTransaction(txHash);</span><span id="4410" class="mc lb ht ly b fv mi me l mf mg">   console.log("Contract deployed to address:", txReceipt.contractAddress);</span><span id="ee81" class="mc lb ht ly b fv mi me l mf mg">}</span><span id="f080" class="mc lb ht ly b fv mi me l mf mg">main()</span><span id="a712" class="mc lb ht ly b fv mi me l mf mg">.then(() =&gt; process.exit(0))</span><span id="3b69" class="mc lb ht ly b fv mi me l mf mg">.catch((error) =&gt; {</span><span id="e632" class="mc lb ht ly b fv mi me l mf mg">    process.exit(1);</span><span id="ee10" class="mc lb ht ly b fv mi me l mf mg">});</span></pre><h1 id="bd38" class="la lb ht bd lc ld le lf lg lh li lj lk ji ll jj lm jl ln jm lo jo lp jp lq lr dt translated">第八步:买一些假MATIC</h1><p id="22a7" class="pw-post-body-paragraph jr js ht jt b ju ls jd jw jx lt jg jz ka lu kc kd ke lv kg kh ki lw kk kl km hm dt translated">由于区块链交易与汽油费有关，我们需要收集一些假的MATIC来部署我们的智能合同。</p><p id="bb53" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated">从这里拿一些假的MATIC:<a class="ae mh" href="https://faucet.polygon.technology/" rel="noopener ugc nofollow" target="_blank">https://faucet.polygon.technology/</a>。</p><p id="9336" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated">其他可用的自动水龙头:</p><ol class=""><li id="24cb" class="mj mk ht jt b ju jv jx jy ka ml ke mm ki mn km mo mp mq mr dt translated">https://faucet.pearzap.com/<a class="ae mh" href="https://faucet.pearzap.com/" rel="noopener ugc nofollow" target="_blank"/></li><li id="93a2" class="mj mk ht jt b ju ms jx mt ka mu ke mv ki mw km mo mp mq mr dt translated">【https://matic.supply/ T4】</li><li id="8104" class="mj mk ht jt b ju ms jx mt ka mu ke mv ki mw km mo mp mq mr dt translated"><a class="ae mh" href="https://www.coinclarified.com/tools/faucets/polygon" rel="noopener ugc nofollow" target="_blank">https://www.coinclarified.com/tools/faucets/polygon</a></li><li id="bfc3" class="mj mk ht jt b ju ms jx mt ka mu ke mv ki mw km mo mp mq mr dt translated"><a class="ae mh" href="https://faucet.firebird.finance/" rel="noopener ugc nofollow" target="_blank">https://faucet.firebird.finance/</a></li></ol><h1 id="041b" class="la lb ht bd lc ld le lf lg lh li lj lk ji ll jj lm jl ln jm lo jo lp jp lq lr dt translated">步骤9:部署智能合同</h1><pre class="kp kq kr ks fq lx ly lz ma aw mb dt"><span id="2675" class="mc lb ht ly b fv md me l mf mg">npx hardhat run scripts/deploy.js --network mumbai</span></pre><p id="c6c5" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated">您将得到如下所示的控制台输出:</p><pre class="kp kq kr ks fq lx ly lz ma aw mb dt"><span id="c657" class="mc lb ht ly b fv md me l mf mg">Contract deployed to address: 0x1D1ba2A16285955D01a7A3Be55D9c730f85FbD41</span></pre><p id="def7" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated">现在你可以在mumbai <a class="ae mh" href="https://mumbai.polygonscan.com/" rel="noopener ugc nofollow" target="_blank"> polygonscan </a>上验证部署的合同地址。该事务看起来如下所示:</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="fe ff mx"><img src="../Images/28b038133ab95361822846aa814a97ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qpQsMh4inGL_k15chhqI_A.png"/></div></div><figcaption class="my mz fg fe ff na nb bd b be z ek">Transaction on Mumbai Polygonscan</figcaption></figure><p id="c0e1" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated">太好了！您已经在Polygon Mumbai testnet上成功部署了您的ERC-1155智能合约。</p></div><div class="ab cl nc nd hb ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="hm hn ho hp hq"><p id="8810" class="pw-post-body-paragraph jr js ht jt b ju jv jd jw jx jy jg jz ka kb kc kd ke kf kg kh ki kj kk kl km hm dt translated"><strong class="jt id">快乐DEPYLOYing:) </strong></p><blockquote class="nj"><p id="61dd" class="nk nl ht bd nm nn no np nq nr ns km ek translated">加入Coinmonks <a class="ae mh" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae mh" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="6d9b" class="la lb ht bd lc ld le lf lg lh li lj lk ji nt jj lm jl nu jm lo jo nv jp lq lr dt translated">另外，阅读</h1><ul class=""><li id="7682" class="mj mk ht jt b ju ls jx lt ka nw ke nx ki ny km nz mp mq mr dt translated"><a class="ae mh" rel="noopener" href="/coinmonks/crypto-arbitrage-guide-how-to-make-money-as-a-beginner-62bfe5c868f6">加密套利</a>指南| <a class="ae mh" rel="noopener" href="/coinmonks/how-to-short-bitcoin-568a2d0b4ae5">如何做空比特币</a></li><li id="adc2" class="mj mk ht jt b ju ms jx mt ka mu ke mv ki mw km nz mp mq mr dt translated"><a class="ae mh" href="https://coincodecap.com/how-to-buy-cryptocurrency-in-canada" rel="noopener ugc nofollow" target="_blank">如何在加拿大购买加密货币？</a></li><li id="d6aa" class="mj mk ht jt b ju ms jx mt ka mu ke mv ki mw km nz mp mq mr dt translated"><a class="ae mh" href="https://coincodecap.com/bored-ape-yacht-club-bayc-review" rel="noopener ugc nofollow" target="_blank">无聊猿游艇俱乐部(BAYC)回顾</a> | <a class="ae mh" href="https://coincodecap.com/bybit-vs-coinbase" rel="noopener ugc nofollow" target="_blank">拜比特vs比特币基地</a></li><li id="94ab" class="mj mk ht jt b ju ms jx mt ka mu ke mv ki mw km nz mp mq mr dt translated"><a class="ae mh" href="https://coincodecap.com/crypto-trading-terminals" rel="noopener ugc nofollow" target="_blank"> 5款最佳加密交易终端</a> | <a class="ae mh" href="https://coincodecap.com/best-defi-apps" rel="noopener ugc nofollow" target="_blank">最佳DeFi应用</a></li><li id="0d54" class="mj mk ht jt b ju ms jx mt ka mu ke mv ki mw km nz mp mq mr dt translated"><a class="ae mh" href="https://coincodecap.com/coinbase-vs-wazirx" rel="noopener ugc nofollow" target="_blank">比特币基地vs瓦济克斯</a> | <a class="ae mh" href="https://coincodecap.com/bitrue-review" rel="noopener ugc nofollow" target="_blank">比特鲁点评</a> | <a class="ae mh" href="https://coincodecap.com/poloniex-vs-bittrex" rel="noopener ugc nofollow" target="_blank">波洛涅克斯vs比特克斯</a></li><li id="9742" class="mj mk ht jt b ju ms jx mt ka mu ke mv ki mw km nz mp mq mr dt translated"><a class="ae mh" href="https://coincodecap.com/crypto-exchanges-in-germany" rel="noopener ugc nofollow" target="_blank">德国最佳加密交易所</a> | <a class="ae mh" href="https://coincodecap.com/arbitrum" rel="noopener ugc nofollow" target="_blank"> Arbitrum:第二层解决方案</a></li></ul></div></div>    
</body>
</html>