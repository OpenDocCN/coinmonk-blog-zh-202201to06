<html>
<head>
<title>How to Transfer Tokens To The Owner Address and Not stuck In Contract Address In Solidity.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Solidity中将令牌转移到所有者地址而不卡在合同地址？</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-transfer-tokens-to-the-owner-address-and-not-stuck-in-contract-address-in-solidity-4fdd7f1f7575?source=collection_archive---------2-----------------------#2022-02-01">https://medium.com/coinmonks/how-to-transfer-tokens-to-the-owner-address-and-not-stuck-in-contract-address-in-solidity-4fdd7f1f7575?source=collection_archive---------2-----------------------#2022-02-01</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/360390cfbef99bae7ec14b4f7394cae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U5AZSs0DjG8aGnHyE5ecqw.jpeg"/></div></div></figure><p id="5951" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我最近在用react.js和smart contract(solidity)构建Web DApp时遇到了一个bug。该项目是一个NFT铸造Dapp，客户可以铸造NFT并拥有它们。</p><p id="c63d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我确信一切都很好，直到我测试并注意到客户用来造币的钱没有进入所有者的钱包，而是进入了合同地址。</p><p id="199a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">太奇怪了！销售非专利技术的目的是什么，你不能从你的或你能得到的地方得到钱。</p><p id="4fcd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这是一个非常奇怪的错误，在我们看到效果之前，我们可能不会注意到它。我了解到CrytoPunk也面临着同样的问题，这也是他们推出第二版NFTs的原因。</p><p id="f54f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">那么如何解决这个问题呢？</p><p id="8bc7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">卡在合同地址的钱，如果有取款功能，允许机主退出合同，就可以取出。参见下面的代码。</p><figure class="ka kb kc kd fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff jz"><img src="../Images/a948f3e4d3c4681256a90bad87290606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EcT8n1HSRz0aWU6_leJNzg.png"/></div></div></figure><p id="a735" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">该功能允许所有者通过使用区块链的扫描地址从合同地址中退出，如<a class="ae ke" href="https://polygonscan.com/" rel="noopener ugc nofollow" target="_blank"> polygonscan </a>用于Polygon，以及<a class="ae ke" href="https://etherscan.io/" rel="noopener ugc nofollow" target="_blank"> etherscan </a>用于Ethereum。</p><p id="8e38" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">注意到代码中的唯一所有者意味着只有所有者可以撤销。如果取款功能不仅限于所有者，任何人都可以取款。</p><p id="c2d0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">还要注意，要退出合同，你的钱包里必须有多于你想提取的金额。</p><p id="bb99" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">但是，我们如何让它在客户创建NFT时，直接到达所有者的地址，而交易仍然显示在合同上？</p><p id="6a62" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在合同中的mint函数内，添加以下代码行；</p><figure class="ka kb kc kd fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff kf"><img src="../Images/417fe3a4e51556f7ef01a94d9c82babd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c_HYOmuxF9S4OTEojzqOkw.png"/></div></div></figure><p id="1a3f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">owner()是智能协定上Ownable中的一个函数，它将用于部署协定的地址存储为所有者的地址。</p><p id="8795" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">完整的mint函数是这样的；</p><figure class="ka kb kc kd fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff kg"><img src="../Images/3a3b5add7604a5609ef5d1dfa5103c7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ruqCH_a06Zm-VbnXh4ilw.png"/></div></div></figure><p id="1912" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">因此，当客户铸造他们的NFT以获得它们，并且他们被从Metamask收取铸造金额时，铸造函数中的最后一行代码将用于铸造的资金转移到所有者的地址，即合同的所有者。</p><p id="14f7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这两个函数解决了令牌卡在契约地址无法访问或撤回的问题。</p><p id="e31f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我希望这篇文章对你有所帮助。在<a class="ae ke" href="https://twitter.com/GraceOmole3" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我，了解更多关于前端和区块链的技巧</p></div></div>    
</body>
</html>