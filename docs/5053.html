<html>
<head>
<title>Cordapp example to illustrate privacy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">说明隐私的Cordapp示例</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/cordapp-example-to-illustrate-privacy-fbc51ce87f78?source=collection_archive---------41-----------------------#2022-04-17">https://medium.com/coinmonks/cordapp-example-to-illustrate-privacy-fbc51ce87f78?source=collection_archive---------41-----------------------#2022-04-17</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="1aa0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">R3 Corda的一个关键特性是它可以保护数据隐私。在这种意义上，只有授权方可以看到分类帐中的共享数据。在这篇文章中，我将说明如何使用Cordapp——共享学校图书馆来保护数据隐私。在我的<a class="ae jo" rel="noopener" href="/coinmonks/introduction-to-private-blockchain-application-corda-43dfbb325fed">上一篇</a>中，我提出了一个简单的想法(共享学校图书馆)，附近的一些学校组成一个社区，共享他们图书馆里的书。每个Corda节点代表一所学校。每个学校可以发行任何被定义为<code class="eh jp jq jr js b">BookState</code>的图书条目。</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="a92a" class="kb kc ht js b fv kd ke l kf kg">@BelongsToContract(BookContract::class)<br/>data class BookState(val title: String,<br/>val author: String,<br/>val ISBN: String,<br/>val isBorrowed: Boolean,<br/>val owner: Party,<br/>val holder: Party,<br/>val notification: UniqueIdentifier?,<br/>val borrowDate: String?,<br/>val entitleParties: List&lt;Party&gt; ,<br/>val requestQueue: List&lt;BookRequest&gt; = listOf&lt;BookRequest&gt;(),<br/>override val linearId: UniqueIdentifier = UniqueIdentifier(),<br/>override val participants: List&lt;AbstractParty&gt; = listOf(owner) + entitleParties ):LinearState, QueryableState <br/>...<br/>...<br/>@CordaSerializable</span><span id="8055" class="kb kc ht js b fv kh ke l kf kg">data class BookRequest(val bookUUID: UniqueIdentifier, val requester: Party, val studentUUID: UniqueIdentifier, val timestamp: String)</span></pre><p id="dbaf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">BookState</code>包含有资格借书的学校的列表<code class="eh jp jq jr js b">entitleParties</code>。如果您的学校不在列表中，当您从保管库中查询图书时，您的学生将看不到图书条目。</p><h1 id="b31f" class="ki kc ht bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">学生个人信息不可共享</h1><p id="5439" class="pw-post-body-paragraph iq ir ht is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hm dt translated">如果一本书被其他人借走了，有资格的学校不能借走它，但是它可以添加一个为学生保留这本书的请求。所有请求者将在<code class="eh jp jq jr js b">BookState</code>变量— <code class="eh jp jq jr js b">requestQueue</code>中排队。每个条目(BookRequest)只包含书UUID和学生UUID，其中没有任何个人信息(如手机/电子邮件)会存储在BookState中。学生个人信息存储在自己学校节点服务器内的StudentState中，而不是其他学校。学生UUID是一个随机的唯一ID，它是当学生在自己的学校节点服务器中注册自己时生成的。由于<code class="eh jp jq jr js b">StudentState</code>创建只需要自己学校签署交易，<code class="eh jp jq jr js b">StudentState</code>不共享，其他学校无法查看学生信息。他们只能读到在<code class="eh jp jq jr js b">BookRequest</code>队列中的学生UUID，而不能读到<code class="eh jp jq jr js b">StudentState</code>。如果你只有学生UUID，它很难识别个别学生。只有他自己的学校才能从保险库里查询到学生UUID的<code class="eh jp jq jr js b">StudentState</code>。这就是为什么学生的隐私可以得到保护。</p><h1 id="70b8" class="ki kc ht bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">演示</h1><p id="701c" class="pw-post-body-paragraph iq ir ht is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hm dt translated">让我们按照下面的步骤进行测试。</p><ol class=""><li id="265b" class="lk ll ht is b it iu ix iy jb lm jf ln jj lo jn lp lq lr ls dt translated">在ABC学校，我们创建了一个新的图书条目，并命名为其他两所学校:XYZ学校和IJK学校。</li></ol><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="8367" class="kb kc ht js b fv kd ke l kf kg">flow start IssueBookFlow$Initiator title: "my book", \<br/>author: "matthew", ISBN: "ACB123", \<br/>entitleParties:["O=School XYZ,L=Hong Kong,C=HK","O=School IJK,L=Hong Kong,C=HK"]</span></pre><figure class="jt ju jv jw fq lu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff lt"><img src="../Images/23513f76810d70af0832da40a7981463.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_biHqUV3aKV5py3vbj-Pxw.png"/></div></div></figure><p id="d937" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2.学校IJK试图借这本书。运行以下命令后，<code class="eh jp jq jr js b">BookState</code>将用<code class="eh jp jq jr js b">holder</code>=学校IJK和<code class="eh jp jq jr js b">isBorrwed</code> = <code class="eh jp jq jr js b">true</code>进行更新</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="1ec2" class="kb kc ht js b fv kd ke l kf kg">flow start BorrowBookFlow$Initiator bookUUID: "00e0a293-eb1b-42d0-a181-15fb96f11084"</span></pre><figure class="jt ju jv jw fq lu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff mb"><img src="../Images/9028c27bf0e807f3371a96764ac4812a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PRbHYjgUXEqAuGyeP8sdXA.png"/></div></div></figure><p id="e97c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">3.如果我们想再借那本书，就会失败，因为那本书已经被借走了(<code class="eh jp jq jr js b">isBorrowed</code> = true)。该条件在<code class="eh jp jq jr js b">BookContract</code>中得到验证。</p><figure class="jt ju jv jw fq lu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff mc"><img src="../Images/40e1f49f2556f040a40a05d1bb124dee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gtVTnoflck9Dq4Ox2hgiJA.png"/></div></div></figure><p id="e256" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">4.当书被借走的时候，我们只能添加持有书的请求。首先，让我们在IJK学校注册学生。您可以通过从金库中查询<code class="eh jp jq jr js b">StudentState</code>来查询他的LinearID。</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="ffe5" class="kb kc ht js b fv kd ke l kf kg">flow start RegisterStudentFlow$Initiator fullname: "leung", \<br/>studentId: "2048", mobile: "94077", email: "abc"</span></pre><figure class="jt ju jv jw fq lu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff md"><img src="../Images/88c3c3864f2dddd0299e4880f13ef4c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SOAgO_ISCAfN2-su8FhaXQ.png"/></div></div></figure><p id="8e08" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您在Book Owner School ABC中运行相同的查询，它将无法搜索该学生。</p><figure class="jt ju jv jw fq lu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff me"><img src="../Images/bb9f30f289340b9b3168bd93160a4243.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*84KDYdwarZXwNIO5ppR0Yw.png"/></div></div></figure><p id="e308" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">5.然后运行下面的命令将<code class="eh jp jq jr js b">BookRequest</code>添加到<code class="eh jp jq jr js b">requestQueue</code>中。</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="ad11" class="kb kc ht js b fv kd ke l kf kg">flow start AddRequestFlow$Initiator bookUUID: "00e0a293-eb1b-42d0-a181-15fb96f11084" , \<br/>studentUUID: "d38f8529-fcff-4f5b-b09d-a3a0cfc0c60a"</span></pre><figure class="jt ju jv jw fq lu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff mf"><img src="../Images/24ded8a9c5ba3fd88ffb148469cf22ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*takPXSMVk7jO4Ppc8vbwAA.png"/></div></div></figure><p id="1539" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">6.接下来，尝试还书。请注意，只有图书持有者才能还书。在<code class="eh jp jq jr js b">ReturnBookFlow</code>中检查该条件。</p><figure class="jt ju jv jw fq lu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff mg"><img src="../Images/192055ea8dbe686ad9c92ec0e14b09e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ewORsSohVLAsqxbDSPvDJg.png"/></div></div></figure><p id="2234" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果在book holder节点上成功归还图书，您将看到<code class="eh jp jq jr js b">requestQueue</code>被出队(现在为空)，并且<code class="eh jp jq jr js b">notification</code>字段将被设置为位于前一队列头的学生UUID。</p><figure class="jt ju jv jw fq lu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff mh"><img src="../Images/32cd49bf3c0537cf6123bcb10325b9a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*49uKHsY_VXpzITjDhcL6Pw.png"/></div></div></figure><p id="cb58" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">7.我们创作了另一本书，但我们不准许IJK学校借阅这本书。</p><pre class="jt ju jv jw fq jx js jy jz aw ka dt"><span id="015a" class="kb kc ht js b fv kd ke l kf kg">flow start IssueBookFlow$Initiator title: "my second book", \<br/>author: "matthew", ISBN: "MNOP123", \<br/>entitleParties:["O=School XYZ,L=Hong Kong,C=HK"]</span></pre><p id="9e6e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当我们试图借关于学校IJK的书时，它将失败。因为这本书的条目并没有存放在IJK学校的金库里，而且这个条件也是在<code class="eh jp jq jr js b">BookContract</code>中查到的。</p><figure class="jt ju jv jw fq lu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff mi"><img src="../Images/7862e6b8f5c0e92e4f0a394bb6b062f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CyXhnh_0wNxNixtVnMrwGA.png"/></div></div></figure><h1 id="e894" class="ki kc ht bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">完整代码</h1><p id="0975" class="pw-post-body-paragraph iq ir ht is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hm dt translated">共享库应用程序的完整代码可以在我的<a class="ae jo" href="https://github.com/iwasnothing/cordapp-shared-library" rel="noopener ugc nofollow" target="_blank"> git repo </a>中找到。</p><blockquote class="mj"><p id="9b6f" class="mk ml ht bd mm mn mo mp mq mr ms jn ek translated"><em class="mt">加入Coinmonks </em> <a class="ae jo" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank"> <em class="mt">电报频道</em> </a> <em class="mt">和</em> <a class="ae jo" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> <em class="mt"> Youtube频道</em> </a> <em class="mt">了解加密交易和投资</em></p></blockquote><h1 id="ec09" class="ki kc ht bd kj kk kl km kn ko kp kq kr ks mu ku kv kw mv ky kz la mw lc ld le dt translated">另外，阅读</h1><ul class=""><li id="c8b3" class="lk ll ht is b it lf ix lg jb mx jf my jj mz jn na lq lr ls dt translated"><a class="ae jo" href="https://coincodecap.com/bookmap-review-2021-best-trading-software" rel="noopener ugc nofollow" target="_blank"> Bookmap评论</a> | <a class="ae jo" href="https://coincodecap.com/crypto-exchange-usa" rel="noopener ugc nofollow" target="_blank">美国5大最佳加密交易所</a></li><li id="35c8" class="lk ll ht is b it nb ix nc jb nd jf ne jj nf jn na lq lr ls dt translated">最佳加密<a class="ae jo" rel="noopener" href="/coinmonks/hardware-wallets-dfa1211730c6">硬件钱包</a> | <a class="ae jo" rel="noopener" href="/coinmonks/bitbns-review-38256a07e161"> Bitbns评论</a></li><li id="12ab" class="lk ll ht is b it nb ix nc jb nd jf ne jj nf jn na lq lr ls dt translated"><a class="ae jo" href="https://coincodecap.com/crypto-exchange-in-singapore" rel="noopener ugc nofollow" target="_blank">新加坡十大最佳加密交易所</a> | <a class="ae jo" href="https://coincodecap.com/buy-axs-token" rel="noopener ugc nofollow" target="_blank">购买AXS </a></li><li id="53c4" class="lk ll ht is b it nb ix nc jb nd jf ne jj nf jn na lq lr ls dt translated"><a class="ae jo" href="https://coincodecap.com/red-dog-casino-review" rel="noopener ugc nofollow" target="_blank">红狗赌场评论</a> | <a class="ae jo" href="https://coincodecap.com/swyftx-review" rel="noopener ugc nofollow" target="_blank"> Swyftx评论</a> | <a class="ae jo" href="https://coincodecap.com/coingate-review" rel="noopener ugc nofollow" target="_blank">造币厂评论</a></li><li id="fd4a" class="lk ll ht is b it nb ix nc jb nd jf ne jj nf jn na lq lr ls dt translated"><a class="ae jo" href="https://coincodecap.com/best-crypto-to-invest-in-india-in-2021" rel="noopener ugc nofollow" target="_blank">投资印度的最佳密码</a>|<a class="ae jo" href="https://coincodecap.com/wazirx-p2p" rel="noopener ugc nofollow" target="_blank">WazirX P2P</a>|<a class="ae jo" href="https://coincodecap.com/hi-dollar-review" rel="noopener ugc nofollow" target="_blank">Hi Dollar Review</a></li></ul></div></div>    
</body>
</html>