<html>
<head>
<title>Lightning at the Command Line</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">命令行中的闪电</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/lightning-at-the-command-line-4b98fccf5c36?source=collection_archive---------16-----------------------#2022-03-11">https://medium.com/coinmonks/lightning-at-the-command-line-4b98fccf5c36?source=collection_archive---------16-----------------------#2022-03-11</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="918e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">介绍如何使用LND工具创建发票和付款报表</p><p id="06e1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">作者@ vicariousdrama</p><p id="a661" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt">714130–714326</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/7172a525877d7eb46ca10636cafc5e22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C-r3h5rZSkEt145n0FykTQ.png"/></div></div></figure><h1 id="55f0" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">摘要</h1><p id="8d20" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">本文的目的是指导用户使用一些命令行操作来查询他们的lightning节点，并使用基本的格式和JSON处理工具生成摘要报告。本文假设您已经有一个运行LND的lightning节点，并且可以访问命令提示符。如果你还没有一个lightning节点，可以考虑检查一下<a class="ae ld" href="https://bitcoiner.guide/node/" rel="noopener ugc nofollow" target="_blank">各种各样的节点项目</a>，或者甚至使用<a class="ae ld" href="https://voltage.cloud/" rel="noopener ugc nofollow" target="_blank"> voltage.cloud </a>建立一个节点。命令以一种逐渐构建整体结果的方式呈现，以便我们可以更好地理解结果中的每个部分。如果你只想复制-粘贴最终结果，你可以跳到主要部分的末尾。</p><h1 id="03c2" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">发票</h1><p id="1716" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">发票是从闪电节点发起的付款请求，另一个节点应该为其付款。请求的创建超出了本文的范围，通常是使用应用程序或接口创建的，如ThunderHub、Ride The Lightning或支持Lightning的钱包。</p><h2 id="0097" class="le kb ht bd kc lf lg lh kg li lj lk kk jb ll lm ko jf ln lo ks jj lp lq kw lr dt translated">列出发票</h2><p id="6e06" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">在命令行中，我们可以使用<code class="eh ls lt lu lv b">lncli</code>工具，即带有listinvoices命令的lightning网络守护程序(lnd)的控制平面。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/d338b7be7552c69a36a112f3c2c5a0b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*RMmrvK_0xmfqaXq6_1gvsw.png"/></div></figure><p id="8001" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这将输出一些JSON格式的发票。我们可以使用<code class="eh ls lt lu lv b">jq</code>命令轻松地应用一些格式和颜色语法着色来提高可读性。稍后我们也将使用这个工具进行过滤。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/9060e2fe7902dc39b60f0428060787e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*MfHD5KcbjlBQiHLyJWenCw.png"/></div></figure><p id="d408" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果有发票，它们将以JSON格式列出，每个发票有几个字段。虽然所有这些字段都有其用途，但我们最关心的报告字段是<code class="eh ls lt lu lv b">memo</code>、<code class="eh ls lt lu lv b">value</code>、<code class="eh ls lt lu lv b">settled</code>、<code class="eh ls lt lu lv b">creation_date</code>、<code class="eh ls lt lu lv b">settle_date</code>、<code class="eh ls lt lu lv b">amt_paid_sat</code>和<code class="eh ls lt lu lv b">state</code>。在后续部分中，此处突出显示的颜色将包含在命令中，以引起对其使用位置的注意。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/9cd5bb9725a48023c1e6730195ec5809.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*hlx7kQN3LeTapjDlcr-mWw.png"/></div></figure><h2 id="3a43" class="le kb ht bd kc lf lg lh kg li lj lk kk jb ll lm ko jf ln lo ks jj lp lq kw lr dt translated">仅列出已支付的发票</h2><p id="a3cf" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">这是过滤结果的命令，只显示那些已付费的结果</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/cdcdb9f350eeb3bdb54847368d4e4ba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*LO7CEfrQdiC8KJIi5-qM4w.png"/></div></figure><h2 id="d34b" class="le kb ht bd kc lf lg lh kg li lj lk kk jb ll lm ko jf ln lo ks jj lp lq kw lr dt translated">仅列出失败的发票</h2><p id="319f" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">该命令改变过滤器，以显示那些由于支付前超时而最终被取消的。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/67b6c3bff4bbb9a2a0121af047744e3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*uYfrsOEDsuZelIBMckAcew.png"/></div></figure><h2 id="e774" class="le kb ht bd kc lf lg lh kg li lj lk kk jb ll lm ko jf ln lo ks jj lp lq kw lr dt translated">列出一段时间内支付的发票</h2><p id="b953" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">为了将发票限制在一段时间内，我们将建立一些变量，并更新那些被选择的发票的过滤器。<code class="eh ls lt lu lv b">date</code>命令将返回从epoch开始的秒数，并从当天的第一秒开始。每天由86400秒组成。对于结束日期，我们希望将结果提前一天，减去一秒钟，以确保全天都包含在周期中。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/d21d6a6334f641601ac9b067c4597c82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*FE85nnurbUDQItgdNzOl8Q.png"/></div></figure><p id="6a5f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">同样，我们可以将选择的发票限制在一个月内</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff ma"><img src="../Images/3a6627e8ff51c8399ff80efd7b8cceb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*mPEbxvKRGd9bfHp0CHFw0Q.png"/></div></div></figure><h2 id="d3f8" class="le kb ht bd kc lf lg lh kg li lj lk kk jb ll lm ko jf ln lo ks jj lp lq kw lr dt translated">控制发票的输出</h2><p id="e535" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">到目前为止，我们的输出只是JSON。出于报告目的，我们将开始逐行清理输出以报告信息。有了选定的对象，我们可以进一步使用<code class="eh ls lt lu lv b">jq</code>命令行JSON处理器来直接输出一个字符串的串联值。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff mb"><img src="../Images/9982f9ef2b86c04719174aff7f2200e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*VlEHbejfHvE6cUumrWODHQ.png"/></div></figure><p id="5cd9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">以下是从字符串格式化的示例结果</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/48dcc519efcf7dc695274b1eae5d7d48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*skVOxAzRKQiuzK9zEJE3BQ.png"/></div></figure><p id="9cbc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们使用一些简单的格式，通过在左侧创建空格来右对齐值字段。这使得在有多行时更容易阅读数字。在这个例子中，我们使用内置的<code class="eh ls lt lu lv b">tostring</code>函数将<code class="eh ls lt lu lv b">value</code>字段转换成一个字符串。然后，将使用内置的<code class="eh ls lt lu lv b">length</code>函数，用空格将它写出来，直到8减去值的长度。例如，如果值是123，则它的长度为3，为了使它的总长度为8，将在前面写5个空格。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/a4d62f172609fc3dd95c9cf86b8fad41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*0MWEL9V3EWl24NK3Oy-Y4g.png"/></div></figure><p id="3f29" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">下面是修改后的示例结果，显示了值左侧的额外空格填充。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/26dc87db20c4e3bcf92eb10012922f39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*Bao1_MOx1H_8L9ftkWG6zw.png"/></div></figure><p id="6619" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为了显示我们排列的值，让我们对所有发票运行相同的报告。为此，我们将把开始日期更改为更早的时间。您的结果将根据您过去的发票数量而有所不同。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/bdd1f0cf8eb8131fe27ba1aab689ba80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*cB_gH7c62_T4mcmxyaU_wA.png"/></div></figure><p id="ac72" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">下面是一些显示值对齐的示例结果。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/d9d94f8a5b3d6f995879159e5c6b5369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*_ta-OD4HuV-zsZoOdXEOyg.png"/></div></figure><h2 id="b51e" class="le kb ht bd kc lf lg lh kg li lj lk kk jb ll lm ko jf ln lo ks jj lp lq kw lr dt translated">获取发票的过滤结果</h2><p id="563d" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">接下来，我们将对数据集执行多个查询。为了避免给服务本身带来不必要的负担，并确保我们在查询之间总是使用相同的数据，我们可以将结果捕获到一个变量中，并在格式化中使用它。</p><p id="b04f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这里，我们将数据捕获到一个名为<code class="eh ls lt lu lv b">REPORT_DATA</code>的变量中</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/7ecd8d62d203a54cb59d77c634b2cb7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*gttntH2-PFgmvCOZoyAOxg.png"/></div></figure><p id="379d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在让我们使用它，并更改我们的输出，以可读的格式显示日期，然后是memo字段，最后是右对齐的金额。</p><p id="3684" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为了转换日期，我们获取字符串，使用内置的<code class="eh ls lt lu lv b">tonumber</code>函数将其转换为数字，然后在解析其中的年、月和日部分之前，将其传递给另一个内置函数<code class="eh ls lt lu lv b">todateiso8601</code>。</p><p id="b661" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">memo字段将是左对齐的，而右对齐的字段在它之前创建空格，我们希望在它的值之后写出额外的空格。</p><p id="0b75" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后，对于值字段，让我们扩展长度，这将在以后更好地说明一个头。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff md"><img src="../Images/5c07277caf753b66699f44559a7020b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*ykUX4AWfTIM7GJXuAkE5Zg.png"/></div></figure><p id="b812" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这是我们用新格式修改后的样本结果。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff me"><img src="../Images/92e4b93a7c39e7f410286427af8c5aed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*4Y4fcP21uChacWQHZ-JlnA.png"/></div></figure><h2 id="3b1b" class="le kb ht bd kc lf lg lh kg li lj lk kk jb ll lm ko jf ln lo ks jj lp lq kw lr dt translated">为发票创建标题</h2><p id="10e1" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">我们可以在报告中添加一个标题，为呈现的数据提供上下文。让我们添加该时间段的报告标题以及列名。</p><p id="0ff2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">对于这段时间，我们将以秒为单位的数字开始和结束日期转换回可读的时间戳。列标题将被隔开以匹配数据，最后，我们将在标题和数据之间创建一条线。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/b1f6f9a355eb8e87232949be908a9315.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*pcIEkeAetcLukhll83R3cA.png"/></div></figure><p id="7e99" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们的样本结果</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/312cee9a26c39f2d10429be0beba2247.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*MhFpWcsmURonJILElzxshQ.png"/></div></figure><p id="920e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们将它们结合起来，这样命令输出就可以一起运行，而不需要分散命令行提示符。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/36c8f32119422a28e15bc3f4c65d3721.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*LgvVf7gnuvWzXbUatv52rA.png"/></div></figure><p id="e990" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">页眉现在看起来干净多了。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/5ac421dc2a4f76d8d5e8e5df8972b784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*N2tJ7iOz0LsnHFxRhK9yvA.png"/></div></figure><h2 id="609e" class="le kb ht bd kc lf lg lh kg li lj lk kk jb ll lm ko jf ln lo ks jj lp lq kw lr dt translated">计算发票页脚的总额</h2><p id="d327" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">如果我们总结一下这段时间收到的sat总数，将会很有帮助。我们可以这样做:接受输入，将值转换为数字，减少数组，初始化临时变量，并为数组中的每一项添加值。这听起来可能比实际更复杂，但是不要担心，通过命令和结果会变得很清楚。结果我们将存储在另一个变量中。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff me"><img src="../Images/65e77f3640fe60816e20743672ddb959.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*ynk5SmUi1Jb7dJEOYhaGrA.png"/></div></figure><p id="d2d5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">要了解其价值，我们可以将它显示出来</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/2d7fd2d337b503777cb7ea562d64783f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*iFI1j0fXxdUbYf3A7R3hIg.png"/></div></figure><p id="fda4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">样本结果</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/b9a6139f0b7116b441a3c9913c1d7b30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*diNRdfP3RYhFxXwow38Z_A.png"/></div></figure><p id="67b6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">有了总数，我们现在可以把它放入页脚。我们将画另一条线来封闭数据并报告总数</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/024261d3882704a365a896560e3f9a7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*7AO5Oa2TE4EGcb_XeINyXQ.png"/></div></figure><p id="da07" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">示例页脚</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/5d0df4d670617ad4048a209b9c5c6665.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*hivl4q--HcSoBg4WPb_-QA.png"/></div></figure><h2 id="fce6" class="le kb ht bd kc lf lg lh kg li lj lk kk jb ll lm ko jf ln lo ks jj lp lq kw lr dt translated">发票总报告</h2><p id="615c" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">现在让我们把上面的所有部分合并成一个简单的命令集。我们可以把它保存到一个文件中，以备后用。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/b5721a28aaac1da3176f8462e272e0eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*C7G7UHXoQQ8lS-_BhObGTQ.png"/></div></figure><p id="e778" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这是发票的样本报告</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/8a2bdb8c1c0fb8047ed54fb85491f037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*HvlaOiOVOPTlPn0gJWB4dg.png"/></div></figure><h1 id="8425" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">支付</h1><p id="926e" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">对于付款报告，我们将假设发票部分中概述的一些相同的概念。</p><h2 id="bb5d" class="le kb ht bd kc lf lg lh kg li lj lk kk jb ll lm ko jf ln lo ks jj lp lq kw lr dt translated">列出付款</h2><p id="ecb3" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">为了列出成功的支付，我们可以使用带有<code class="eh ls lt lu lv b">listpayments</code>操作的<code class="eh ls lt lu lv b">lncli</code>命令，然后使用<code class="eh ls lt lu lv b">jq</code> JSON处理器进行过滤。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/9ba90e350a1598f7a42d7f1b2e45f53c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*Ls-NCRJPlNE4iWjepyMaNA.png"/></div></figure><p id="62f9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果有付款，它们将以JSON格式列出，每个都有几个字段。虽然所有这些字段都有其用途，但我们最关心的报告字段是<code class="eh ls lt lu lv b">value</code>、<code class="eh ls lt lu lv b">creation_date</code>、<code class="eh ls lt lu lv b">fee</code>和<code class="eh ls lt lu lv b">status</code>。在后续部分中，此处突出显示的颜色将包含在命令中，以引起对其使用位置的注意。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/229bf22dffcd473fc9b1452a1cb6651a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*thDzXRZW9q7Y0_3kPtHHZA.png"/></div></figure><p id="30f5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在<code class="eh ls lt lu lv b">htlcs</code>字段(散列时间锁合同)中，有更多关于支付所采用的路由路径的细节，以及为每一跳支付的精确到毫微微秒的费用。对于这个基本报告，我们将坚持到下一个星期六的基本费用汇总。</p><h2 id="ade8" class="le kb ht bd kc lf lg lh kg li lj lk kk jb ll lm ko jf ln lo ks jj lp lq kw lr dt translated">获取过滤后的支付结果</h2><p id="71fd" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">让我们设置报告的开始和结束日期，并将匹配的付款捕获到一个变量中。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/0f7904a34be7060402c3feeaa1ed2a6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*0l-Uju-aovP76bfXUm9piQ.png"/></div></figure><h2 id="475a" class="le kb ht bd kc lf lg lh kg li lj lk kk jb ll lm ko jf ln lo ks jj lp lq kw lr dt translated">获取付款总额</h2><p id="3554" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">接下来，出于报告目的，让我们合计已支付的发票总额、费用和总总额。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/f2d7571eb8af8d417bde24e4f47e57d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*tZLR5W6LKdm-MDkUnGJqRw.png"/></div></figure><h2 id="452d" class="le kb ht bd kc lf lg lh kg li lj lk kk jb ll lm ko jf ln lo ks jj lp lq kw lr dt translated">付款总报告</h2><p id="f2dc" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">与发票报告类似，我们准备一份付款报告，它有一个标题块，后面是数据行，然后是一个页脚，上面有计算出的金额。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/59dcceacafb1754a0a8d2eafc1eb65ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*DD-nRj8ch2D9gA76hKlcyA.png"/></div></figure><p id="f051" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">下面是一个示例报告输出</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/ece9da97581c02ee79be8b2a8dff1b54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*awcW8G2pZ8QFTr2xRoDCbQ.png"/></div></figure><h1 id="4d32" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">结论</h1><p id="2d8d" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">使用命令行，我们为通过lightning服务创建的发票构建了一个报告。按日期周期进行基本过滤可以让我们的报告更加灵活。数据的文本对齐、日期格式化以及页眉和页脚的创建有助于生成有用的摘要报告。然后，我们将相同的概念应用于创建支付报告。您可以考虑将此作为获得更多报告和自动化的垫脚石。如果你认为我应该创建更多这样的指南，或者对它进行扩展，请在文章上留下评论。</p><blockquote class="mf"><p id="c1f3" class="mg mh ht bd mi mj mk ml mm mn mo jn ek translated">加入Coinmonks <a class="ae ld" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae ld" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="1df8" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl mp kn ko kp mq kr ks kt mr kv kw kx dt translated">另外，阅读</h1><ul class=""><li id="657d" class="ms mt ht is b it ky ix kz jb mu jf mv jj mw jn mx my mz na dt translated"><a class="ae ld" rel="noopener" href="/coinmonks/cryptocurrency-savings-accounts-be3bc0feffbf">加密货币储蓄账户</a> | <a class="ae ld" rel="noopener" href="/coinmonks/yobit-review-175464162c62"> YoBit审核</a></li><li id="3910" class="ms mt ht is b it nb ix nc jb nd jf ne jj nf jn mx my mz na dt translated"><a class="ae ld" rel="noopener" href="/coinmonks/botsfolio-vs-napbots-vs-mudrex-c81344970c02">Botsfolio vs nap bots vs Mudrex</a>|<a class="ae ld" rel="noopener" href="/coinmonks/gate-io-exchange-review-61bf87b7078f">gate . io交流回顾</a></li><li id="d428" class="ms mt ht is b it nb ix nc jb nd jf ne jj nf jn mx my mz na dt translated"><a class="ae ld" href="https://coincodecap.com/coinflex-review" rel="noopener ugc nofollow" target="_blank"> CoinFLEX评论</a> | <a class="ae ld" href="https://coincodecap.com/aex-exchange-review" rel="noopener ugc nofollow" target="_blank"> AEX交易所评论</a> | <a class="ae ld" href="https://coincodecap.com/upbit-review" rel="noopener ugc nofollow" target="_blank"> UPbit评论</a></li><li id="1bb7" class="ms mt ht is b it nb ix nc jb nd jf ne jj nf jn mx my mz na dt translated"><a class="ae ld" href="https://coincodecap.com/ascendex-margin-trading" rel="noopener ugc nofollow" target="_blank"> AscendEx保证金交易</a> | <a class="ae ld" href="https://coincodecap.com/bitfinex-staking" rel="noopener ugc nofollow" target="_blank"> Bitfinex赌注</a> | <a class="ae ld" href="https://coincodecap.com/bitflyer-review" rel="noopener ugc nofollow" target="_blank"> bitFlyer点评</a></li><li id="f340" class="ms mt ht is b it nb ix nc jb nd jf ne jj nf jn mx my mz na dt translated"><a class="ae ld" href="https://coincodecap.com/bitget-review" rel="noopener ugc nofollow" target="_blank"> Bitget回顾</a>|<a class="ae ld" href="https://coincodecap.com/gemini-vs-blockfi" rel="noopener ugc nofollow" target="_blank">Gemini vs block fi</a>cmd |<a class="ae ld" href="https://coincodecap.com/okex-futures-trading" rel="noopener ugc nofollow" target="_blank">OKEx期货交易</a></li></ul></div></div>    
</body>
</html>