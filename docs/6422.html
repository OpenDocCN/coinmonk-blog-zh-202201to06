<html>
<head>
<title>Beosin’s Detailed Analysis of Fortress’s Oracle Manipulation Attack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Beosin对Fortress的甲骨文操纵攻击的详细分析</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/beosins-detailed-analysis-of-fortress-s-oracle-manipulation-attack-7c41555d445d?source=collection_archive---------21-----------------------#2022-05-09">https://medium.com/coinmonks/beosins-detailed-analysis-of-fortress-s-oracle-manipulation-attack-7c41555d445d?source=collection_archive---------21-----------------------#2022-05-09</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="c13e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2022年5月9日，据Beosin EagleEye报道，FortressPriceOracle的链式合约被一个Oracle操纵攻击利用了约1028.1 ETH和40万DAi。Beosin安全团队分析了该事件，结果如下所示。</p><h1 id="d646" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated"><strong class="ak">要塞简介</strong></h1><p id="ef25" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated">Fortress Credit and Lending(Fortress)是一个算法货币市场和合成稳定硬币协议，旨在为用户提供安全可靠的信贷和贷款。官方网站:【https://fortress.loans/ T2】</p><h1 id="dc0f" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated"><strong class="ak">相关信息</strong></h1><p id="2ab5" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated">事务哈希:</p><p id="c448" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">0x13d 19809 b 19 AC 512 da 6d 6d 110764 caee 75 e 2157 ea 62 CB 70937 c 8d 9471 afcb 061 BF</p><p id="88a7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">黑客地址:</p><p id="9d36" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">0 xa 6 af 2872176320015 F8 DDB 2 ba 013 b 38 CB 35d 22 ad</p><p id="90bb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">黑客合同:</p><p id="fce4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">0xcd 337 b 920678 cf 35143322 ab 31 ab 8977 c 3463 a 45</p><p id="d76b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">受害者合同:</p><p id="a392" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">0x 00 fcf 33 BFA 9 E3 ff 791 B2 b 819 ab 2446861 a 318285</p><h1 id="2894" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated"><strong class="ak">开发流程</strong></h1><ol class=""><li id="f845" class="ks kt ht is b it km ix kn jb ku jf kv jj kw jn kx ky kz la dt translated">攻击者从Tornado.cash提取20ETH，将12.4ETH存入Celer network，然后转入攻击合同。</li></ol><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lb"><img src="../Images/1623347c4ccab74161443f739eb492bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*exmbXz27YNdw2xfTJByd5A.png"/></div></div></figure><p id="c61f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2.攻击者利用部署的契约提交恶意价格，使FTS值极高，然后利用FTS增加的值从FBep20Delelgator中换出所有令牌。</p><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lb"><img src="../Images/e5fb245403cd63109c3d6af4ae330432.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9uP5Xq-dEqYS2XEe1hqeVg.png"/></div></div></figure><p id="8f15" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">3.攻击者在发起攻击时提交FTS价格的变化，此时Oracle调用链中的函数来获取价格。</p><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lb"><img src="../Images/5f0e13f0a5fdb32070ed412023e74b99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J_najK3aBYgQkxhkU0nXXw.png"/></div></div></figure><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lb"><img src="../Images/fca9a18744997dfca280c0cd89155eed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nAz4DP4QXG_kwTZynGIKbQ.png"/></div></div></figure><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lb"><img src="../Images/3be95bd1e06b625cce005c65b34f5359.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PEmoxezgD5IaQmZ42aCblg.png"/></div></div></figure><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lb"><img src="../Images/0c37da8036a2dae511a9511110ddab97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RxK-ExNO0aSro4UCwEVUJg.png"/></div></div></figure><p id="2d20" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">4.Chain用于dpos权限验证的submit函数被注释，power的值= 0。只要签名通过，任何地址都可以成功提交并修改价格。</p><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lb"><img src="../Images/9f4b33fb297ad1f6fe80ee729c47e027.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-BhDiywFWdM7_kwJJIA9eQ.png"/></div></div></figure><p id="1d8c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">5.攻击者最终将窃取的资金换成ETH。</p><h1 id="04f9" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated"><strong class="ak">漏洞分析</strong></h1><p id="06ae" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated">这种攻击主要利用了Oracle获取的数据源链不验证权力的漏洞，从而操纵抵押品价格。</p><h1 id="5881" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated"><strong class="ak">资金追踪</strong></h1><p id="59f6" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated">在撰写本文时，攻击契约已经自毁。被盗的1048.1 ETH和40万DAI被存入了龙卷风现金。</p><figure class="lc ld le lf fq lg fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff ln"><img src="../Images/d21f880a61a482775802297ff713ca3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JBUwrXBR8xKx7Tjhdn89QA.png"/></div></div></figure><h1 id="14bd" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated"><strong class="ak">总结</strong></h1><p id="f0e3" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated">针对这一事件，Beosin安全团队建议:</p><p id="c999" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">1.验证Oracle获得的价格数据的来源非常重要。建议使用TWAP。</p><p id="c756" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2.项目上线前，强烈建议选择专业的安全审计公司进行全面的安全审计，规避安全风险。</p><h1 id="24fb" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated">更大的</h1><p id="1310" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated"><a class="ae kr" rel="noopener" href="/@Beosin_com/vaas-automatic-detection-tool-make-your-smart-contract-secure-in-web3-0-c3431f5c6ff"> <strong class="is hu"> <em class="lo"> 1。VaaS —自动检测工具，让您的智能合约在Web3.0中安全</em> </strong> </a></p><p id="bfe9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae kr" rel="noopener" href="/@Beosin_com/how-to-ensure-the-security-of-nft-under-the-web-3-0-boom-beosin-vaas-has-provided-with-a-solution-50697ccd4f56"> <strong class="is hu"> <em class="lo"> 2。在Web 3.0热潮下，如何保证NFT的安全？</em> </strong> </a></p><p id="fa19" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae kr" rel="noopener" href="/@Beosin_com/deus-finance-suffered-its-second-flashloan-attack-this-year-beosins-detailed-analysis-5032be0ec4f2"> <strong class="is hu"> <em class="lo"> 3。DEUS Finance遭遇今年第二次闪贷攻击:Beosin详细分析</em> </strong> </a></p><p id="a0c9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae kr" rel="noopener" href="/@Beosin_com/beosin-has-completed-security-audit-service-of-crypto-lego-alg-no-critical-high-or-medium-risk-b656849e9334"> <strong class="is hu"> <em class="lo"> 4。Beosin已完成加密乐高算法</em> </strong> </a>的安全审计服务</p><p id="42de" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae kr" rel="noopener" href="/@Beosin_com/beosin-has-completed-security-audit-service-of-masterchefv2-and-cake-pool-contracts-in-pancakeswap-4dafa0aa6068"> <strong class="is hu"> <em class="lo"> 5。Beosin已完成PancakeSwap</em></strong></a>master chef v2和蛋糕池合同的安全审计服务</p><p id="f015" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae kr" rel="noopener" href="/@Beosin_com/recap-ama-about-how-to-keep-your-smart-contract-secure-during-development-with-beosin-vaas-f7ecd2dc27a"> <strong class="is hu"> <em class="lo"> 6。「重述」AMA关于如何在使用Beosin VaaS </em> </strong> </a>开发期间保护您的智能合约的安全</p><h1 id="b216" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated">接触</h1><p id="9b2c" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated">如果您需要任何区块链安全服务，请联系我们:</p><p id="7e8e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae kr" href="https://beosin.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">网站</strong> </a> <strong class="is hu"> </strong> <a class="ae kr" href="http://contact@beosin.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">邮箱</strong> </a> <strong class="is hu"> </strong> <a class="ae kr" href="https://twitter.com/Beosin_com" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">官方推特</strong> </a> <strong class="is hu"> </strong> <a class="ae kr" href="https://twitter.com/BeosinAlert" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">预警</strong> </a> <strong class="is hu"> </strong> <a class="ae kr" href="https://t.me/beosin" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">电报</strong></a><strong class="is hu"/><a class="ae kr" href="https://www.linkedin.com/company/beosin" rel="noopener ugc nofollow" target="_blank"><strong class="is hu">LinkedIn</strong></a></p><blockquote class="lp"><p id="4750" class="lq lr ht bd ls lt lu lv lw lx ly jn ek translated">加入Coinmonks <a class="ae kr" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae kr" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="c1ae" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz lz kb kc kd ma kf kg kh mb kj kk kl dt translated">另外，阅读</h1><ul class=""><li id="ccde" class="ks kt ht is b it km ix kn jb ku jf kv jj kw jn mc ky kz la dt translated"><a class="ae kr" href="https://coincodecap.com/okex-kucoin" rel="noopener ugc nofollow" target="_blank"> OKEx vs KuCoin </a> | <a class="ae kr" href="https://coincodecap.com/celsius-alternatives" rel="noopener ugc nofollow" target="_blank">摄氏替代度</a> | <a class="ae kr" href="https://coincodecap.com/buy-vechain" rel="noopener ugc nofollow" target="_blank">如何购买VeChain </a></li><li id="1341" class="ks kt ht is b it md ix me jb mf jf mg jj mh jn mc ky kz la dt translated"><a class="ae kr" href="https://coincodecap.com/binance-futures-trading" rel="noopener ugc nofollow" target="_blank">币安期货交易</a>|<a class="ae kr" href="https://coincodecap.com/mudrex-3commas-etoro" rel="noopener ugc nofollow" target="_blank">3 commas vs Mudrex vs eToro</a></li><li id="2fb3" class="ks kt ht is b it md ix me jb mf jf mg jj mh jn mc ky kz la dt translated"><a class="ae kr" href="https://coincodecap.com/buy-monero" rel="noopener ugc nofollow" target="_blank">如何购买Monero </a> | <a class="ae kr" href="https://coincodecap.com/idex-review" rel="noopener ugc nofollow" target="_blank"> IDEX评论</a> | <a class="ae kr" href="https://coincodecap.com/bitkan-trading-bot" rel="noopener ugc nofollow" target="_blank"> BitKan交易机器人</a></li><li id="9bf5" class="ks kt ht is b it md ix me jb mf jf mg jj mh jn mc ky kz la dt translated"><a class="ae kr" rel="noopener" href="/coinmonks/coindcx-review-8444db3621a2"> CoinDCX评论</a> | <a class="ae kr" href="https://coincodecap.com/crypto-margin-trading-exchanges" rel="noopener ugc nofollow" target="_blank">加密保证金交易交易所</a></li><li id="653a" class="ks kt ht is b it md ix me jb mf jf mg jj mh jn mc ky kz la dt translated"><a class="ae kr" href="https://coincodecap.com/red-dog-casino-review" rel="noopener ugc nofollow" target="_blank">红狗赌场评论</a> | <a class="ae kr" href="https://coincodecap.com/swyftx-review" rel="noopener ugc nofollow" target="_blank"> Swyftx评论</a> | <a class="ae kr" href="https://coincodecap.com/coingate-review" rel="noopener ugc nofollow" target="_blank"> CoinGate评论</a></li><li id="53e4" class="ks kt ht is b it md ix me jb mf jf mg jj mh jn mc ky kz la dt translated"><a class="ae kr" href="https://coincodecap.com/bookmap-review-2021-best-trading-software" rel="noopener ugc nofollow" target="_blank"> Bookmap评论</a> | <a class="ae kr" href="https://coincodecap.com/crypto-exchange-usa" rel="noopener ugc nofollow" target="_blank">美国5大最佳加密交易所</a></li></ul></div></div>    
</body>
</html>