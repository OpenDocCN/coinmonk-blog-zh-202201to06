<html>
<head>
<title>Building Smart Contracts with Hardhat (Everything You Need To Know)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与Hardhat建立智能合同(您需要知道的一切)</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/hardhat-development-everything-you-need-to-know-4cc93e309377?source=collection_archive---------21-----------------------#2022-06-27">https://medium.com/coinmonks/hardhat-development-everything-you-need-to-know-4cc93e309377?source=collection_archive---------21-----------------------#2022-06-27</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="1738" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">安全帽开发环境介绍</h2></div><p id="0a6c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">#康普西#区块链#以太坊#坚固</p><figure class="kf kg kh ki fq kj fe ff paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="fe ff ke"><img src="../Images/09f8fd321a33e59285cb4b2efdb4fb0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*X8Uv3NFBdjpqgEaQ"/></div></div><figcaption class="kq kr fg fe ff ks kt bd b be z ek">Photo by <a class="ae ku" href="https://unsplash.com/@lazycreekimages?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Michael Dziedzic</a> on <a class="ae ku" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div><div class="ab cl kv kw hb kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hm hn ho hp hq"><h1 id="3418" class="lc ld ht bd le lf lg lh li lj lk ll lm iz ln ja lo jc lp jd lq jf lr jg ls lt dt translated">介绍</h1><p id="fc0e" class="pw-post-body-paragraph ji jj ht jk b jl lu iu jn jo lv ix jq jr lw jt ju jv lx jx jy jz ly kb kc kd hm dt translated">Hardhat是一个开发环境来<strong class="jk hu">编译</strong>、<strong class="jk hu">部署</strong>、<strong class="jk hu">测试</strong>、&amp;、<strong class="jk hu">调试</strong>你的<strong class="jk hu">以太坊程序</strong>。这是通过<strong class="jk hu"> Hardhat Runner </strong>完成的，它是一个<strong class="jk hu"> CLI命令工具</strong>，作为所有Hardhat特性和功能的可扩展<strong class="jk hu">任务运行器</strong>。</p><p id="1700" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">Hardhat通过项目中的<strong class="jk hu">本地安装</strong>使用。</p><p id="7d96" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">要安装它，您需要创建一个npm项目，方法是在CLI中键入<code class="eh lz ma mb mc b">npm init</code>，然后键入<code class="eh lz ma mb mc b">npm install --save-dev hardhat</code>。</p><pre class="kf kg kh ki fq md mc me mf aw mg dt"><span id="5e67" class="mh ld ht mc b fv mi mj l mk ml">npm install --save-dev hardhat</span></pre><p id="c573" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">一旦完成，运行<code class="eh lz ma mb mc b">npx hardhat</code>创建一个<strong class="jk hu">准系统安全帽环境</strong>。所有与hardhat进行的交互都必须使用该命令，后跟所需的可执行任务&amp;选项。</p><pre class="kf kg kh ki fq md mc me mf aw mg dt"><span id="8aba" class="mh ld ht mc b fv mi mj l mk ml">npx hardhat compile</span></pre><p id="5566" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">最后，从控制台中选择“创建一个示例项目”选项。这将建立一个项目并安装<code class="eh lz ma mb mc b"><a class="ae ku" href="http://twitter.com/nomiclabs/hardhat-ethers" rel="noopener ugc nofollow" target="_blank">@nomiclabs/hardhat-ethers</a></code>、<code class="eh lz ma mb mc b"><a class="ae ku" href="http://twitter.com/nomiclabs/hardhat-waffle" rel="noopener ugc nofollow" target="_blank">@nomiclabs/hardhat-waffle</a></code>和其他必要的软件包。</p><h1 id="0466" class="lc ld ht bd le lf mm lh li lj mn ll lm iz mo ja lo jc mp jd lq jf mq jg ls lt dt translated">收集</h1><p id="910a" class="pw-post-body-paragraph ji jj ht jk b jl lu iu jn jo lv ix jq jr lw jt ju jv lx jx jy jz ly kb kc kd hm dt translated">任务<code class="eh lz ma mb mc b">compile</code>将编译一个安全帽项目。</p><pre class="kf kg kh ki fq md mc me mf aw mg dt"><span id="1cff" class="mh ld ht mc b fv mi mj l mk ml">npx hardhat compile</span></pre><p id="f52c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在初始编译之后，如果没有对项目进行可观察到的改变，hardhat将不会编译。如果需要，可以通过添加<code class="eh lz ma mb mc b">--force</code>选项来强制编译。或者，可以使用<code class="eh lz ma mb mc b">clean</code>任务来清除缓存并删除所有工件。</p><h1 id="f45e" class="lc ld ht bd le lf mm lh li lj mn ll lm iz mo ja lo jc mp jd lq jf mq jg ls lt dt translated">配置</h1><p id="5c05" class="pw-post-body-paragraph ji jj ht jk b jl lu iu jn jo lv ix jq jr lw jt ju jv lx jx jy jz ly kb kc kd hm dt translated">在<code class="eh lz ma mb mc b">module.export</code>包内的<code class="eh lz ma mb mc b">hardhat.config.js</code>中进行配置更改。该模块中可用的字段有<code class="eh lz ma mb mc b">defaultNetwork</code>、<code class="eh lz ma mb mc b">network</code>、<code class="eh lz ma mb mc b">solidity</code>、<code class="eh lz ma mb mc b">paths</code>和<code class="eh lz ma mb mc b">mocha</code>。</p><p id="ddb3" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><em class="mr">以下是使用外部节点的通用安全帽配置:</em></p><figure class="kf kg kh ki fq kj"><div class="bz el l di"><div class="ms mt l"/></div></figure><h1 id="c939" class="lc ld ht bd le lf mm lh li lj mn ll lm iz mo ja lo jc mp jd lq jf mq jg ls lt dt translated">网络</h1><p id="c878" class="pw-post-body-paragraph ji jj ht jk b jl lu iu jn jo lv ix jq jr lw jt ju jv lx jx jy jz ly kb kc kd hm dt translated">Hardhat提供了内置的本地<strong class="jk hu">以太坊网络</strong>。</p><p id="ba2b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">默认情况下，启动时实例会自动启动。</p><p id="bc3c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh lz ma mb mc b">node</code>任务为Hardhat网络公开了一个<code class="eh lz ma mb mc b">JSON-RPC</code>接口，使其可以被外部客户端访问。</p><pre class="kf kg kh ki fq md mc me mf aw mg dt"><span id="d15d" class="mh ld ht mc b fv mi mj l mk ml">npx hardhat node</span></pre><p id="0815" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="jk hu">也可以使用外部JSON-RPC </strong>(远程过程调用)网络，将hardhat开发环境扩展到<strong class="jk hu">test net</strong>和<strong class="jk hu">main net</strong>。然而，这些外部网络必须在<code class="eh lz ma mb mc b">hardhat.config.js</code>文件中的<code class="eh lz ma mb mc b">network</code>字段下进行配置。</p><p id="684d" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这里是一个基本的网络配置:</p><figure class="kf kg kh ki fq kj"><div class="bz el l di"><div class="ms mt l"/></div></figure><p id="407c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">一旦配置完成，如果选项可用，任务可以显式声明一个带<code class="eh lz ma mb mc b">--network</code>的网络。如果所需网络是本地托管的，则应使用<code class="eh lz ma mb mc b">--network localhost</code>选项。</p><h1 id="8bf3" class="lc ld ht bd le lf mm lh li lj mn ll lm iz mo ja lo jc mp jd lq jf mq jg ls lt dt translated">剧本</h1><p id="9bb6" class="pw-post-body-paragraph ji jj ht jk b jl lu iu jn jo lv ix jq jr lw jt ju jv lx jx jy jz ly kb kc kd hm dt translated">Hardhat支持<strong class="jk hu"> Javascript </strong>或<strong class="jk hu">类型脚本</strong>中的脚本。</p><p id="ac3b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">脚本可用于编写<strong class="jk hu">部署</strong>、<strong class="jk hu">测试</strong>或<strong class="jk hu">维护</strong>的代码。</p><p id="e6d5" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh lz ma mb mc b">run &lt;script.js&gt;</code>任务用于运行依赖于hardhat的脚本，而独立脚本则通过<code class="eh lz ma mb mc b">node &lt;script.js&gt;</code>运行。根据前一种方法运行的脚本可以访问Hardhat的全局范围，而不能访问的脚本必须显式声明依赖关系。</p><pre class="kf kg kh ki fq md mc me mf aw mg dt"><span id="2c8c" class="mh ld ht mc b fv mi mj l mk ml">npx hardhat run script.js</span></pre><p id="5e33" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><em class="mr">下面是一个基本的部署脚本:</em></p><figure class="kf kg kh ki fq kj"><div class="bz el l di"><div class="ms mt l"/></div></figure><h1 id="84d1" class="lc ld ht bd le lf mm lh li lj mn ll lm iz mo ja lo jc mp jd lq jf mq jg ls lt dt translated">测试</h1><p id="6eed" class="pw-post-body-paragraph ji jj ht jk b jl lu iu jn jo lv ix jq jr lw jt ju jv lx jx jy jz ly kb kc kd hm dt translated">Hardhat支持用<strong class="jk hu">Waffle</strong>&amp;<strong class="jk hu">ethers . js</strong>进行测试。</p><p id="e8b6" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">任务将执行文件路径中的所有测试。</p><pre class="kf kg kh ki fq md mc me mf aw mg dt"><span id="4852" class="mh ld ht mc b fv mi mj l mk ml">npx hardhat test</span></pre><p id="bb73" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">下面是一个基本的文本脚本:</p><figure class="kf kg kh ki fq kj"><div class="bz el l di"><div class="ms mt l"/></div></figure><h1 id="d031" class="lc ld ht bd le lf mm lh li lj mn ll lm iz mo ja lo jc mp jd lq jf mq jg ls lt dt translated">任务</h1><p id="140e" class="pw-post-body-paragraph ji jj ht jk b jl lu iu jn jo lv ix jq jr lw jt ju jv lx jx jy jz ly kb kc kd hm dt translated"><strong class="jk hu">任务</strong>是安全帽内的基本工作单元；所有的hardhat进程都是通过任务来执行的，这使得默认的和定制的例程可以很容易地执行。</p><p id="aeac" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh lz ma mb mc b">task(…)</code>功能创建任务。它既可以在其参数内定义整个任务，也可以链接函数来逐步构建其各个部分。</p><p id="c23a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">&gt;✏️ <strong class="jk hu">注意:</strong>任务应该在<code class="eh lz ma mb mc b">hardhat.config.js</code>内声明</p><p id="cf53" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">构建器模式方法从<code class="eh lz ma mb mc b">task(name, description)</code>函数开始，由<code class="eh lz ma mb mc b">addParam(name, description)</code> &amp; <code class="eh lz ma mb mc b">setAction(async (taskArgs) =&gt; {…})</code>链接。</p><p id="371c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">complete params方法使用任务函数的扩展版本:<code class="eh lz ma mb mc b">task(name, description, async function (taskArguments, hre, runSuper) {…})</code>。与前一种方法不同，在任务被命令调用之前，参数是未知的。这允许更多的灵活性，但是更容易出错。</p><p id="1bdb" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><em class="mr">下面是一个用构建器方法做的任务:</em></p><figure class="kf kg kh ki fq kj"><div class="bz el l di"><div class="ms mt l"/></div></figure><p id="d924" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh lz ma mb mc b">subtask(…)</code>功能的工作方式几乎和<code class="eh lz ma mb mc b">task(…)</code>完全一样。唯一的区别是它不记录它的帮助消息。这使得子任务成为构建复合任务的良好解决方案，而不会造成控制台输出拥挤。</p><p id="e1d1" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh lz ma mb mc b">run()</code>函数用于运行任务和子任务。</p><pre class="kf kg kh ki fq md mc me mf aw mg dt"><span id="eac2" class="mh ld ht mc b fv mi mj l mk ml">hre.run("balance", { account: "0x89Df..."});</span></pre><h1 id="8899" class="lc ld ht bd le lf mm lh li lj mn ll lm iz mo ja lo jc mp jd lq jf mq jg ls lt dt translated">安慰</h1><p id="46e0" class="pw-post-body-paragraph ji jj ht jk b jl lu iu jn jo lv ix jq jr lw jt ju jv lx jx jy jz ly kb kc kd hm dt translated">Hardhat支持<strong class="jk hu">日志</strong>内置、交互式<strong class="jk hu"> Javascript控制台</strong>。</p><p id="4e30" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">所有hardhat全局范围的成员都可以在控制台中使用。</p><p id="9913" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh lz ma mb mc b">console</code>任务将创建一个控制台实例。</p><pre class="kf kg kh ki fq md mc me mf aw mg dt"><span id="9a98" class="mh ld ht mc b fv mi mj l mk ml">npx hardhat console</span></pre><p id="9a1b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">日志记录是通过<code class="eh lz ma mb mc b">console.log()</code>函数完成的，可以从Hardhat环境中的任何地方发出:合同、脚本、测试、配置等等…</p></div><div class="ab cl kv kw hb kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hm hn ho hp hq"><h1 id="105e" class="lc ld ht bd le lf lg lh li lj lk ll lm iz ln ja lo jc lp jd lq jf lr jg ls lt dt translated">就是这样！</h1><p id="3303" class="pw-post-body-paragraph ji jj ht jk b jl lu iu jn jo lv ix jq jr lw jt ju jv lx jx jy jz ly kb kc kd hm dt translated">正如我在我的页面上所说的，这些是我个人笔记本上的笔记。如果有任何明显的错误，请随时留下评论，以便我可以修复它们。还有，如果有你想从我这里看到的内容，请告诉我！</p><h2 id="910c" class="mh ld ht bd le mu mv mw li mx my mz lm jr na nb lo jv nc nd lq jz ne nf ls ng dt translated">资源</h2><p id="217c" class="pw-post-body-paragraph ji jj ht jk b jl lu iu jn jo lv ix jq jr lw jt ju jv lx jx jy jz ly kb kc kd hm dt translated">安全帽的文档:<a class="ae ku" href="https://hardhat.org/getting-started/" rel="noopener ugc nofollow" target="_blank">https://hardhat.org/getting-started/</a></p><blockquote class="nh"><p id="a4c4" class="ni nj ht bd nk nl nm nn no np nq kd ek translated">交易新手？尝试<a class="ae ku" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或<a class="ae ku" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote></div></div>    
</body>
</html>