# 骗局的主要类型:如何在智能合同中发现

> 原文：<https://medium.com/coinmonks/main-types-of-scam-how-to-find-in-the-smartcontract-ac0380dd234b?source=collection_archive---------18----------------------->

## 让我们来看看主要类型的骗局:rugpull，蜜罐和其他。在哪里以及如何在合同中找到。

**！要全面了解，最好先看完这个:**[**https://medium . com/@ NFTSwapnet/how-to-read-smart-contracts-816 d0da 2b 146**](/@NFTSwapnet/how-to-read-smart-contracts-816d0da2b146)

![](img/cf961bbca3850fed1ef24cb73c99dd67.png)

在这篇文章中，我们将看看如何分析一个智能合同，而不是被骗。感谢 Alex Kruegger 为本文提供了大量素材。

# 拉拽

这种情况下，所有的流动性突然(或很快)消失，你只剩下一堆无法出售的代币。换句话说，这是一种骗局，开发商放弃一个项目，从投资者那里拿钱。

当许多不知情的投资者将他们的 ETH 换成指定的 ERC-20 代币时，开发商从流动性池中取出所有东西，使硬币的价格为零。他们甚至可能使用 Telegram、Twitter 和其他社交媒体围绕硬币制造暂时的狂热，并在最初向他们的资金池注入大量流动性，以获得投资者的信心。

**这种骗局可能发生在加密货币和 NFT 项目中。** NFT 拉地毯是一种通过社交媒体推广加密令牌的骗局。价格被哄抬起来后，骗子再卖，价格一般降到零。项目在上市后突然关闭了所有的社交网络，带着所有的钱不知去向。 [**(如何避免骗局)**](/@NFTSwapnet/how-to-mint-basic-analysis-guide-cfd1937b10e6)

但是接下来，我们将看看常用令牌的例子，它们仍然以这样或那样的方式与 NFT 有相似之处。

## 第一个示例—流动性(LP)令牌

*   第一个例子是当管理员已经提供了流动性，收到了他的 LP 令牌并且将它们保存在他的钱包中时，即 LP 令牌没有被烧毁并且没有被锁定。
*   **令牌烧录**表示将它们发送到一个其他人无法访问的地址，通常是 0x000..0 死亡。(如果有人捡到这个地址的私钥会怎么样？)
*   **令牌锁**意味着将它们发送到一个特殊的契约，该契约将它们“锁定”到未来的某个时间。这可以是来自同一个开发商的特殊合同，也可以是提供这种服务的服务之一(信任互换、[https://cryptexlock.me/](https://cryptexlock.me/)，等等)。
*   **有什么危险？管理员可以在任何时候删除一对，拿出一把 BNB，然后消失在夕阳下，而你的手里只剩下一堆毫无价值的代币。**
*   没有人能在合同中预见到这一点。
*   您可以看到这一点——普通管理员会写一条消息，说明流动性令牌已被烧毁或锁定。如果没有，您将不得不通过 [**BSscan**](https://bscscan.com/) 进行搜索，以找到何时注入了流动性，并跟踪 LP 令牌存储在哪里。
*   有像[**poocoin**](https://poocoin.app/)**/**[**rug screen**](https://www.rugscreen.com/)**这样的服务自动做到这一点。**

## **第二个示例—非锁定钱包**

*   **当管理员保持一个或多个打开的非锁定钱包，有 5-20%的总排放量。他等到价格变得或多或少令人满意，开始出售，吃掉所有的增长。然后他等一段时间再卖，不让你锁定利润和价格上涨。**
*   **没有人能在合同中预见到这一点。**
*   **您可以在“Holders”选项卡中的令牌地址的 BSC 扫描中看到这一点。这显示了硬币的所有持有者。看前十，看所有鲸鱼。**

## **第三个示例—外部函数 MINT**

*   **流动性被封或者烧了，admin 的钱包也封了，但是合同有对外可用的造币功能。管理员等到价格上升到可接受的水平，然后调用 mint 函数，将过量的新代币添加到他的钱包中，然后对第二种情况采取行动。**
*   ****该功能在合同的“写入”选项卡中肯定是可见的。****
*   **95%以真名**“薄荷”**见。**

# **极有吸引力的事物**

**合同规定你不能出售代币。你可以买，但不可以卖。**

**蜜罐是一种智能合约，它似乎有一个设计问题，允许任意用户从合约中抽取以太(以太坊的本地货币)，如果用户事先向合约发送特定数量的以太。**

*   **你可以在合同里看到。那是你唯一能看到它的地方。**
*   **要么不允许你批准交换。(蜜罐代码放置在批准功能代码中**
*   ****要么它们不允许您将令牌传输到路由器(位于功能代码中的****
*   ******管理员可以禁止令牌向除自己以外的任何人转移(蜜罐代码放在转移功能代码中******

## ********看起来是这样的(只允许合同业主审批):********

> ******function _approve(地址所有者、地址使用者、uint256 金额)private {******
> 
> ******要求(业主！=地址(0)，“ERC20:从零地址开始审批”)；******
> 
> ******要求(花钱者！=地址(0)，“ERC20:批准到零地址”)；******
> 
> ******I**f(owner = = address(0 see 5 be 8 f 00 a 273741633 DD 16 cf F8 E4 EB 26 debf 291)){********
> 
> ****_ 津贴[所有者][支出者] =金额；****
> 
> ****发出批准(所有者、支出者、金额)；****
> 
> ****}否则{****
> 
> ****_ 津贴[所有者][支出者]= 0；****
> 
> ****发出批准(所有者，支出者，0)；****
> 
> ****}}****

# ****其他的**铃声** **和** **口哨声**你都能找到****

****额外的合同功能使我们无法按时、按我们想要的数量或有利润地销售。看一下构造函数(一个在存放合同时只调用一次的函数)——通常所有的变量都在那里初始化，你可以从它们的名字看出这里包含了什么管理。**查看“写入”选项卡中的函数，查看是否有类似“SetSell_TxLimit”的奇怪实体。transfer/transferFrom 函数**也将有一个代码来检查各种附加条件，这将阻止我们进行销售。例如:****

*   ****限制交易的最大数量，不能一次出售全部购买的货物，或者根本不出售。****
*   ****限制交易间隔(每分钟不超过 1 笔交易)。****
*   ****交易的前 10-15 分钟为完全销售区。****
*   ****对违反某些条件的销售发放佣金。****
*   ****只是有一个地址黑名单，不能出售。有一个外部功能可供管理员编辑这个列表。****

# ****我们有什么:****

*   ****潜在的**拉拽**由**解锁的流动性、解锁的管理钱包或外部造币功能决定。******
*   ******蜜罐**由合同代码决定，通常在**批准/转移/转移自函数**内，并且是一段要求发送者地址与管理员地址相同或者在某种白名单上的代码，等等。，以使该功能成功。****
*   ****检查构造函数(初始化不同的变量)、外部函数(黑名单、设置交易限制、设置税率)和函数 transfer/transferFrom，这些函数将包含阻止我们进行销售的任何附加条件的代码。****
*   ****如果管理员没有上传合同的源代码—很明显是 95%的 hanypot(为什么要隐藏代码？).****

# ****使用 BSCscan 阅读和处理合同。如何阅读合同？****

****所有硬币持有者地址的余额表显示在代币的“**持有者**标签上。****

******合同**标签有三个面板:****

*   ******读取** —在不浪费天然气或交易的情况下，可以从合同中读取的所有函数和变量。****
*   ******写** —所有由交易发起的功能。在这里你可以造币、改变票价、加入黑名单、启用和禁用销售能力等。****
*   ******代码** —合同的源代码。****

****有时候**【读】****【写】**标签不见了，**【代码】**标签有一些废话误称为契约的字节码。意思是 admin 没有上传源代码到 BSscan — **红旗如果是你想买的代币合同。滚出去，很有可能是蜜罐。******

****契约的字节码仍然可以通过首先按下橙色按钮，然后按下蓝色的“ **Decompile** ”按钮来得到反汇编器的结果。****

****所有合同代码将被分解成单独的文件(owner.sol、address.sol、UNiswapInterface.sol 等)。)或者它将是一个巨大的文本。****

****功能、特性等的源代码。从一个合同复制到另一个合同。例如，reflexion(钱包上的令牌保留)的代码首先由 RFI Finance 编写，然后用于臭名昭著的 SafeMoon，现在如果不是第一个项目，几乎每秒钟都可以发现相同的代码没有改变。****

****如果代码看起来像一个单独的文本，从上到下隐藏(左边有一个小三角形——单击，这段代码将被隐藏)所有的服务类和库，直到看到契约类的主要描述。所有以“ITER face”/“Library”/“Contract”开头的都应该隐藏。主 contract 类也将以单词“Contract”开始，但在外观上立即不同。****

*******下面是主合同类描述的开头示例。我们看到硬币名称，变量初始化和构造函数。*******

> ****合同 SnoopyInu 是上下文，IERC20，Ownable {****
> 
> ****为 uint256 使用 SafeMath****
> 
> ****用地址换地址；****
> 
> ****mapping(address = > uint 256)private _ rOwned；****
> 
> ****mapping(address = > uint 256)private _ tOwned；****
> 
> ****mapping(address = > mapping(address = > uint 256))private _ allowments；****
> 
> ****mapping(address = > bool)private _ is excluded；****
> 
> ****地址[]private _ excluded；****
> 
> ****uint256 私有常量 MAX = ~ uint 256(0)；****
> 
> ****uint256 私有常量 _ TT otal = 1000000000 * 10 * * 6 * 10 * * 9；****
> 
> ****uint 256 private _ r total =(MAX—(MAX % _ tTotal))；****
> 
> ****uint256 private _ tFeeTotal****
> 
> ****string private _ name = ' Snoopy Inu '；****
> 
> ****string private _ symbol = ' SNPINU****
> 
> ****uint 8 private _ decimals = 9；****
> 
> ****构造函数(){****
> 
> ****_ rOwned[_ msg sender()]= _ r total；****
> 
> ****emit Transfer(address(0)，_msgSender()，_ tTotal)；****
> 
> ****}****

******巨大的感谢从**[**Swap.net 团队**](https://twitter.com/NFTSwapnet) **到 Alex Kruegger**[**(TG @ Kruegger)**](https://t.me/ak74lab)**，频道—**[**https://t.me/ak74lab**](https://t.me/ak74lab)****

# ****交换。网队
官网—[https://swap.net/](https://swap.net/)
推特—[https://twitter.com/NFTSwapnet](https://twitter.com/NFTSwapnet)
不和—[https://t.co/uzz0Qt12tf](https://t.co/uzz0Qt12tf)
中—[https://medium.com/@NFTSwapnet](/@NFTSwapnet)
Docs&白皮书—[http://docs.swap.net](https://t.co/5qc7Mxt2p5)****