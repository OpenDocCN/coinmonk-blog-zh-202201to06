<html>
<head>
<title>How do Bitcoin nodes validate transactions in blockchain?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">比特币节点如何在区块链验证交易？</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-do-bitcoin-nodes-validate-transactions-in-blockchain-7ec0603a0140?source=collection_archive---------11-----------------------#2022-06-03">https://medium.com/coinmonks/how-do-bitcoin-nodes-validate-transactions-in-blockchain-7ec0603a0140?source=collection_archive---------11-----------------------#2022-06-03</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/367b3abe463c74132400c7fd12f5b041.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qpy2oEfcjGpenmlECPU_xw.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">blockchain</figcaption></figure><p id="8aed" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">区块链是比特币等加密货币中发生的所有交易的列表。有许多不同的方式来验证每一个交易，并且它们根据具体的关注点而不同(即，共识与存储或吞吐量)。我将在这里介绍一些最常见的验证方法，并解释每种方法在区块链中的作用。</p><p id="488b" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">比特币通过“工作证明”来处理验证，这意味着每个区块/交易都必须通过解决一个密码难题来验证，然后才能添加到区块链，并确认在其区块内有效，从而提高安全性，抵御外部攻击，如双重支出或挖掘企图。</p><p id="2ff7" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">前一个区块的SHA-256杂凑会被杂凑以产生32个字元的「杂凑」名称，用来寻找目前谜题的「答案」。如果答案在一定数量的字符内匹配，那么它被认为是正确的。通过这种方式，矿工们被激励去解决这个问题。</p><p id="8466" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">此外，为了使挖掘者能够在不进行挖掘的情况下验证事务，每个新块必须在其散列中包含几个先前挖掘的块，以证明它来自另一个(有效的)块，而不是来自攻击者。任何挖掘者都可以以任何顺序添加所有有效的先前块，包括通过多次重复最后一个块(重新索引)。</p><h1 id="5707" class="kd ke ht bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">1.共识问题</h1><p id="9860" class="pw-post-body-paragraph jf jg ht jh b ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy lf ka kb kc hm dt translated">当一个挖掘者/验证者找到正确答案时，他们可以将它发送给所有其他挖掘者，然后他们将验证它。如果有足够多的矿工验证了相同的答案，则该答案将被添加到区块链中，并被确认为合法。如果大部分矿工不同意相同的答案，则创建一个替代的有效路径(分叉)，直到大多数矿工同意一个特定的路径(共识)。</p><p id="c254" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">分叉可能有多种原因:1)一个坏演员可能试图通过秘密建造另一个更长的区块链来攻击。2)对于多个矿工试图同时解决的问题，可以找到替代解决方案。3)一些矿工可能不喜欢和其他人一样验证相同的答案，因此他们可以“脱离链条”,单独验证不同的(非共识)解决方案。</p><p id="d221" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">不利的一面是，在达成共识之前，每个块/交易链可能会有无限多的分叉，这意味着将所有分叉都达到共识状态需要无限长的时间。长时间的等待对生意不利，而且可能无利可图。由于这个原因，战俘区通常有一个最大的大小限制，矿工需要快速的展示他们以获得最高的奖励。</p><p id="2247" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">为了检查一致性，矿工使用“工作证明”算法来猜测下一个块的散列。猜得越多，矿工就越擅长采矿，因此他们的奖励也就越高。</p><p id="fb1d" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">哈希值通常有32个字符长，这意味着如果您对超过40亿种可能性进行哈希运算，您可以预期大约有2种是正确的(排除每个可能值中出现重复的可能性)。哈希冲突极其罕见。这意味着，即使超过20%的散列是错误的，你也可以预期只有400亿分之一的不正确证明。如果大多数矿工是正确的，那么叉子一定会死去并被遗忘。</p><h1 id="3a9b" class="kd ke ht bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">2.两个区块链问题</h1><p id="bab4" class="pw-post-body-paragraph jf jg ht jh b ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy lf ka kb kc hm dt translated">一个区块链也可以有多个链(叉)，这可能发生在几个原因:1)一个坏演员可能试图通过建立另一个更长的区块链来攻击，只有他/她的作品。2)为多个矿工试图同时解决的问题找到了更好的解决方案。3)一些矿工可能不喜欢和其他人一样验证相同的答案，因此他们可以“脱离链条”,单独验证不同的(非共识)解决方案。</p><p id="8ad5" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">分叉可能有多种原因:1)一个坏演员可能试图通过秘密建造另一个更长的区块链来攻击。2)对于多个矿工试图同时解决的问题，可以找到替代解决方案。3)一些矿工可能不喜欢和其他人一样验证相同的答案，因此他们可以“脱离链条”,单独验证不同的(非共识)解决方案。</p><p id="067a" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">不利的一面是，在达成共识之前，每条链可能会有无限多的分叉，这意味着将所有分叉都达到共识状态需要无限长的时间。长时间的等待对生意不利，而且可能无利可图。出于这个原因，战俘链通常有一个最大尺寸限制，矿工需要快速提交他们以获得最高奖励。</p><p id="1ada" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">为了检查一致性，矿工使用“工作证明”算法来猜测下一个块的散列。猜得越多，矿工就越擅长采矿，因此他们的奖励也就越高。</p><p id="c32e" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">哈希值通常有32个字符长，这意味着如果您对超过40亿种可能性进行哈希运算，您可以预期大约有2种是正确的(排除每个可能值中出现重复的可能性)。哈希冲突极其罕见。这意味着，即使超过20%的散列是错误的，你也可以预期只有400亿分之一的不正确证明。如果大多数矿工都是正确的，那么这个链条必定会消亡，并被遗忘。</p><h1 id="29f7" class="kd ke ht bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">3.没有POW算法的正确共识</h1><p id="f4a7" class="pw-post-body-paragraph jf jg ht jh b ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy lf ka kb kc hm dt translated">许多加密货币现在已经实现了“赌注证明”算法，这是一种挖掘形式，其中不是为了PoW奖励而挖掘，而是作为共识过程的一部分，验证者仅仅被允许下注他们的硬币(即，存储它们)而获得奖励。矿工仍然做所有的工作，但没有因此得到报酬。相反，利益相关者会因为将区块链验证为验证者(挖掘者)而获得奖励，而不仅仅是因为他们的区块。</p><p id="4c9a" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">不是对前一个区块进行散列，然后猜测下一个区块的散列，而是简单地“下注”或将您的硬币放入他人持有的池中。这允许你将一些硬币单独留在你的电脑上，而“下注”其他的(例如，如果你下注所有硬币的1%，那么在另一个用户的池中下注的100个硬币中，1个将被选择作为下一个区块链的新硬币库)。</p><p id="5a0b" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">有了这个算法，你不会因为犯了错而受到惩罚(就像你在PoW中那样)。相反，你会得到区块链共识的奖励。如果你的赌注不够大，不足以产生一个足够高的散列来猜测下一个块的散列，那么你就输了。这意味着，即使20%的赌注硬币是错误的，并因此使大多数大宗交易和交易无效，矿工在一个共识不佳的链条上采矿仍然有利可图。</p><h1 id="0233" class="kd ke ht bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">4.无需幂算法快速检查一致性</h1><p id="d2ff" class="pw-post-body-paragraph jf jg ht jh b ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy lf ka kb kc hm dt translated">在以前检查一致性的方法中(通过哈希猜测)，检查一致性需要非常长的时间。在一个有20-20，000个验证器的区块链中获得所有的分支很容易花费几个小时、几天或者更长的时间。这是因为如果一个链上有20–20，000个不同的验证器，并且它们都在互相检查，那么它们必须互相挖掘才能首先挖掘出它们的链。</p><p id="7a4f" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">有了这种新方法，我们可以使检查过程更快，并允许它发生在链外，在那里你不需要100%的所有验证器在链上挖掘。相反，您可以对照其他链来检查一个链的有效性，并且只显示具有最大散列能力的链。</p><p id="3d5d" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">这意味着矿商不需要成为共识的验证者，而是可以将此外包给银行或交易所等实体，这些实体受到激励公开其验证者状态(因此可以承受较低的散列率)。此外，这些验证器不会像POW算法那样因为出错而受到惩罚。相反，他们得到的回报是，他们的赌注被用来验证共识。</p><p id="126a" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">为了检查一致性，矿工使用“工作证明”算法来猜测下一个块的散列。猜得越多，矿工就越擅长采矿，因此他们的奖励也就越高。</p><p id="e004" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">工作验证算法用于在区块链系统中确认交易和创建新块。从有偿或无偿工作的意义上来说，它与工作无关。术语“工作证明”是指完成一项需要努力的任务的结果，如比特币的Hashcash谜题。</p><p id="6865" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">要在区块链(共享账本)中增加一笔交易，矿工们必须使用大量的计算能力来解决复杂的数学问题。</p><p id="81fa" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">第一个解决这个问题的矿工，创建一个所谓的“工作证明”，以字节为单位获得奖励(也包含tx数据)。这个奖励等于这个新块的字节大小。这一块的交易费给矿工，去矿工的钱包。</p><p id="af9a" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">不过，最重要的是，这个新块中的所有事务都必须满足一定的规则:事务的发生时间不能早于Merkle根包含在有效工作证明中的时间。包含在具有有效工作证明的块中意味着事务已经被确认(检查)，这意味着它现在是不可变区块链的一部分(检查)。</p><p id="08b5" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">如果你接受新的交易，你需要检查他们包括足够大的费用。这是防止矿工仅仅为了获得一些空闲字节而通过垃圾事务向链发送垃圾消息的唯一方法(垃圾事务没有任何作用，因为它们的输出还没有被确认，因此没有人能够花费它们)。</p><p id="15b6" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">在PoW算法中，你会因为错误而受到惩罚(就像你在POW中一样)。相反，你会得到区块链共识的奖励。如果您的块的哈希不够高，不足以猜测下一个块的哈希，这是唯一的失败方式。这意味着，即使所有矿工中有20%是错误的，因此大多数区块和交易无效，矿工在共识不佳的情况下开采仍然有利可图。</p><h1 id="0ae8" class="kd ke ht bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">5.轻型客户端和轻型节点</h1><p id="7d51" class="pw-post-body-paragraph jf jg ht jh b ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy lf ka kb kc hm dt translated">轻型客户端通过使用“修剪过的”区块链伪造完整节点，或者运行完整节点客户端，但只跟踪区块链的某些部分。轻客户端需要跟踪的最重要的事情是它的余额、流通中的硬币总数以及哪些块是有效的。其他的都可以忽略，因为它不影响这个特定的轻型客户端的安全性或功能。</p><p id="0450" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">此外，轻客户端可以听取正在进行的共识过程。因此，如果在链中发生分叉(例如，因为事务没有被完全确认，或者因为冲突的事务包含在同一个块中)，轻客户端将能够看到哪个区块链是有效的，哪个是正确的。</p><p id="bdd0" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">轻型客户端也用于不可信的节点，例如那些运行在智能手机上的节点。这允许移动设备使用dapps，而不必从完整节点的存储中下载所有的区块链(例如，您的手机没有运行完整节点，您需要它来运行dapps，所以您从在线商店下载一些轻型客户端)。</p><p id="8852" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">全节点有时也称为“轻节点”。</p><h1 id="6dcf" class="kd ke ht bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">6.dApps中作为轻客户端的智能合约</h1><p id="dae0" class="pw-post-body-paragraph jf jg ht jh b ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy lf ka kb kc hm dt translated">如果你的dApp是基于智能合约的，那么你需要确保你不必信任任何与你的私钥和货币有关的东西。智能合约存储在区块链，由矿商以区块为单位进行部署，因此智能合约可以像其他区块链交易一样对待。这意味着您不必信任任何运行承载您的dApp的完整节点或轻型节点的人。对于中央银行控制的dApp(如以太坊)，你必须信任整个网络/基础设施/浏览器软件等。</p><p id="cc1d" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">例如，如果您想与朋友打赌区块链的下一个街区将在5秒内发生，您可以创建一个智能打赌合同。这种自主且不可信的智能合约由矿工部署，它将在五秒钟后自动执行。</p><p id="624b" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">使你能够与你的朋友(甚至陌生人)打赌的dApp只是轻客户端，而不是这个自主智能合约的一部分。为了部署这种博彩智能合约，您需要登录到dApp节点(例如，使用您的私钥)，然后发送一定数量的本地加密货币令牌来支付交易费用(gas)。这意味着您信任dApp拥有您的私钥和一些加密货币。不过，dApp本身并不是智能赌博合同的一部分。</p><p id="297a" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">换句话说，dApp将负责创建您想要部署的智能契约，并发送您的私钥。然后，区块链上的挖掘流程将确认该事务(通过共识)，然后在块中部署您的智能合约(从而使其成为不可变区块链的一部分)。注意:这是一个过于简单的解释。</p><p id="7390" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">为了使事情更加值得信任，您可以运行您的完整节点，或者建立一个由多个对等方组成的私有联盟链，所有对等方都执行每一条规则来保护他们诚实的声誉。</p><blockquote class="lg"><p id="1868" class="lh li ht bd lj lk ll lm ln lo lp kc ek translated">加入Coinmonks <a class="ae lq" href="https://t.me/joinchat/Trz8jaxd6xEsBI4p" rel="noopener ugc nofollow" target="_blank"> Telegram group </a>并了解加密交易和投资</p></blockquote></div></div>    
</body>
</html>