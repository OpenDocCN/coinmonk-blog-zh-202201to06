<html>
<head>
<title>Ethereum World State Simplified</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太坊世界状态简化版</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/ethereum-world-state-simplified-891219c406ae?source=collection_archive---------4-----------------------#2022-06-26">https://medium.com/coinmonks/ethereum-world-state-simplified-891219c406ae?source=collection_archive---------4-----------------------#2022-06-26</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/a49099ae58702f66417597cf47c7862a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QqG6Hu4oimR-3M3OP000Rg.png"/></div></div></figure><p id="91a7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">以太坊是一台世界计算机，这意味着它可以被任何地方的任何人访问，他们都可以看到相同的信息。它有一个单一的全局状态，保存有关帐户余额和智能合约数据的信息。</p><p id="a62c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">它不是一台物理计算机，而是一台由所有参与节点组成的虚拟计算机。在撰写本文时，网络中有<a class="ae jz" href="https://etherscan.io/nodetracker" rel="noopener ugc nofollow" target="_blank"> ~2000个节点</a>。完整状态在这些节点中的每一个中维护，并且在执行事务时由<strong class="jd hu">E</strong>thereum<strong class="jd hu">V</strong>I virtual<strong class="jd hu">M</strong>achine(EVM)不断更新。没有关闭以太坊的选项，除非没有参与节点，这是极不可能的。</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ka"><img src="../Images/ff615eec2ed2413ff7cb217355af0b55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LsJCNQr5d7mcau6UyuDQWg.png"/></div></div></figure><h2 id="5a9d" class="kf kg ht bd kh ki kj kk kl km kn ko kp jm kq kr ks jq kt ku kv ju kw kx ky kz dt translated"><strong class="ak">这一切是如何开始的，以太坊状态持有什么？</strong></h2><p id="3f69" class="pw-post-body-paragraph jb jc ht jd b je la jg jh ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy hm dt translated">以太坊网络于2015年上线。当创建起源块(即区块链的起始块)时，用分配给特定账户的ETH余额初始化状态。这些账号属于参与<a class="ae jz" href="https://www.coindesk.com/markets/2020/07/11/sale-of-the-century-the-inside-story-of-ethereums-2014-premine/" rel="noopener ugc nofollow" target="_blank">以太坊预售</a>的用户。</p><h2 id="06a4" class="kf kg ht bd kh ki kj kk kl km kn ko kp jm kq kr ks jq kt ku kv ju kw kx ky kz dt translated"><strong class="ak">起源块(块0)的状态</strong></h2><p id="9bba" class="pw-post-body-paragraph jb jc ht jd b je la jg jh ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy hm dt translated">想象一下，在预售期间，只有两个帐户注册接收特定的ETH。当以太坊上线时，发送以太网到这些账户的交易被分组以创建创世纪块。块只不过是一组事务。创建块时，状态将初始化如下:</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lf"><img src="../Images/8563f696378462f78309d9f6963f5a44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K4BAUt1dvIQHCX9p2zz7MQ.png"/></div></div></figure><p id="dc06" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">从那时起，每一个添加到区块链的区块都会改变全局状态。</p><h2 id="efb2" class="kf kg ht bd kh ki kj kk kl km kn ko kp jm kq kr ks jq kt ku kv ju kw kx ky kz dt translated"><strong class="ak">程序块1的状态</strong></h2><p id="6cac" class="pw-post-body-paragraph jb jc ht jd b je la jg jh ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy hm dt translated">假设帐户所有者(从0xf42开始…)向另一个帐户(0x756…)转移10个ETH，该交易将被所有节点接收和验证，但不会立即添加到区块链。相反，它会被添加到下一个块中，并以一定的间隔(~ 12–14秒)更新到区块链。</p><p id="5303" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">当第一个块被添加到区块链时，上面的事务被包括在其中，并且当前状态将被更新如下:</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lg"><img src="../Images/ad218d4db248a9f8e4d2de5e2bf63642.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*02cmjMs9ncDqkp0L-WrrAg.png"/></div></div></figure><p id="7455" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">等等什么？为什么5 ETH有新账户？</p><h2 id="6946" class="kf kg ht bd kh ki kj kk kl km kn ko kp jm kq kr ks jq kt ku kv ju kw kx ky kz dt translated"><strong class="ak">挖掘奖励</strong></h2><p id="6f79" class="pw-post-body-paragraph jb jc ht jd b je la jg jh ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy hm dt translated">需要有一种激励措施，让矿工花费计算精力来参与网络并保护区块链。区块链中每增加一个方块，矿工就会得到5 ETH作为奖励。奖励值随着时间的推移而变化，现在，矿工得到2 ETH作为奖励。除了奖励之外，矿工还会收到汽油费，这将在一个单独的博客中介绍。</p><h2 id="3c74" class="kf kg ht bd kh ki kj kk kl km kn ko kp jm kq kr ks jq kt ku kv ju kw kx ky kz dt translated"><strong class="ak">智能合约</strong></h2><p id="9b27" class="pw-post-body-paragraph jb jc ht jd b je la jg jh ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy hm dt translated">以太坊是不是都是在账号之间转移ETH？不完全是。除了以太网转账，以太坊还支持智能合同执行。类似于每个帐户都有一个ETH余额的方式，每个智能合约帐户都有一个ETH余额以及由其代码定义的数据。</p><p id="9582" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们来看一个简单的智能合同，它存储一条消息，而引用这条消息的人。<em class="lh">构造函数</em>将在部署智能合约时执行，负责设置<em class="lh">名称</em>和<em class="lh">消息</em>的初始值。请注意，对这些字段的任何更新都必须通过调用<em class="lh"> update </em>函数来进行。</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff li"><img src="../Images/eb4d073156f2b2f6ec85933583af985e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9W9fCb1VvswgSvjw2tirdg.png"/></div></div></figure><h2 id="b061" class="kf kg ht bd kh ki kj kk kl km kn ko kp jm kq kr ks jq kt ku kv ju kw kx ky kz dt translated"><strong class="ak">程序块2的状态</strong></h2><p id="9d74" class="pw-post-body-paragraph jb jc ht jd b je la jg jh ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy hm dt translated">为了将上述契约部署到以太网，契约所有者必须调用一个事务并为数据字段提供初始值(即<em class="lh">名称</em>和<em class="lh">消息</em>)。一旦EVM执行交易，就为合同创建一个新帐户(0x7d65…)，并且用合同所有者提供的值初始化存储。假设这是下一个块中的唯一事务，则状态如下</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lg"><img src="../Images/983fe7683a1e190a55f1917ed37ea033.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6toYbHVuJ419eLbRXlgvoQ.png"/></div></div></figure><p id="609a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">有一个额外的帐户(0x0019…)被添加到状态中，现在你应该已经猜到这是对开采第二个区块的矿工的奖励。</p><h2 id="f765" class="kf kg ht bd kh ki kj kk kl km kn ko kp jm kq kr ks jq kt ku kv ju kw kx ky kz dt translated"><strong class="ak">第3块的状态</strong></h2><p id="3536" class="pw-post-body-paragraph jb jc ht jd b je la jg jh ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy hm dt translated">假设另一个用户想要更新智能合约消息，他们可以通过启动一个新事务并为<em class="lh">名称</em>和<em class="lh">消息</em>传递新值来实现。当交易包含在区块链中时，它将相应地更新合同账户数据。</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff li"><img src="../Images/416f4dc0b8ae15b90fa996b87f018371.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MlmNcWxfKYaheMU9_STRKQ.png"/></div></div></figure><h2 id="1a31" class="kf kg ht bd kh ki kj kk kl km kn ko kp jm kq kr ks jq kt ku kv ju kw kx ky kz dt translated">之前的消息“Hello world”怎么了？</h2><p id="ffbd" class="pw-post-body-paragraph jb jc ht jd b je la jg jh ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy hm dt translated">如果您查看智能合约代码，就会发现它被设计为只存储最新的值。因此，先前的<em class="lh">名称</em>和<em class="lh">消息</em>被新值覆盖。但是，可以通过将历史数据作为数组存储在智能合约数据中，或者发出可以在以太坊之外跟踪的事件来访问历史数据。</p><p id="c6d7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">例如，如果财产所有权存储在区块链，则可以通过查询智能合同事件来查看财产的前所有者。</p><h2 id="a469" class="kf kg ht bd kh ki kj kk kl km kn ko kp jm kq kr ks jq kt ku kv ju kw kx ky kz dt translated">帐户类型</h2><p id="e9a6" class="pw-post-body-paragraph jb jc ht jd b je la jg jh ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy hm dt translated">正如您现在已经观察到的，有两种类型的帐户</p><ul class=""><li id="8f1c" class="lj lk ht jd b je jf ji jj jm ll jq lm ju ln jy lo lp lq lr dt translated">合约帐户:这些帐户是在部署智能合约时创建的。它们有相关的代码和数据。任何人都可以通过调用事务来更改这些合同帐户的状态。</li><li id="a05f" class="lj lk ht jd b je ls ji lt jm lu jq lv ju lw jy lo lp lq lr dt translated">用户帐户(称为外部拥有的帐户或EOA)。这些账户是在以太坊之外创建的(通常使用metamask等钱包)。他们有ETH天平，但没有与之相关的代码或存储。EOA帐户可以进行转账、部署智能合约和调用合约方法。</li></ul><h2 id="d671" class="kf kg ht bd kh ki kj kk kl km kn ko kp jm kq kr ks jq kt ku kv ju kw kx ky kz dt translated">区块链中存储了哪些不同类型的数据？</h2><p id="3cb7" class="pw-post-body-paragraph jb jc ht jd b je la jg jh ji lb jk jl jm lc jo jp jq ld js jt ju le jw jx jy hm dt translated">上面的智能契约很幼稚，只存储名称和消息。然而，以太坊区块链在其状态中持有由智能合约规定的各种数据，例如账户余额、令牌所有权、NFT所有权、流动性池等等。</p><p id="8e2d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">到目前为止，以太坊网络中已经处理了～1B交易，并部署了数百万份智能合约。我会让你想象一下网络的现状有多广阔。</p><p id="9ceb" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">以上是世界状态的简化表示。状态存储在trie结构中。除了平衡和存储，它还持有nonce和代码哈希。让我们在另一篇文章中探索技术细节(如下所示)。</p><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lx"><img src="../Images/9c4596aeee3de3cd04b6f2bd076aa812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tf_pcWZBu_MnU8o7eXzDQQ.png"/></div></div></figure><blockquote class="ly lz ma"><p id="0190" class="jb jc lh jd b je jf jg jh ji jj jk jl mb jn jo jp mc jr js jt md jv jw jx jy hm dt translated">请随时让我知道评论中的任何问题。如果你喜欢这个内容，请关注更多的web3内容。</p></blockquote><blockquote class="me"><p id="eaa4" class="mf mg ht bd mh mi mj mk ml mm mn jy ek translated">加入Coinmonks <a class="ae jz" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jz" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="7d51" class="mo kg ht bd kh mp mq mr kl ms mt mu kp mv mw mx ks my mz na kv nb nc nd ky ne dt translated">另外，阅读</h1><ul class=""><li id="fbc3" class="lj lk ht jd b je la ji lb jm nf jq ng ju nh jy lo lp lq lr dt translated"><a class="ae jz" href="https://coincodecap.com/ftx-futures-trading" rel="noopener ugc nofollow" target="_blank">如何在FTX交易所交易期货</a> | <a class="ae jz" href="https://coincodecap.com/okex-vs-binance" rel="noopener ugc nofollow" target="_blank"> OKEx vs币安</a></li><li id="2615" class="lj lk ht jd b je ls ji lt jm lu jq lv ju lw jy lo lp lq lr dt translated"><a class="ae jz" href="https://coincodecap.com/coinloan-review" rel="noopener ugc nofollow" target="_blank"> CoinLoan评论</a> | <a class="ae jz" rel="noopener" href="/coinmonks/youhodler-4-easy-ways-to-make-money-98969b9689f2"> YouHodler评论</a> | <a class="ae jz" href="https://coincodecap.com/blockfi-review" rel="noopener ugc nofollow" target="_blank"> BlockFi评论</a></li><li id="a689" class="lj lk ht jd b je ls ji lt jm lu jq lv ju lw jy lo lp lq lr dt translated"><a class="ae jz" href="https://coincodecap.com/profittradingapp-for-binance" rel="noopener ugc nofollow" target="_blank">XT.COM评论</a>币安评论 | <a class="ae jz" href="https://coincodecap.com/xt-com-review" rel="noopener ugc nofollow" target="_blank"/></li><li id="41e4" class="lj lk ht jd b je ls ji lt jm lu jq lv ju lw jy lo lp lq lr dt translated"><a class="ae jz" href="https://coincodecap.com/smithbot-review" rel="noopener ugc nofollow" target="_blank"> SmithBot评论</a> | <a class="ae jz" href="https://coincodecap.com/free-open-source-trading-bots" rel="noopener ugc nofollow" target="_blank"> 4款最佳免费开源交易机器人</a></li><li id="5372" class="lj lk ht jd b je ls ji lt jm lu jq lv ju lw jy lo lp lq lr dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/coinbase-bots-ac6359e897f3">比特币基地僵尸程序</a> | <a class="ae jz" rel="noopener" href="/coinmonks/ascendex-review-53e829cf75fa"> AscendEX审查</a> | <a class="ae jz" rel="noopener" href="/coinmonks/okex-trading-bots-234920f61e60"> OKEx交易僵尸程序</a></li><li id="24e9" class="lj lk ht jd b je ls ji lt jm lu jq lv ju lw jy lo lp lq lr dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/buy-bitcoin-in-india-feb50ddfef94">如何在印度购买比特币？</a> | <a class="ae jz" rel="noopener" href="/coinmonks/wazirx-review-5c811b074f5b">瓦济克斯评论</a></li></ul></div></div>    
</body>
</html>