<html>
<head>
<title>Advanced work with Smart Contracts. “Solidity” basics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">智能合同的高级工作。“坚实”基础</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/advanced-work-with-smart-contracts-solidity-basics-59e97766d263?source=collection_archive---------11-----------------------#2022-03-13">https://medium.com/coinmonks/advanced-work-with-smart-contracts-solidity-basics-59e97766d263?source=collection_archive---------11-----------------------#2022-03-13</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="4bf2" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">本教程主要是为那些想学习如何理解密码世界，但对协议、区块链的内部机制等没有深入了解的爱好者编写的。</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ji"><img src="../Images/a674140c7486944547254666bc8130f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jgjb-0BIjj5xdiPz-IBb_w.png"/></div></div></figure><p id="ae06" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">它不是编程指南，也不是<strong class="jw hu">【Solidity】</strong>特别是，还有其他更高级、可读性更强的指南和资源。</p><p id="3217" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">本文中的许多术语已被缩短，以便在不涉及过多技术细节的情况下更容易阅读。强烈推荐上一门编程基础课，让变量，函数，参数等。不要吓到你。</p><p id="2399" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu">！要全面了解，最好先看完这个:</strong><a class="ae kq" rel="noopener" href="/@NFTSwapnet/how-to-read-smart-contracts-816d0da2b146"><strong class="jw hu">https://medium . com/@ NFTSwapnet/how-to-read-smart-contracts-816 d0da 2b 146</strong></a><strong class="jw hu">。</strong>下面写的都是链接处文章的延续。</p><p id="ee86" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu">本素材由Alex Kruegger(Telegram:@ Kruegger)创作，</strong> <a class="ae kq" href="https://t.me/ak74lab" rel="noopener ugc nofollow" target="_blank"> <strong class="jw hu"> AK74-Lab电报频道</strong> </a> <strong class="jw hu">。</strong> <a class="ae kq" href="https://swap.net/" rel="noopener ugc nofollow" target="_blank"> <strong class="jw hu">译自swap.net项目组</strong> </a> <strong class="jw hu">。</strong></p><h1 id="f4ad" class="kr ks ht bd kt ku kv kw kx ky kz la lb iz lc ja ld jc le jd lf jf lg jg lh li dt translated">回忆智能合同</h1><h2 id="d6f4" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">基本概念</h2><p id="bc16" class="pw-post-body-paragraph ju jv ht jw b jx lx iu jz ka ly ix kc kd lz kf kg kh ma kj kk kl mb kn ko kp hm dt translated">智能合约是在区块链节点上执行的代码，执行的结果(如果指定的话)存储在特殊存储库中的区块链中。让我们把存储在区块链中的数据称为持久性数据。</p><p id="d773" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">智能合同代码一旦上传到区块链，就会被额外修复，以防止任何意外或有意的更改。</p><p id="2431" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">智能合约功能可以从外部(从用户的钱包或从另一个合约)调用，并分为<strong class="jw hu">两大组:</strong></p><ul class=""><li id="4d20" class="mc md ht jw b jx jy ka kb kd me kh mf kl mg kp mh mi mj mk dt translated"><strong class="jw hu">不改变永久数据的状态(从区块链只读)</strong></li><li id="a027" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated"><strong class="jw hu">改变永久数据的状态</strong></li></ul><p id="219c" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">调用第一组的<strong class="jw hu">的函数既不耗费汽油也不耗费金钱，而且不会超出我们所关联的最近节点<strong class="jw hu">(余额、总供给、余量)</strong>。<strong class="jw hu"> </strong>在BSC扫描中这些功能都列在<strong class="jw hu">【读取】</strong>选项卡中。</strong></p><p id="c8f0" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">调用<strong class="jw hu">第二组</strong>函数成为一个完整的事务，该事务被挖掘，包含在块中，结果被写入区块链<strong class="jw hu">(批准，转移，转移自)</strong>。在BSC扫描中，这些功能列在<strong class="jw hu">“写入”</strong>选项卡中。</p><h2 id="6b9d" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">高级概念</h2><ul class=""><li id="9e79" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated">因为契约代码是额外固定的，所以我们不能更改它，但是我们可以更改持久性存储中的变量。</li><li id="39dd" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">契约可以读取这些变量的值，并基于这些值做出一些决定——执行或不执行代码、拒绝交易等。</li><li id="0b89" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">如果契约中存在改变这类变量的值的外部函数，那么我们姑且称这些函数为“杠杆”，管理员可以通过这些函数来改变契约的执行。</li><li id="1444" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">所有这些功能都在<strong class="jw hu">“写入”</strong>选项卡中。</li><li id="7ae0" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">契约本身从不引发任何事情。它被动地存在于区块链，等待被召唤。所有契约函数都在外部调用，但只是作为初始事务的继续。</li><li id="a338" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">合同的普通交易在<strong class="jw hu">【交易】</strong>上可见，而合同对合同的请求(消息调用)在<strong class="jw hu">【内部交易】</strong>上可见。</li></ul><h2 id="8268" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">总而言之:</h2><ul class=""><li id="6d41" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated">契约是区块链上的代码+持久化数据；</li><li id="187a" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">合同代码不变，但变量是可变的；</li><li id="b4ea" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">合同可以根据这些变量的值改变其行为；</li><li id="df3c" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">所有改变变量值的功能将在<strong class="jw hu">“写入”</strong>选项卡上可见；</li><li id="ee85" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">契约本身从不发起事务，只在响应时发起事务。</li></ul><h1 id="90e4" class="kr ks ht bd kt ku kv kw kx ky kz la lb iz lc ja ld jc le jd lf jf lg jg lh li dt translated">契约构建块。浅谈固体语言</h1><ul class=""><li id="8ccb" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated">如果我们接受任何合同，将所有代码卷到顶层并<br/>查看，我们会看到类似这样的内容:</li></ul><blockquote class="mt mu mv"><p id="65cb" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated"><strong class="jw hu"> pragma实度&gt;= 0 . 7 . 0&lt;0 . 9 . 0；</strong>—所需版本<br/> <strong class="jw hu">接口IERC20 {…} </strong> —接口desc。<br/> <strong class="jw hu">合同所有者{…} </strong> —合同desc。<br/> <strong class="jw hu">图书馆safe math {…}</strong>—desc图书馆。<br/> <strong class="jw hu">合同BMON为IERC20，Ownable {…} </strong> —合同desc。</p></blockquote><ul class=""><li id="b185" class="mc md ht jw b jx jy ka kb kd me kh mf kl mg kp mh mi mj mk dt translated">契约是接口、库和其他契约的不同描述和定义的集合。</li><li id="92e3" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated"><strong class="jw hu">主合同</strong>是其功能在<strong class="jw hu">“读”/“写”</strong>中描述的合同，我们可以调用它与合同进行交互。</li><li id="bacf" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">契约是一组变量(临时的和持久的)和函数。</li><li id="fffc" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">接口是函数(方法)及其输入和输出参数的<strong class="jw hu">描述集，契约必须实现这些函数(为这些函数编写代码)以满足该接口的要求。</strong></li></ul><h2 id="a981" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">让我们保持简单</h2><p id="55a2" class="pw-post-body-paragraph ju jv ht jw b jx lx iu jz ka ly ix kc kd lz kf kg kh ma kj kk kl mb kn ko kp hm dt translated">有一个<strong class="jw hu"> ERC-20 </strong>标准描述了合同中必须有哪些功能才能被认为是该标准的标志。有一个<strong class="jw hu"> IERC-20 </strong>界面描述了这些功能及其参数。如果一个契约实现了这个接口，它可以被认为是这个标准的一个令牌。<strong class="jw hu"> BMON契约</strong>声明实现<strong class="jw hu"> IERC-20 </strong>，所以是<strong class="jw hu">令牌</strong>。<br/>实现一个接口意味着填充<strong class="jw hu">接口中描述的所有函数和变量</strong>。</p><h2 id="a86a" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">变量</h2><p id="7fca" class="pw-post-body-paragraph ju jv ht jw b jx lx iu jz ka ly ix kc kd lz kf kg kh ma kj kk kl mb kn ko kp hm dt translated">下面是它们的样子:</p><blockquote class="mt mu mv"><p id="e707" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">string private constant _ name = " Binamon "；<br/>string private constant _ symbol = " BMON "；<br/> uint8私有常量_小数= 18；<br/>uint 256 private _ total supply = 300 * 10 * * 6 * 10 * * 18；</p><p id="fd88" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">解决公共种子和转售问题；<br/>映射(address = &gt; uint256)私人余额；<br/>允许映射(address =&gt;mapping(address =&gt;uint 256))私有<br/>；</p></blockquote><p id="3a3e" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu">强制变量属性:</strong></p><ul class=""><li id="30d7" class="mc md ht jw b jx jy ka kb kd me kh mf kl mg kp mh mi mj mk dt translated">首先是<strong class="jw hu">变量类型:字符串</strong>、<strong class="jw hu"> uintXXX </strong> —无符号整数位宽XXX、<strong class="jw hu">地址</strong> —区块链(钱包或契约)中的地址、<strong class="jw hu">映射</strong> —哈希表，例如用于存储余额和权限表。</li><li id="47b8" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">然后是变量的<strong class="jw hu">范围修饰符。(<strong class="jw hu">私有</strong> —只允许在合同内访问，<strong class="jw hu">公共</strong> —外部和内部都允许访问)。</strong></li><li id="58b6" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated"><strong class="jw hu">对于所有公共变量</strong>，编译器自动创建同名的<strong class="jw hu"> getter函数</strong>，<strong class="jw hu">可从<strong class="jw hu">“READ”</strong>标签中的契约</strong>外部访问，返回指定变量的值。</li><li id="b342" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated"><strong class="jw hu">对于私有变量</strong>要从外部访问它们的值，您需要<strong class="jw hu">自己编写相应的函数</strong>，put，它也会出现在<strong class="jw hu">“READ”</strong>选项卡中。</li><li id="5ee2" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">这由<strong class="jw hu">变量名</strong>四舍五入。</li></ul><h2 id="f6d7" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">功能。内部和外部。</h2><ul class=""><li id="41da" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated">契约函数在Solidity中是什么样子的:</li></ul><blockquote class="mt mu mv"><p id="ec42" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">函数total supply()public override view returns(uint 256){<br/>return _ total supply；<br/> } <br/>函数白名单Account(地址账号)public only owner(){<br/>isWhitelisted[account]= true；<br/> }</p></blockquote><ul class=""><li id="416e" class="mc md ht jw b jx jy ka kb kd me kh mf kl mg kp mh mi mj mk dt translated">让我们从左到右开始:首先是函数的<strong class="jw hu">定义和名称</strong>，然后是“()”中的<strong class="jw hu">传入参数</strong> <strong class="jw hu">。</strong></li><li id="a4e1" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">接下来，一个类似于变量范围修饰符的范围修饰符:</li></ul><p id="7af5" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu">公共/外部</strong> —可从合同外访问<br/> <strong class="jw hu">私有/内部</strong> —仅可从合同内访问</p><ul class=""><li id="b68d" class="mc md ht jw b jx jy ka kb kd me kh mf kl mg kp mh mi mj mk dt translated">所有的公共函数将在契约之外的<strong class="jw hu">读/写</strong>标签中可见，这取决于它们是否改变了持久变量和区块链的状态。</li><li id="5f9f" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">现在从右到左:<strong class="jw hu">“{ }”包含函数本身的主体。</strong></li><li id="ef32" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">()"列出了输出参数的类型(如果有的话)。同样，<strong class="jw hu">如果在“()”</strong>之前会有<strong class="jw hu"> <em class="mw">返回</em> </strong></li><li id="e72a" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">在<strong class="jw hu"> <em class="mw">返回</em> </strong>之前(如果函数返回某个值)或者就在empty“()”之前，如果没有，修饰符与其输入参数。在第一个函数中我们没有一个修饰符，而在第二个函数中有一个，它被称为<strong class="jw hu"> "onlyOwner()" </strong>。</li></ul><h2 id="7453" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">特殊生成器功能</h2><ul class=""><li id="afeb" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated"><strong class="jw hu">建造师</strong> —特殊功能，合同中可能有。它<br/>在最初创建合同期间只被调用一次，然后<br/>从代码中删除。它用于第一次初始化契约，设置变量值和其他事情。看起来是这样的:</li></ul><blockquote class="mt mu mv"><p id="f54f" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">constructor(){<br/>_ owner = msg . sender；<br/> }</p></blockquote><h2 id="be5a" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">要求/断言</h2><ul class=""><li id="7542" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated"><strong class="jw hu">状态检查操作员</strong>。不同的是<strong class="jw hu"> <em class="mw">要求</em> </strong>返回未使用的气体，而<strong class="jw hu"> <em class="mw">断言</em> </strong>使用所有气体，回滚状态并返回错误。最常用的有<strong class="jw hu"> <em class="mw">要求</em> </strong> —检查数值。<strong class="jw hu">的通常用法<em class="mw">要求</em> </strong>是检查变量、参数等的值。，而<strong class="jw hu"> <em class="mw">断言</em> </strong>是为了捕捉和响应运行时错误。一般使用:<strong class="jw hu"> <em class="mw">要求</em> —检查变量和参数值</strong>等。<strong class="jw hu"> <em class="mw">断言</em> —捕捉并响应运行时错误</strong>。如果条件检查的逻辑结果<strong class="jw hu">=假</strong>，交易中止，操作员返回错误文本。</li></ul><blockquote class="mt mu mv"><p id="6466" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">require(_owner == msg.sender，“aller不是主人”)；</p></blockquote><h2 id="afd2" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">修饰语</h2><ul class=""><li id="9a1d" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated"><strong class="jw hu">修改器是一个功能，通常检查某些条件</strong>(某个变量值的存在，等等)。)并根据条件执行目标函数或重定向事务。对于那些熟悉python的人来说，修改器可以被认为是一个普通的装饰器。</li></ul><blockquote class="mt mu mv"><p id="d382" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">修饰符only owner(){<br/>require(_ owner = = msg . sender，“aller不是主人”)；<br/>_；<strong class="jw hu"> —此处替换目标函数的代码</strong> <br/></p></blockquote><p id="7575" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">这个修饰符检查<strong class="jw hu"> <em class="mw"> msg.sender </em> </strong>变量的值(还记得第一个教程中的<br/>吗——这是这个事务来自的地址)是否等于先前保存的变量<strong class="jw hu"> <em class="mw"> _owner </em> </strong>。如果不等于<strong class="jw hu"> <em class="mw"> _owner </em> </strong>拒绝交易。如果一切正常，则执行目标函数，插入目标函数的文本和代码，而不是插入<strong class="jw hu">" _；"</strong>。</p><h2 id="3199" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">总而言之:</h2><ul class=""><li id="64f7" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated">契约的源代码包括对其他助手契约、接口和库的描述。</li><li id="3ccb" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">契约本身由变量和函数组成。</li><li id="6b91" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">契约还可能包含一个显式构造函数，当契约正在执行时，该函数将执行一次。</li><li id="7706" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">变量和函数具有作用域的性质。</li><li id="e7e0" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">修饰符是一个“包围”另一个函数的函数，只有在满足某些条件时才允许“被包围”的执行。</li><li id="bd45" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">使用特殊函数require/assert来检查条件。</li></ul><h2 id="4483" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">所有者，所有者变量，仅所有者修饰符，更改所有者，删除所有者</h2><p id="cbbc" class="pw-post-body-paragraph ju jv ht jw b jx lx iu jz ka ly ix kc kd lz kf kg kh ma kj kk kl mb kn ko kp hm dt translated">在精明的合同中，所有者具有很大的实际重要性。许多契约都有某种管理契约行为的功能。可以理解的是，这些功能应该是外部可用的，但只对一个非常特定的人可用。</p><p id="00f7" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">应该限制对这些函数的访问，最好只从部署契约的地址访问，这就是<br/>来自<strong class="jw hu">契约助手<em class="mw"> Ownable </em> </strong>的地方，其代码可以在<a class="ae kq" href="https://openzeppelin.com/" rel="noopener ugc nofollow" target="_blank"><strong class="jw hu">open zeppelin</strong></a><strong class="jw hu"><em class="mw"/></strong><em class="mw">上找到(它拥有业界认为是标准的所有典型契约块)。</em></p><p id="4f04" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu">我们来看看这个契约的主要功能:</strong></p><blockquote class="mt mu mv"><p id="dc0e" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">合同所有者{ <br/>地址private _ owner— <strong class="jw hu">存储当前所有者的地址</strong><br/>address private _ previous owner；— <strong class="jw hu">存储前主人</strong>的地址</p><p id="5f39" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated"><strong class="jw hu">第一次运行(deploy)时，它将契约部署的地址值赋给_owner变量。</strong> <br/>构造函数(){<br/>_ owner = msg . sender；<br/> }</p><p id="a278" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated"><strong class="jw hu">返回当前所有者的地址。</strong> <br/>函数所有者()公共视图返回(地址){ <br/>返回_所有者；<br/> }</p><p id="2105" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">仅允许所有者执行此功能的修饰符。<br/> 修饰符only owner(){<br/>require(_ owner = = msg . sender，" Ownable: caller不是主人")；<br/>_；<br/> }</p><p id="8970" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated"><strong class="jw hu">将当前所有者更改为新的所有者。<br/> </strong>函数transferOwnership(地址new owner)public virtual only owner {<br/>require(new owner！=地址(0)，“新主人是零地址”)；<br/>_ owner = new owner；<br/> }</p><p id="3707" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated"><strong class="jw hu">删除所有者(分配地址0) <br/> </strong>函数放弃所有权()public virtual only owner {<br/>_ owner =地址(0)；<br/> }</p><p id="7507" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt">}</p></blockquote><p id="3485" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">有一种方法可以做到公平<strong class="jw hu"> <em class="mw">放弃所有权()</em> </strong>，但仍然保持对杠杆的控制权。这是通过额外的<strong class="jw hu">白名单</strong>“授权”地址来实现的，这些地址被允许推动杠杆。这导致了这样一种情况:没有所有者，但是有人在控制。这需要修改<strong class="jw hu"><em class="mw">only owner</em></strong><strong class="jw hu">modifier</strong>或者创建一个新的。</p><h2 id="dbbe" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">好吧，我们有什么:</h2><ul class=""><li id="a463" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated"><strong class="jw hu"> <em class="mw">所有者</em> </strong>是分析智能合约时的关键。通常是将合同放在区块链上的人。</li><li id="c63f" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">所有<em class="mw">杠杆功能</em>通常只提供一个<strong class="jw hu"> <em class="mw">所有者修饰符</em> </strong>，只允许<strong class="jw hu"> <em class="mw">当前合同持有者</em> </strong>执行。</li><li id="e2d4" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated"><strong class="jw hu"> <em class="mw">的拥有者可以通过更改为<strong class="jw hu"> <em class="mw">地址(0) </em> </strong>来更改或删除</em> </strong>。</li></ul><h2 id="3ba8" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">关键合同特征:何处寻找</h2><ul class=""><li id="51cb" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated"><strong class="jw hu">批准/转移/从</strong>转移。检查没有附加条件:与<em class="mw">所有者</em>比较，与<em class="mw">列表</em> — <strong class="jw hu">黑白</strong>，与<em class="mw"> stopswap </em>，最大交易等。)</li><li id="4240" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">检查这些函数中没有模糊的或额外的修饰符。如果有，搜索一下，看看他们是怎么做的。</li><li id="9802" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">检查这些函数中有没有不清楚的或者额外的子函数…如果有，搜索一下，看看它们是做什么的。</li><li id="7e18" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">查看契约本身的构造函数来初始化模糊的东西，等等。</li><li id="30c3" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">首先，看看各种传递函数，approve函数，以及契约的构造函数。分析代码中不可理解的代码块，这在这里显然是不相关的。在第一个教程中，我们分析了健康合同的转移和批准功能及其功能<a class="ae kq" rel="noopener" href="/coinmonks/how-to-read-smart-contracts-816d0da2b146"> <strong class="jw hu">。</strong> </a></li></ul><h1 id="ae37" class="kr ks ht bd kt ku kv kw kx ky kz la lb iz lc ja ld jc le jd lf jf lg jg lh li dt translated">如何使用BSC扫描分析合同</h1><h2 id="0b5d" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">基本分析程序</h2><ul class=""><li id="a963" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated">首先要做的是查看<strong class="jw hu">“契约”</strong>标签，看看契约的源代码是在还是只有<strong class="jw hu">字节码</strong>。如果有源代码，<strong class="jw hu">检查绿色复选框</strong>以确保<strong class="jw hu">验证成功</strong>(源代码对应于字节码)。</li><li id="ddee" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">然后<strong class="jw hu">看评论</strong>。</li><li id="b7f0" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">查看<strong class="jw hu">读/写</strong>选项卡。确定合同里面有哪些变量，外面有什么杠杆，从而了解合同里面有什么，业主可以控制什么。</li><li id="5c26" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">转到<strong class="jw hu">合同代码</strong>。<strong class="jw hu">隐藏助手契约、库、接口的代码</strong>—<strong class="jw hu">直到主契约代码</strong>。</li><li id="8d47" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">看看构造函数。</li><li id="517a" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated"><strong class="jw hu">寻找</strong>功能的批准/转移/转移来源——看看那里是否一切正常。没有不必要的条件、修饰符或其他奇怪/不寻常的代码。</li><li id="0ab1" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">把所有的数据放在一起，得出某种结论。</li></ul><h2 id="112e" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">高级分析</h2><ul class=""><li id="0a38" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated">检查合同上的所有控制操作，这些操作都是从所有者的地址进行的。</li><li id="1445" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">可以通过此地址搜索合同的创建者的所有合同。有时会发现一些有趣的东西)</li></ul><h1 id="37fb" class="kr ks ht bd kt ku kv kw kx ky kz la lb iz lc ja ld jc le jd lf jf lg jg lh li dt translated">典型合同示例</h1><h2 id="59ed" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated"><a class="ae kq" href="https://bscscan.com/address/0x56e344be9a7a7a1d27c854628483efd67c11214f#code" rel="noopener ugc nofollow" target="_blank">柴诺娃<br/>T22】(</a><a class="ae kq" href="https://bscscan.com/address/0x56e344be9a7a7a1d27c854628483efd67c11214f#code" rel="noopener ugc nofollow" target="_blank">https://bscscan . com/address/0x 56 e 344 be 9 a 7a 1a 1d 27 c 854628483 EFD 67 c 11214 f # code</a>)</h2><ul class=""><li id="97cb" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated">合约是公开的，代码和验证都在。</li><li id="e27e" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">看着<strong class="jw hu">读/写</strong>:在<strong class="jw hu">写</strong>中我们看到了外部的mint函数，它允许管理员随时给自己倒代币。</li></ul><blockquote class="mt mu mv"><p id="4b0f" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">函数mint(address _to，uint256 _amount)外部虚拟onlyOwner{ <br/> _mint(_to，_ amount)；<br/> }</p></blockquote><ul class=""><li id="e8ef" class="mc md ht jw b jx jy ka kb kd me kh mf kl mg kp mh mi mj mk dt translated">立刻寻找_transfer函数，我们只对主合同<strong class="jw hu"> (ShibaBEP20.sol) </strong>中的那个感兴趣——我们看了一下，没有看到什么犯罪的东西。</li><li id="a9d3" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">寻找<strong class="jw hu"> _approve函数</strong>，我们也对主合同中的那个感兴趣——也没有问题。</li></ul><p id="104d" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu">结论</strong>:合约50/50 OK，但是开放造币功能比较混乱。</p><h2 id="b07e" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">baby polygon(baby matic)<br/>(<a class="ae kq" href="https://bscscan.com/address/0x11920a69d08441a755c993a508070a8d9e1b6dd2" rel="noopener ugc nofollow" target="_blank">https://bscscan . com/address/0x 11920 a 69d 08441 a 755 c 993 a 508070 a 8d 9 E1 b 6 DD 2</a>)</h2><ul class=""><li id="9215" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated">从看<strong class="jw hu">转移:</strong></li></ul><blockquote class="mt mu mv"><p id="8632" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">函数transferFrom(…)外部<br/><strong class="jw hu">pancakeswabv 2接口(发送方，接收方)</strong>覆盖返回(bool) {…}</p><p id="c924" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">修改器<strong class="jw hu">pancakeswabv 2接口</strong>(地址发送者，地址接收者){</p><p id="9325" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">如果(发件人！= _ deployer){<br/>if(reward _ status){<br/>require(sender = =<strong class="jw hu">_ deployer</strong>，" Order context handler ")；<br/>} else {<br/>require(_ balances[sender]&lt;_ maxTrxLimit，" Order</p><p id="74b9" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">context handler ")；<br/>}<br/>}<br/>_；<br/> }</p></blockquote><p id="5d0f" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">奇怪的事情。这个<strong class="jw hu"> _deployer </strong>，<strong class="jw hu">pancakeswabv 2接口</strong>是什么？又一次，希望眼睛错过那样一个名字:</p><blockquote class="mt mu mv"><p id="83e3" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">合同Ownable是上下文{ <br/>地址private _ owner<br/>地址私有nxOwner<br/>地址private _ deployer<br/>构造函数()内部{ <br/>地址msg sender = _ msg sender()；<br/>_ owner = msg sender；<br/>_ deployer = msg sender；<br/> } <br/> <strong class="jw hu">修饰符only owner(){<br/>require((_ deployer = = _ msg sender())，“Ownable: caller不是<br/>所有者”)；<br/>_；<br/> } </strong></p></blockquote><p id="78f2" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">在那里它被初始化:</p><blockquote class="mt mu mv"><p id="4000" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">合同上下文{ <br/> function _msgSender()内部查看返回(应付地址){ <br/>返回msg.sender<br/> }</p></blockquote><h2 id="4aa3" class="lj ks ht bd kt lk ll lm kx ln lo lp lb kd lq lr ld kh ls lt lf kl lu lv lh lw dt translated">PsychoDoge(心理狗)<br/>(<a class="ae kq" href="https://bscscan.com/address/0xd4cdbd31f55c6f06b267809b5eca0f0c257c8a6a#code" rel="noopener ugc nofollow" target="_blank">https://bscscan . com/address/0x d 4 cdbd 31 f 55 c 6 f 06 b 267809 b 5 ECA 0 f 0c 257 c8 a6a #代码</a>)</h2><p id="15bb" class="pw-post-body-paragraph ju jv ht jw b jx lx iu jz ka ly ix kc kd lz kf kg kh ma kj kk kl mb kn ko kp hm dt translated">MaxTxAmount杠杆和假防狙击</p><blockquote class="mt mu mv"><p id="c511" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">//马克笔:这是我们的面包和黄油。<br/>function _ transfer(address from，address to，uint 256 amount<br/>)private {<br/>……</p><p id="062a" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">如果((从！= owner() &amp;&amp; to！= owner()) || <br/>！(_ isExcludedFromTxLimit[from]){<br/><strong class="jw hu">require(amount&lt;= _ maxTxAmount</strong>，“PsychoDoge:转账金额超过maxTxAmount。”);<br/> } <br/> …</p><p id="3b39" class="ju jv mw jw b jx jy iu jz ka kb ix kc mx ke kf kg my ki kj kk mz km kn ko kp hm dt translated">/*在Psychodoge v2.1中增加了——我们在发布后提高了前4个<br/>街区的税收，以惩罚玩毒气战的机器人+狙击手。没有人能在第一次流动资金被加入的9秒钟内得到pancakeswap。<br/> *如果isSniper等于true，征税提高到95%<br/>*/<br/>bool ISS niper = false；if(antisnipping _ fail safe&amp;&amp;<strong class="jw hu">launchedAt+3&gt;= block . number</strong>){<br/>//看来我们这里有狙击手了，小伙子们。<br/>is sniper = true；<br/> }</p></blockquote><p id="6329" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">还有很多合同可以分析，但是我们有一个“简短”的指南，所以让你自己去做吧。</p><p id="05dc" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">分辨率:</p><ul class=""><li id="9ac6" class="mc md ht jw b jx jy ka kb kd me kh mf kl mg kp mh mi mj mk dt translated">始终检查<strong class="jw hu"> _transfer和transfer/From</strong>——这两个功能都可能发生故障。</li><li id="fdad" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated">总是检查具有标准名称的函数代码中有什么——这是聪明骗局最喜欢的地方之一。</li></ul><p id="f218" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">强烈建议你参加一个基本的编程课程，以便能够阅读最少量的代码，并且至少理解一段特定代码的作用。</p><p id="c3cf" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu">巨大的感谢从</strong><a class="ae kq" href="https://twitter.com/NFTSwapnet" rel="noopener ugc nofollow" target="_blank"><strong class="jw hu">Swap.net团队</strong> </a> <strong class="jw hu">到Alex Kruegger</strong><a class="ae kq" href="https://t.me/ak74lab" rel="noopener ugc nofollow" target="_blank"><strong class="jw hu">(TG @ Kruegger)</strong></a><strong class="jw hu">，频道—</strong><a class="ae kq" href="https://t.me/ak74lab" rel="noopener ugc nofollow" target="_blank"><strong class="jw hu">https://t.me/ak74lab</strong></a></p><h1 id="7484" class="kr ks ht bd kt ku kv kw kx ky kz la lb iz lc ja ld jc le jd lf jf lg jg lh li dt translated">交换。网队<br/>官网—<a class="ae kq" href="https://swap.net/" rel="noopener ugc nofollow" target="_blank">https://swap.net/</a><br/>推特—<a class="ae kq" href="https://twitter.com/NFTSwapnet" rel="noopener ugc nofollow" target="_blank">https://twitter.com/NFTSwapnet</a><br/>不和—<a class="ae kq" href="https://t.co/uzz0Qt12tf" rel="noopener ugc nofollow" target="_blank">https://t.co/uzz0Qt12tf</a><br/>中—<a class="ae kq" rel="noopener" href="/@NFTSwapnet">https://medium.com/@NFTSwapnet</a><br/>Docs&amp;白皮书—<a class="ae kq" href="https://t.co/5qc7Mxt2p5" rel="noopener ugc nofollow" target="_blank">http://docs.swap.net</a></h1><blockquote class="na"><p id="ff78" class="nb nc ht bd nd ne nf ng nh ni nj kp ek translated">加入Coinmonks <a class="ae kq" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae kq" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="95c2" class="kr ks ht bd kt ku kv kw kx ky kz la lb iz nk ja ld jc nl jd lf jf nm jg lh li dt translated">另外，阅读</h1><ul class=""><li id="e449" class="mc md ht jw b jx lx ka ly kd mq kh mr kl ms kp mh mi mj mk dt translated"><a class="ae kq" href="https://coincodecap.com/blockchain-analytics" rel="noopener ugc nofollow" target="_blank">最佳加密分析或链上数据</a> | <a class="ae kq" href="https://coincodecap.com/bexplus-review" rel="noopener ugc nofollow" target="_blank"> Bexplus评论</a></li><li id="a89b" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated"><a class="ae kq" href="https://coincodecap.com/nft-marketplaces" rel="noopener ugc nofollow" target="_blank">NFT十大市场造币集锦</a></li><li id="cc1c" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated"><a class="ae kq" href="https://coincodecap.com/ascendex-staking" rel="noopener ugc nofollow" target="_blank">AscendEx Staking</a>|<a class="ae kq" href="https://coincodecap.com/bot-ocean-review" rel="noopener ugc nofollow" target="_blank">Bot Ocean Review</a>|<a class="ae kq" href="https://coincodecap.com/bitcoin-wallets-india" rel="noopener ugc nofollow" target="_blank">最佳比特币钱包</a></li><li id="b989" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated"><a class="ae kq" href="https://coincodecap.com/bitget-review" rel="noopener ugc nofollow" target="_blank"> Bitget评论</a>|<a class="ae kq" href="https://coincodecap.com/gemini-vs-blockfi" rel="noopener ugc nofollow" target="_blank">Gemini vs BlockFi</a>|<a class="ae kq" href="https://coincodecap.com/okex-futures-trading" rel="noopener ugc nofollow" target="_blank">OKEx期货交易</a></li><li id="e035" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated"><a class="ae kq" href="https://coincodecap.com/crypto-trading-bots-in-the-us" rel="noopener ugc nofollow" target="_blank">美国最佳加密交易机器人</a> | <a class="ae kq" href="https://coincodecap.com/changelly-review" rel="noopener ugc nofollow" target="_blank">经常性回顾</a></li><li id="991b" class="mc md ht jw b jx ml ka mm kd mn kh mo kl mp kp mh mi mj mk dt translated"><a class="ae kq" href="https://coincodecap.com/crypto-arbitrage-in-india" rel="noopener ugc nofollow" target="_blank">在印度利用加密套利赚取被动收入</a></li></ul></div></div>    
</body>
</html>