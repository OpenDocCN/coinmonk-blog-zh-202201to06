<html>
<head>
<title>Blockchain Development — How to send and withdraw money from a Solidity smart contract</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">区块链开发——如何从Solidity智能合同中汇款和取款</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/blockchain-development-how-to-send-and-withdraw-money-from-a-solidity-smart-contract-bcbbd27ec1aa?source=collection_archive---------5-----------------------#2022-06-12">https://medium.com/coinmonks/blockchain-development-how-to-send-and-withdraw-money-from-a-solidity-smart-contract-bcbbd27ec1aa?source=collection_archive---------5-----------------------#2022-06-12</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><h1 id="262d" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated">如何从智能合同中发送和撤回以太网</h1><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/0f7cada0c591c6dce99790564fe38bf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zT294qUuZOcJtyRO-vklsQ.png"/></div></div><figcaption class="ka kb fg fe ff kc kd bd b be z ek">Solidity Ethereum image</figcaption></figure><p id="0582" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">在本文中，我们将检查一个智能契约的示例，只有当调用该函数的地址是所有者时，我们才能向该契约发送资金，检查其余额，然后将资金提取到某个地址，通常称为所有者模型。</p><p id="4e4e" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">这其实来自于我开发并围绕其建立的一个网站的银行智能合约。稍后会详细介绍</p><h1 id="c36a" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated">与所有者创建智能合同</h1><p id="8f42" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">首先，我们必须创建一个新文件，将其命名为MySmartContract.sol(或者理想情况下，你可以选择lol ),并添加license和Solidity版本声明，如下所示:</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff lh"><img src="../Images/4a2aa32a8500989027cab1628de70035.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aCowzY3J79TsSmCr.png"/></div></div></figure><p id="9748" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">然后，我们创建一个地址变量来存储以下合同的所有者:</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff lh"><img src="../Images/11743ce51ed5542b059ade2d26d02603.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Mick0Yicl1KAQ3-a.png"/></div></div></figure><p id="a39b" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">接下来，我们将创建一个构造函数，它将部署契约的地址存储为所有者。一个<strong class="kg hu">构造函数</strong>是一个特殊的函数，当契约被部署时只被调用一次。我们将使用<strong class="kg hu">消息</strong>对象的<strong class="kg hu">发送者</strong>属性。<strong class="kg hu"> msg.sender </strong>是solidity中的内置变量，存储在任何给定时间与智能合约交互的地址。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff lh"><img src="../Images/20f133e7f55fb625a2062f4c6203fe4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0mcrRmD91BOccq8Y.png"/></div></div></figure><p id="f6d2" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">继续保存合同，编译并部署。单击contractOwner按钮，查看部署合同的地址现在是所有者。</p><h1 id="56b3" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated">向智能合同汇款</h1><p id="9412" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">接下来，我们将创建一个函数，允许任何地址向合同汇款。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff lh"><img src="../Images/94d6d6a0247328e13ddeb3688ba6a6c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bavBzSte98_sM054.png"/></div></div></figure><p id="7c64" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">我们可以用关键字<code class="eh li lj lk ll b">payable</code>来指定函数可以接收Ether。</p><p id="8dbb" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">在getBalance函数中，关键字<code class="eh li lj lk ll b">this</code>指的是这个特定的契约(MySmartContract)。</p><p id="2907" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">现在，我们将继续部署合同并进行测试，您可以向合同发送以太网并检查合同的余额</p><h1 id="ab77" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated">从智能合同中提取所有资金</h1><p id="694d" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">现在，创建一个withdrawAll函数，它也传递我们希望汇款的地址。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff lh"><img src="../Images/448a27fa10251d17edba00c5bbf7a9b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*k8dylQwBgfl688yy.png"/></div></div></figure><p id="e46b" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">当您部署和测试合同时，您会注意到任何人都可以运行这个withdrawAll函数。我们只允许发送合同所有者来执行此功能。我们使用<code class="eh li lj lk ll b">require</code>来检查条件，如果条件不满足就抛出异常。只是为了保证安全</p><p id="d7e2" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">在这种情况下，我们检查调用该函数的地址是否与合同所有者相同。如果失败，它将回滚事务。这个契约现在满足了所有者模型，它检查调用函数的地址是否是所有者，然后才允许它继续。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff lh"><img src="../Images/62f6f0f4a0a0813d5a9db730b58334f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_rzjqUElvmiOgLP9.png"/></div></div></figure><p id="7193" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">这就是这个简单的智能契约，它允许将钱发送给它，并且只允许所有者从智能契约中提取所有的钱。</p><p id="ecfa" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">如果你觉得这篇文章有帮助，请随意给我一个<strong class="kg hu">掌声</strong>，因为这让我的一天变得明亮起来，因为我知道我可能已经帮助了一些人的制作之旅。</p><p id="7524" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">如果你需要任何进一步的帮助，你也可以给我发信息。我很乐意帮忙。</p><blockquote class="lm"><p id="6132" class="ln lo ht bd lp lq lr ls lt lu lv lb ek translated"><em class="lw">加入Coinmonks </em> <a class="ae lx" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank"> <em class="lw">电报频道</em> </a> <em class="lw">和</em> <a class="ae lx" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> <em class="lw"> Youtube频道</em> </a> <em class="lw">了解加密交易和投资</em></p></blockquote><h1 id="5f8b" class="iq ir ht bd is it iu iv iw ix iy iz ja jb ly jd je jf lz jh ji jj ma jl jm jn dt translated">另外，阅读</h1><ul class=""><li id="84d9" class="mb mc ht kg b kh lc kl ld kp md kt me kx mf lb mg mh mi mj dt translated"><a class="ae lx" rel="noopener" href="/coinmonks/3commas-review-an-excellent-crypto-trading-bot-2020-1313a58bec92">3商业评论</a> | <a class="ae lx" href="https://coincodecap.com/pionex-review-exchange-with-crypto-trading-bot" rel="noopener ugc nofollow" target="_blank"> Pionex评论</a> | <a class="ae lx" rel="noopener" href="/coinmonks/coinrule-review-2021-a-beginner-friendly-crypto-trading-bot-daf0504848ba"> Coinrule评论</a></li><li id="615a" class="mb mc ht kg b kh mk kl ml kp mm kt mn kx mo lb mg mh mi mj dt translated"><a class="ae lx" rel="noopener" href="/coinmonks/ledger-vs-ngrave-zero-7e40f0c1d694">莱杰vs n格拉夫</a> | <a class="ae lx" rel="noopener" href="/coinmonks/ledger-nano-s-vs-x-battery-hardware-price-storage-59a6663fe3b0">莱杰纳诺s vs x </a> | <a class="ae lx" rel="noopener" href="/coinmonks/binance-review-ee10d3bf3b6e">币安评论</a></li><li id="03d2" class="mb mc ht kg b kh mk kl ml kp mm kt mn kx mo lb mg mh mi mj dt translated"><a class="ae lx" rel="noopener" href="/coinmonks/bybit-exchange-review-dbd570019b71"> Bybit Exchange审查</a> | <a class="ae lx" href="https://coincodecap.com/bityard-reivew" rel="noopener ugc nofollow" target="_blank"> Bityard审查</a> | <a class="ae lx" href="https://coincodecap.com/jet-bot-review" rel="noopener ugc nofollow" target="_blank"> Jet-Bot审查</a></li><li id="f66f" class="mb mc ht kg b kh mk kl ml kp mm kt mn kx mo lb mg mh mi mj dt translated"><a class="ae lx" rel="noopener" href="/coinmonks/3commas-vs-pionex-vs-cryptohopper-best-crypto-bot-6a98d2baa203">3 commas vs crypto hopper</a>|<a class="ae lx" rel="noopener" href="/coinmonks/earn-crypto-interest-b10b810fdda3">赚取加密利息</a></li><li id="bb02" class="mb mc ht kg b kh mk kl ml kp mm kt mn kx mo lb mg mh mi mj dt translated">最好的比特币<a class="ae lx" rel="noopener" href="/coinmonks/hardware-wallets-dfa1211730c6">硬件钱包</a> | <a class="ae lx" rel="noopener" href="/coinmonks/bitbox02-review-your-swiss-bitcoin-hardware-wallet-c36c88fff29"> BitBox02回顾</a></li></ul></div></div>    
</body>
</html>