<html>
<head>
<title>An Intro To Near Dapp Development With Rust, WASM, Parcel and React -Part 2.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Rust，WASM，Parcel和React的近Dapp开发介绍-第2部分。</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/an-intro-to-near-dapp-development-with-rust-wasm-parcel-and-react-part-2-6bd3a071b74e?source=collection_archive---------8-----------------------#2022-03-15">https://medium.com/coinmonks/an-intro-to-near-dapp-development-with-rust-wasm-parcel-and-react-part-2-6bd3a071b74e?source=collection_archive---------8-----------------------#2022-03-15</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/2beb60904ee6ad19e29871eefe55c9bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KbB_oVuIU2XXs6P6QyTuag.jpeg"/></div></div></figure><div class=""/><p id="65b5" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">本文用一个简单、实用、从头到尾的例子向现有的Web3开发人员介绍了Near协议，分为三个部分。</p><p id="8093" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">对于那些刚刚加入我们的人来说，请随意查看本教程的第1部分<a class="ae jz" rel="noopener" href="/coinmonks/an-intro-to-near-dapp-development-with-rust-wasm-parcel-and-react-part-1-e500a3abc597?source=friends_link&amp;sk=216f6365fcd46133ae278961c5260243"> <strong class="jd if">这里</strong> </a> <strong class="jd if"> </strong>以加快速度！</p><p id="fd8f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">本教程第1部分和第2部分的完整代码库可以在这里</strong>  <strong class="jd if">找到</strong> <a class="ae jz" href="https://github.com/Panasthetik/near-starter-app" rel="noopener ugc nofollow" target="_blank"> <strong class="jd if">。</strong></a></p><p id="34e8" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">上周，我们在区块链附近开始了我们的开发者之旅，涵盖了创建智能合约以部署在Near Testnet上的一些基本先决条件，并能够相应地设置我们的Near wallet和Rust环境。然后，我们完成了第1部分，使用Cargo和“contract”目录中的“build . sh”bash脚本初步构建了我们与WASM的合同。</p><p id="9d87" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在今天的会议中，我们将继续我们的项目，首先编写一些Rust单元测试来运行我们的smart契约。然后，我们将在Near-CLI中创建一个部署子帐户，将我们的合同部署到Near Testnet，并且在继续第3部分中的React前端集成之前，实际上能够在开发人员控制台中与它进行交互。</p><p id="5462" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">所以我们继续吧！</p><p id="021b" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">编写Rust单元测试。</strong></p><p id="27cf" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">首先，让我们再看一下我们的“事件”契约，看看我们需要在Rust单元测试中测试哪些函数。如果我们再次打开“src”文件夹中的“lib.rs ”,我们会看到上次写的以下内容:</p><figure class="ka kb kc kd fq hv"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="c437" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">因为我们知道这个契约需要1)允许用户用他们的Near wallet登录来创建一个事件，2)让用户能够对列出的事件进行投票——我们可以立即指定一些功能作为我们的单元测试的目标。</p><p id="403a" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在Rust中，最简单的方法是首先确定启动契约状态更改的两个函数:</p><ol class=""><li id="472e" class="kg kh ie jd b je jf ji jj jm ki jq kj ju kk jy kl km kn ko dt translated">add_event()</li></ol><p id="a8ca" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">2.add_vote()</p><p id="4f28" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们将首先检查“add_event”及其相关函数—</p><p id="4c5c" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">第43–55行(在上面的“lib.rs”中):</p><figure class="ka kb kc kd fq hv"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="0f29" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">“添加事件”功能是我们合同中的主要功能——它在事件列表中打开一个项目，带有标题、描述和建议的预算。一旦我们用“Event::new”调用“Event”struct(我们将它声明为我们的“models.rs”文件)，我们就能够在Near Blockchain上创建一个新事件，该事件稍后将被我们的前端引用，并显示在我们的Dapp的主页上。</p><p id="96ac" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">为了验证一个事件是否被添加到链上，我们还有另外两个助手函数，它们首先显示事件列表…</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="d604" class="ku kv ie kq b fv kw kx l ky kz">// lines 57-61 (in “lib.rs” above)</span><span id="b0a8" class="ku kv ie kq b fv la kx l ky kz">pub fn list_events()</span><span id="e32f" class="ku kv ie kq b fv la kx l ky kz">...</span></pre><p id="83c0" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">…然后还可以跟踪我们合同范围内的所有事件/项目的数量…</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="3cbf" class="ku kv ie kq b fv kw kx l ky kz">// lines 63-65 (in “lib.rs” above)</span><span id="0e47" class="ku kv ie kq b fv la kx l ky kz">pub fn event_count()</span><span id="c80e" class="ku kv ie kq b fv la kx l ky kz">...</span></pre><p id="cb03" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们需要做的是编写一个单元测试来验证这个整体函数是否如预期的那样工作，因此让我们将以下内容添加到“lib.rs”文件的<em class="lb">底部</em>:</p><figure class="ka kb kc kd fq hv"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="3bf5" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="lb">重要提示:上面的文件应该粘贴在主“契约”实现括号之外(在“lib.rs”中的第82行之后)。如果您将测试代码包含在主契约体中，您将在Cargo中得到一个编译错误，告诉您它超出了范围！！</em></p><p id="af92" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">在我们上面的测试代码中要考虑的重要事情。</strong></p><p id="eddb" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在Rust中执行智能合约的一个很棒的事情是，我们还可以在Rust中编写单元测试，并在Cargo中运行它们，在我们考虑在WASM进行最终部署之前，就可以利用令人难以置信的编译器和错误处理功能。</p><p id="7924" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">看一下我们从上面开始的单元测试，它针对“add_event”函数进行测试，与JavaScript中可能更“冗长”的测试环境(例如Mocha)相比，这个系统的可读性和可理解性变得非常明显。</p><p id="10ae" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">所以对于从我们的主契约调用的“add_event”函数:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="9a5b" class="ku kv ie kq b fv kw kx l ky kz">contract.add_event()</span></pre><p id="1f41" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们设置了一个测试模拟环境(在我们的Near SDK中也称为“上下文”),以便能够想象一个场景，其中“alice”表示一个Near帐户(参见设置代码中的“alice.testnet ”),与一个新的契约实例(“Contract::new”)进行交互，然后在我们的“create_project”单元测试中创建一个新事件<strong class="jd if">。</strong></p><p id="a66f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在这个整体测试中调用的另一个相关契约函数被分配给“result”变量，如下所示:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="cc42" class="ku kv ie kq b fv kw kx l ky kz">let result = contract.event_count()</span></pre><p id="6873" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这样做的目的是验证“add_event()”的结果—它确保在我们的测试中确实创建了一个新事件，并且总事件数为“1”:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="77af" class="ku kv ie kq b fv kw kx l ky kz">assert_eq!(result, 1);</span></pre><p id="f8f9" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">太好了！那么，为什么不运行这个测试，看看我们是否通过，只是用Near SDK启动一个上下文，让Cargo做剩下的事情呢？</p><p id="4cfd" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在您的终端中，在“contract”文件夹中，执行测试脚本:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="7b07" class="ku kv ie kq b fv kw kx l ky kz">bash ./test.sh</span></pre><p id="c7cc" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">就像之前在我们的初步构建期间一样，Cargo将组装我们的板条箱和依赖项，编译我们的代码，从SDK附近创建“上下文”模拟环境，并使用新的契约实例运行我们的单元测试，因为它将部署在真实的区块链上。完成此过程后，您应该会在VSCode终端中看到以下内容:</p><figure class="ka kb kc kd fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/52f02ebb89cd7de3cac39dc6d11a596c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ev74pACb6S-EcMorbuQ-lA.jpeg"/></div></div></figure><p id="bffb" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">太棒了，我们的第一个Rust单元测试通过了，它表明在模拟的“上下文”环境中，创建了一个新事件！</p><p id="4020" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们将为其构建单元测试的下一个函数是“add_vote()”函数。这体现在我们的主合同代码中:</p><p id="d0e3" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">第67–75行(在上面的“lib.rs”中):</p><figure class="ka kb kc kd fq hv"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="bf6b" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这个函数获取一个事件，使它“可变”，这样就可以用“投票”来修改它，并执行将这个信息添加到由事件ID(“ID:usize”)映射的事件中的过程。这里的“投票者”是指任何使用他们的Near wallet登录到Dapp的人，这将自动授予他们访问该功能的权限。</p><p id="e2da" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="lb">有关Near帐户(“前任”、“签名者”和“当前”)的更多信息，请在此处</em>  <em class="lb">查阅官方Near SDK文档</em> <a class="ae jz" href="https://www.near-sdk.io/zero-to-hero/beginner/actions" rel="noopener ugc nofollow" target="_blank"> <em class="lb">，因为这已经超出了本文的范围。</em></a></p><p id="818a" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在主契约的末尾(add_vote之后)还有一个名为“get_total_votes()”的“helper”函数，它有助于确认是否添加了投票，并且我们还将在单元测试中引用:</p><p id="9644" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">第77–81行(在上面的“lib.rs”中):</p><figure class="ka kb kc kd fq hv"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="ded7" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">对于下面的add_voter单元测试，我们将创建一个与上面的add_project单元测试非常相似的结构。我们将把下面的代码添加到“lib.rs”底部的单元测试的末尾，作为“mod tests”括号{}内的第二个测试块(我将很快概括整个“lib.rs”文件，因此所有的闭包都很清楚):</strong></p><figure class="ka kb kc kd fq hv"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="04b3" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在这里，我们为“alice”和“Contract::new”进行与之前测试相同的“上下文”构建和帐户初始化。但是在这种情况下，我们在这里添加了代码…</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="17e4" class="ku kv ie kq b fv kw kx l ky kz">contract.add_vote(0)</span></pre><p id="06b0" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">…其中“0”是事件ID，然后…</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="f72d" class="ku kv ie kq b fv kw kx l ky kz">let result = contract.get_total_votes(0)</span><span id="35a6" class="ku kv ie kq b fv la kx l ky kz">assert_eq!(result, 1)</span></pre><p id="f926" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">一票完全正确，因为“alice”在这里创建了一个项目(事件列表中的项目ID“0”)，并且<strong class="jd if">和</strong>也投了一票(“1”代表项目ID“0”)。</p><p id="38a0" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">在货物中包装单元测试。</strong></p><p id="fec2" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，我们将只包括这两个Rust单元测试，如果一切都正确，我们应该有以下完整的“lib.rs”文件准备好运行两个测试:</p><figure class="ka kb kc kd fq hv"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="9125" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在我们的VSCode终端的“contract”文件夹中，让我们再次运行我们的“test.sh”脚本，如下所示:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="4023" class="ku kv ie kq b fv kw kx l ky kz">bash ./test.sh</span></pre><p id="8eaa" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">像往常一样，在短暂的编译期之后，我们现在应该看到两个单元测试都在控制台上通过，如下所示:</p><figure class="ka kb kc kd fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/a7f80a20540032e4fc5eba01b9979e31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yd03s9qNCua87MX5XBo5UQ.jpeg"/></div></div></figure><p id="19da" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们的Rust单元测试已经通过，我们已经准备好为我们的WASM合同做最后的构建，然后将它部署到附近的Testnet！</p><p id="236a" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">在部署前建立我们的WASM文件，并准备一个Near Testnet合同子账户。</strong></p><p id="146f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">简要回顾一下我们在第1部分开始时所做的事情，我们可以回忆起，首先我们在“wallet.testnet.near”创建了一个近Testnet帐户，如浏览器所示:</p><figure class="ka kb kc kd fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/2a790503d26d42bf67678dc61c84826b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WnuGpoxVljnQoTwQe4FWlw.jpeg"/></div></div></figure><p id="cf93" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在本课的剩余部分，我们将把大部分时间花在VSCode终端和Near CLI上。首先，让我们重复一下第1部分中的帐户登录过程:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="942b" class="ku kv ie kq b fv kw kx l ky kz">near login</span></pre><p id="121e" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这样，我们在浏览器中检查弹出的交易批准，直到在VSCode终端中再次看到类似的内容:</p><figure class="ka kb kc kd fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/d96167336b29a2ca25848bb5777c425d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GPzqTTe_6fYW4G9N9geW-A.jpeg"/></div></div></figure><p id="aa5e" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">接下来，我们需要做<strong class="jd if">一些全新的事情</strong> —我们需要分配一个子帐户作为占位符，以便在上传之前在Near上“包含”我们的智能合约部署。</p><p id="d78e" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">通常，最佳实践是使这个子帐户成为从您使用的主Testnet wallet派生的地址，如下所示:</p><p id="5665" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">近启动器-dapp。<your account="" name="">。测试网</your></p><p id="128f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">…或者，如果我们的主账户是“我的账户”:</p><p id="334c" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">near-starter-dapp . my account . testnet</p><p id="25ff" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">因此，在使用“myaccount.testnet”作为我们的示例基本wallet地址的终端中(您的地址可能会不同，但应该遵循相同的结构)，我们需要输入以下内容，并密切注意此处Near CLI的语法:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="c33e" class="ku kv ie kq b fv kw kx l ky kz">near create-account near-starter-dapp.myaccount.testnet --masterAccount myaccount.testnet</span></pre><p id="4bc7" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">作为响应，在终端中，您应该会看到以下确认信息，表明您的子帐户已创建:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="c263" class="ku kv ie kq b fv kw kx l ky kz">Saving key to '/Users/&lt;yourusername&gt;/.near-credentials/testnet/near-starter-dapp.myaccount.testnet.json'</span><span id="4ff9" class="ku kv ie kq b fv la kx l ky kz">Account near-starter-dapp.myaccount.testnet for network "testnet" was created.</span></pre><p id="78b8" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">此子帐户的密钥对存储在. json文件中，作为您的。near-credentials”目录，现在我们准备在near上的这个子帐户地址准备我们的部署合同。</p><p id="fba0" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">回到我们项目的“contract”文件夹，我们现在将最后一次运行“build.sh ”:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="3eb7" class="ku kv ie kq b fv kw kx l ky kz">bash ./build.sh</span></pre><p id="9d5f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">构建完成后，在我们的主“contract”文件夹中的“res”目录中进行检查。应该有一个文件叫做:"<strong class="jd if"> near_starter_dapp.wasm </strong>"</p><p id="b4e2" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">再次在终端中，让我们运行下面的代码作为我们的部署脚本—这将实际启动我们的子帐户的部署过程:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="02a6" class="ku kv ie kq b fv kw kx l ky kz">near deploy --accountId near-starter-dapp.myaccount.testnet --wasmFile res/near_starter_dapp.wasm</span></pre><p id="736c" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果一切顺利，您应该在控制台中看到这样的确认，即您的Near testnet智能契约现在已经部署了:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="a78e" class="ku kv ie kq b fv kw kx l ky kz">Starting deployment. Account id: near-starter-dapp.myaccount.testnet, node: https://rpc.testnet.near.org, helper: https://helper.testnet.near.org, file: res/near_starter_dapp.wasm</span><span id="79f2" class="ku kv ie kq b fv la kx l ky kz">Transaction Id 3fqzA9vpuKSSsrBry9jE2k2FjoKFZBCdwPU38fTcPVkT</span><span id="3c92" class="ku kv ie kq b fv la kx l ky kz">To see the transaction in the transaction explorer, please open this url in your browser</span><span id="fff7" class="ku kv ie kq b fv la kx l ky kz">https://explorer.testnet.near.org/transactions/3fqzA9vpuKSSsrBry9jE2k2FjoKFZBCdwPU38fTcPVkT</span></pre><p id="8382" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">请注意—您的交易ID将与上述不同！</p><p id="2760" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我希望您的合同部署成功——我知道这个过程是一个漫长的过程，但我认为一旦您在Near上实际部署，您就会同意这个过程不仅非常轻松，而且在方法上对开发人员非常友好。</p><p id="182f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">智能合同与NEAR的交互:让我们来谈谈我们的合同吧！</strong></p><p id="ec90" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在我们在Near Testnet上有了我们的合同，我们可以通过以太坊或Solana上的RPC来做你们中许多人已经做过的那种合同调用。这是一个契约调用的例子，它实际上在我们的智能契约中创建了一个新的事件列表，就像在我们的单元测试中一样。如果我们将它准确地粘贴到我们的控制台中:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="6aef" class="ku kv ie kq b fv kw kx l ky kz">near call near-starter-dapp.myaccount.testnet add_event '{"title": "New Contemporary Art Show", "estimated_budget": 300, "description":"Lots of amazing artists from all over the world, from the fields of painting, sculpture and photography"}' --accountId myaccount.testnet</span></pre><p id="1cac" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们将得到以下结果:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="a2eb" class="ku kv ie kq b fv kw kx l ky kz">Scheduling a call: near-starter-dapp.myaccount.testnet.add_event({"title": "New Contemporary Art Show", "estimated_budget": 300, "description":"Lots of amazing artists from all over the world, from the fields of painting, sculpture and photography"})</span><span id="364c" class="ku kv ie kq b fv la kx l ky kz">Doing account.functionCall()</span><span id="3df7" class="ku kv ie kq b fv la kx l ky kz">Receipt: 6Dm3ez8cYjB5xnpqQiJPVREk9zh6MJGeXo8pjKw58ksP</span><span id="5c35" class="ku kv ie kq b fv la kx l ky kz">Log [near-starter-dapp.myaccount.testnet]: Added a new event!</span><span id="3430" class="ku kv ie kq b fv la kx l ky kz">Transaction Id 3dXoVaUV68Nm5kj1qS4A1cXavPJbsc2nwewBVtAk3BSj</span><span id="0c4b" class="ku kv ie kq b fv la kx l ky kz">To see the transaction in the transaction explorer, please open this url in your browser</span><span id="93c8" class="ku kv ie kq b fv la kx l ky kz"><a class="ae jz" href="https://explorer.testnet.near.org/transactions/3dXoVaUV68Nm5kj1qS4A1cXavPJbsc2nwewBVtAk3BSj" rel="noopener ugc nofollow" target="_blank">https://explorer.testnet.near.org/transactions/3dXoVaUV68Nm5kj1qS4A1cXavPJbsc2nwewBVtAk3BSj</a></span></pre><p id="da76" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">哇！它起作用了，我们的合同现在已经部署，甚至已经添加了一个事件。</p><p id="a04a" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，我们如何确认合同<em class="lb">真的</em>包含了我们近期的“当代艺术”活动？当然，我们可以检查浏览器的网址，如上面的终端所示。但是仅仅从命令行界面呢？</p><p id="1506" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这就更简单了，我们只需再打几个合同电话，从以下内容开始:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="9efe" class="ku kv ie kq b fv kw kx l ky kz">near call near-starter-dapp.myaccount.testnet list_events --accountId myaccount.testnet</span></pre><p id="e6b3" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">当我们运行它时，我们将得到这样的回报:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="f6ac" class="ku kv ie kq b fv kw kx l ky kz">Scheduling a call: near-starter-dapp.myaccount.testnet.list_events()<br/>Doing account.functionCall()<br/>Transaction Id ASzDxXDHqVT82gs5kM3wwfcezJ75Wk9NGCizvvY7f5Ci<br/>To see the transaction in the transaction explorer, please open this url in your browser<br/><a class="ae jz" href="https://explorer.testnet.near.org/transactions/ASzDxXDHqVT82gs5kM3wwfcezJ75Wk9NGCizvvY7f5Ci" rel="noopener ugc nofollow" target="_blank">https://explorer.testnet.near.org/transactions/ASzDxXDHqVT82gs5kM3wwfcezJ75Wk9NGCizvvY7f5Ci</a><br/>[<br/>  {<br/>    id: 0,<br/>    creator: 'myaccount.testnet',<br/>    created_at: 1646505825772610600,<br/>    title: 'New Contemporary Art Show',<br/>    estimated_budget: 300,<br/>    total_votes: 0,<br/>    description: 'Lots of amazing artists from all over the world, from the fields of painting, sculpture and photography',<br/>    votes: []<br/>  },<br/>]</span></pre><p id="bdb6" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果我们想重复同样的过程，为我们的活动合同添加一个投票(在项目ID“0”处)，我们可以这样运行:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="d9b8" class="ku kv ie kq b fv kw kx l ky kz">near call near-starter-dapp.myaccount.testnet add_vote '{"id":0}' --accountId myaccount.testnet</span></pre><p id="8b05" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后，为了验证我们的投票，我们可以在控制台中重复上面的“list_events”调用，我们最终应该得到以下结果:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="7978" class="ku kv ie kq b fv kw kx l ky kz">Scheduling a call: near-starter-dapp.myaccount.testnet.list_events()<br/>Doing account.functionCall()<br/>Transaction Id ASzDxXDHqVT82gs5kM3wwfcezJ75Wk9NGCizvvY7f5Ci<br/>To see the transaction in the transaction explorer, please open this url in your browser<br/><a class="ae jz" href="https://explorer.testnet.near.org/transactions/ASzDxXDHqVT82gs5kM3wwfcezJ75Wk9NGCizvvY7f5Ci" rel="noopener ugc nofollow" target="_blank">https://explorer.testnet.near.org/transactions/ASzDxXDHqVT82gs5kM3wwfcezJ75Wk9NGCizvvY7f5Ci</a><br/>[<br/>  {<br/>    id: 0,<br/>    creator: 'myaccount.testnet',<br/>    created_at: 1646505825772610600,<br/>    title: 'New Contemporary Art Show',<br/>    estimated_budget: 300,<br/>    total_votes: 1,<br/>    description: 'Lots of amazing artists from all over the world, from the fields of painting, sculpture and photography',<br/>    votes: [myaccount.testnet]<br/>  },<br/>]</span></pre><p id="0bd0" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">结束这一部分，接下来的步骤以及我们将在第3部分做什么</strong>。</p><p id="c2cd" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果您还在这里，我想对您在Near上部署您的第一个智能合同、进行Rust单元测试、设置您的Near开发人员环境、进行一些简单的合同调用，以及通常做到这一步表示热烈祝贺！</p><p id="00f3" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在下周的会议中，我们将讨论第2部分中的一些“细节”,说明如何通过清除子地址、在Near CLI中重新创建子地址、重建WASM文件以及在Rust合同被更改/编辑后重新部署来快速“升级”您的合同。</p><p id="fac0" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">对于本教程的第三部分，也是最后一部分，我们将切换到React / JavaScript世界，并将我们的智能合约连接到一个简单而优雅的前端模板！这个模板是基于一个现有的设计，虽然我已经通过使用最新的包作为bundler、transpiler和final dev服务器极大地简化了它。</p><p id="f3e1" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">正如我们最终会看到的，应该很容易使这个项目成为您未来近期开发的主要入门工具包。</p><p id="1dcf" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">再次感谢您的阅读，下次再见……—Panasthetik</p><p id="9963" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">资源:</strong></p><div class="hs ht fm fo hu lc"><a href="https://docs.near.org/docs/develop/basics/getting-started" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab ej"><div class="le ab lf cl cj lg"><h2 class="bd if fv z el lh eo ep li er et id dt translated">开始使用|靠近文档</h2><div class="lj l"><h3 class="bd b fv z el lh eo ep li er et ek translated">NEAR平台上的开发分为两个主要类别:这里是对您…</h3></div><div class="lk l"><p class="bd b gc z el lh eo ep li er et ek translated">docs.near.org</p></div></div></div></a></div><div class="hs ht fm fo hu lc"><a href="https://docs.rs/near-sdk/latest/near_sdk/" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab ej"><div class="le ab lf cl cj lg"><h2 class="bd if fv z el lh eo ep li er et id dt translated">near_sdk - Rust</h2><div class="lj l"><h3 class="bd b fv z el lh eo ep li er et ek translated">智能合约可用的env区块链特定方法。这是一个包装器，围绕着一个低级…</h3></div><div class="lk l"><p class="bd b gc z el lh eo ep li er et ek translated">文件</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq ia lc"/></div></div></a></div><div class="hs ht fm fo hu lc"><a href="https://www.rust-lang.org/" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab ej"><div class="le ab lf cl cj lg"><h2 class="bd if fv z el lh eo ep li er et id dt translated">锈</h2><div class="lj l"><h3 class="bd b fv z el lh eo ep li er et ek translated">Rust速度惊人，内存效率高:没有运行时或垃圾收集器，它可以支持关键性能…</h3></div><div class="lk l"><p class="bd b gc z el lh eo ep li er et ek translated">www.rust-lang.org</p></div></div><div class="ll l"><div class="lr l ln lo lp ll lq ia lc"/></div></div></a></div><blockquote class="ls"><p id="aed7" class="lt lu ie bd lv lw lx ly lz ma mb jy ek translated"><em class="mc">加入Coinmonks </em> <a class="ae jz" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank"> <em class="mc">电报频道</em> </a> <em class="mc">和</em> <a class="ae jz" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> <em class="mc"> Youtube频道</em> </a> <em class="mc">了解加密交易和投资</em></p></blockquote><h1 id="667c" class="md kv ie bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz dt translated">另外，阅读</h1><ul class=""><li id="9f3d" class="kg kh ie jd b je na ji nb jm nc jq nd ju ne jy nf km kn ko dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/3commas-review-an-excellent-crypto-trading-bot-2020-1313a58bec92">3商业评论</a> | <a class="ae jz" href="https://coincodecap.com/pionex-review-exchange-with-crypto-trading-bot" rel="noopener ugc nofollow" target="_blank"> Pionex评论</a> | <a class="ae jz" rel="noopener" href="/coinmonks/coinrule-review-2021-a-beginner-friendly-crypto-trading-bot-daf0504848ba"> Coinrule评论</a></li><li id="73f4" class="kg kh ie jd b je ng ji nh jm ni jq nj ju nk jy nf km kn ko dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/ledger-vs-ngrave-zero-7e40f0c1d694">莱杰vs n rave</a>|<a class="ae jz" rel="noopener" href="/coinmonks/ledger-nano-s-vs-x-battery-hardware-price-storage-59a6663fe3b0">莱杰nano s vs x </a> | <a class="ae jz" rel="noopener" href="/coinmonks/binance-review-ee10d3bf3b6e">币安评论</a></li><li id="2225" class="kg kh ie jd b je ng ji nh jm ni jq nj ju nk jy nf km kn ko dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/bybit-exchange-review-dbd570019b71"> Bybit Exchange审查</a> | <a class="ae jz" href="https://coincodecap.com/bityard-reivew" rel="noopener ugc nofollow" target="_blank"> Bityard审查</a> | <a class="ae jz" href="https://coincodecap.com/jet-bot-review" rel="noopener ugc nofollow" target="_blank"> Jet-Bot审查</a></li><li id="da82" class="kg kh ie jd b je ng ji nh jm ni jq nj ju nk jy nf km kn ko dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/3commas-vs-pionex-vs-cryptohopper-best-crypto-bot-6a98d2baa203">3 commas vs Cryptohopper</a>|<a class="ae jz" rel="noopener" href="/coinmonks/earn-crypto-interest-b10b810fdda3">赚取加密利息</a></li><li id="f2a3" class="kg kh ie jd b je ng ji nh jm ni jq nj ju nk jy nf km kn ko dt translated">最好的比特币<a class="ae jz" rel="noopener" href="/coinmonks/hardware-wallets-dfa1211730c6">硬件钱包</a> | <a class="ae jz" rel="noopener" href="/coinmonks/bitbox02-review-your-swiss-bitcoin-hardware-wallet-c36c88fff29"> BitBox02回顾</a></li></ul></div></div>    
</body>
</html>