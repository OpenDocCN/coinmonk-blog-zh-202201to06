<html>
<head>
<title>A low gas smart contract with a whitelist</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有白名单的低气智能合同</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/a-low-gas-smart-contract-with-a-whitelist-617f43eab0b5?source=collection_archive---------5-----------------------#2022-02-21">https://medium.com/coinmonks/a-low-gas-smart-contract-with-a-whitelist-617f43eab0b5?source=collection_archive---------5-----------------------#2022-02-21</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="21a4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> <em class="jo">更新:虽然这里提出的方法实现起来非常简单，但管理白名单阵列的成本非常高，而且有更好、更便宜的方法来操作白名单。如果你想要一些现成的东西，请继续阅读，但我们建议你看看Merkle树或签名，以获得更好的解决方案。</em>T3】</strong></p><p id="7981" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae jp" href="https://www.youtube.com/watch?v=McmhpmnQLto&amp;ab_channel=HashLipsNFT" rel="noopener ugc nofollow" target="_blank"> HashLips </a>解决了如何在区块链以太坊上发射一架ERC-721 NFT并保持(相对)低的汽油费的问题。</p><p id="195c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在我们之前的文章中，我们解释了如何调整HashLips合同来增加更多的灵活性，以及列出一些汽油费和美元金额的成本。头条新闻是，在合理的油价下，根据这份合同铸造一个NFT大约需要9美元——一点也不差。</p><p id="2337" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">许多NFT的创造者想知道是否有可能保持较低的天然气成本，但在合同中加入白名单。答案是肯定的——算是吧。</p><p id="7221" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">本文解释了我们如何调整简单的低气合同来添加白名单。铸造成本从每NFT 9美元涨到了13美元。考虑到一些NFT对mint的成本高达100美元，我们认为这是一个好结果。</p><p id="ed07" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">代码</strong> <br/>查看我们的GitHub repo <a class="ae jp" href="https://github.com/deadarchitects/test-low-gas-solidity/blob/2e16c5dca25ffd3e3e33dfb7ab68d8570a035354/V6.3%20contract.sol" rel="noopener ugc nofollow" target="_blank">此处</a>为更新的智能合约代码。这是一个完全扁平化的文件，所以当它加载到Remix你不需要导入额外的文件。如果您以前没有部署过智能契约，那么<a class="ae jp" href="https://www.youtube.com/watch?v=McmhpmnQLto&amp;ab_channel=HashLipsNFT" rel="noopener ugc nofollow" target="_blank"> HashLips教程</a>是在深入研究代码之前快速入门的一个很好的起点。</p><p id="dc3f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">将白名单添加到代码<br/> </strong>白名单被定义为钱包地址的数组。这意味着，只需添加一个变量，您就可以创建一个包含任意多个白名单地址的数组。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff jq"><img src="../Images/da2de27faa2198b7f57fd9734024cb48.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*hBugb9JX9SrRYVZ0zAPQdg.png"/></div></figure><p id="f6cb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">接下来，我们调整了mintCompliance修饰符，以检查白名单是否处于活动状态(白名单长度&gt; 0)，然后，如果有白名单，则检查试图进行mint的地址是否在白名单中。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff jy"><img src="../Images/9f5de3f060530adac8d01221356a630e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*HVwouFaErxYj-tEvnG0nRQ.png"/></div></figure><p id="b5d0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这使用了一个新函数<em class="jo"> isAddressWhitelisted </em>，它接收<em class="jo">消息发送者</em>的钱包地址，即试图伪造的地址。它检查这是否是真的，即地址是否在白名单上，如果不是，它抛出一个错误，并且mint不成功。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff jz"><img src="../Images/2e880b5bfc2960cc97211bf88a546fbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*elIwj_Olb5Jv-rsmGYtAEw.png"/></div></figure><p id="322d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">isAddressWhitelisted函数使用while循环遍历白名单地址的数组，并查看是否有匹配的地址给尝试造币的用户。</p><p id="ea08" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">更新以太网扫描</strong> <br/>上的白名单要将白名单上传到智能合约，您可以用以下格式写入智能合约</p><p id="7171" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">[“地址1”、“地址2”、“地址3”]等。</p><p id="3aac" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">要清除白名单，只需编写一个空数组:</p><p id="7e25" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt">[]</p><p id="0436" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">下面的截图显示了三个地址被添加到白名单后，这在Etherscan上是什么样子。你需要小心语法和字符——有时撇号会被转换成“左引号/右引号”,这会破坏语法。如果您在尝试写入时看到红色错误信息，这可能是原因。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="fe ff ka"><img src="../Images/3bfe4a5dfcf073b9e7c22ebbf71f8d91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4gAlcNxH4ei_cTaDNG5tlg.png"/></div></div></figure><p id="752a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">此合同没有白名单开/关的变量。如果白名单包含任何地址，则白名单开启。如果它是空的，那么它是关闭的。</p><p id="a256" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">结论</strong>铸造一个NFT的成本约为13美元，仅比简单低气合同略高(Gwei为50美元，ETH为3000美元)。</p><p id="eb6c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您认为这可以改进或者您有任何反馈，请告诉我们。如果你有任何问题，加入我们的不和谐服务器<a class="ae jp" href="https://discord.gg/2W3rSEFU6P" rel="noopener ugc nofollow" target="_blank">https://discord.gg/mu4vr5krH5</a>，我们会尽力帮助你。</p><p id="b58d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae jp" href="https://twitter.com/dead_architects" rel="noopener ugc nofollow" target="_blank">https://twitter.com/dead_architects</a>T10】https://dead architects . XYZ</p><blockquote class="kf"><p id="1a3b" class="kg kh ht bd ki kj kk kl km kn ko jn ek translated"><em class="kp">加入Coinmonks </em> <a class="ae jp" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank"> <em class="kp">电报频道</em> </a> <em class="kp">和</em> <a class="ae jp" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> <em class="kp"> Youtube频道</em> </a> <em class="kp">了解加密交易和投资</em></p></blockquote><h1 id="361a" class="kq kr ht bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln dt translated">另外，阅读</h1><ul class=""><li id="f05e" class="lo lp ht is b it lq ix lr jb ls jf lt jj lu jn lv lw lx ly dt translated"><a class="ae jp" href="https://coincodecap.com/bookmap-review-2021-best-trading-software" rel="noopener ugc nofollow" target="_blank"> Bookmap评论</a> | <a class="ae jp" href="https://coincodecap.com/crypto-exchange-usa" rel="noopener ugc nofollow" target="_blank">美国5大最佳加密交易所</a></li><li id="25a5" class="lo lp ht is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly dt translated">最佳加密<a class="ae jp" rel="noopener" href="/coinmonks/hardware-wallets-dfa1211730c6">硬件钱包</a> | <a class="ae jp" rel="noopener" href="/coinmonks/bitbns-review-38256a07e161"> Bitbns评论</a></li><li id="9cdd" class="lo lp ht is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly dt translated"><a class="ae jp" href="https://coincodecap.com/crypto-exchange-in-singapore" rel="noopener ugc nofollow" target="_blank">新加坡十大最佳加密交易所</a> | <a class="ae jp" href="https://coincodecap.com/buy-axs-token" rel="noopener ugc nofollow" target="_blank">购买AXS </a></li><li id="c741" class="lo lp ht is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly dt translated"><a class="ae jp" href="https://coincodecap.com/red-dog-casino-review" rel="noopener ugc nofollow" target="_blank">红狗赌场评论</a> | <a class="ae jp" href="https://coincodecap.com/swyftx-review" rel="noopener ugc nofollow" target="_blank"> Swyftx评论</a> | <a class="ae jp" href="https://coincodecap.com/coingate-review" rel="noopener ugc nofollow" target="_blank">造币厂评论</a></li><li id="0517" class="lo lp ht is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly dt translated"><a class="ae jp" href="https://coincodecap.com/best-crypto-to-invest-in-india-in-2021" rel="noopener ugc nofollow" target="_blank">投资印度的最佳密码</a>|<a class="ae jp" href="https://coincodecap.com/wazirx-p2p" rel="noopener ugc nofollow" target="_blank">WazirX P2P</a>|<a class="ae jp" href="https://coincodecap.com/hi-dollar-review" rel="noopener ugc nofollow" target="_blank">Hi Dollar Review</a></li><li id="9019" class="lo lp ht is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly dt translated"><a class="ae jp" href="https://coincodecap.com/5-best-crypto-trading-bots-in-canada" rel="noopener ugc nofollow" target="_blank">加拿大最佳加密交易机器人</a> | <a class="ae jp" href="https://coincodecap.com/kucoin-review" rel="noopener ugc nofollow" target="_blank">库币评论</a></li><li id="4ff5" class="lo lp ht is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly dt translated"><a class="ae jp" href="https://coincodecap.com/huobi-crypto-trading-signals" rel="noopener ugc nofollow" target="_blank">火币加密交易信号</a> | <a class="ae jp" rel="noopener" href="/coinmonks/hitbtc-review-c5143c5d53c2"> HitBTC审核</a></li><li id="99a8" class="lo lp ht is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly dt translated"><a class="ae jp" href="https://coincodecap.com/ftx-futures-trading" rel="noopener ugc nofollow" target="_blank">如何在FTX交易所交易期货</a> | <a class="ae jp" href="https://coincodecap.com/okex-vs-binance" rel="noopener ugc nofollow" target="_blank"> OKEx vs币安</a></li></ul></div></div>    
</body>
</html>