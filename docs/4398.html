<html>
<head>
<title>Contractless Contract</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">无合同合同</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/contractless-contract-cb9b60e9bb91?source=collection_archive---------9-----------------------#2022-04-08">https://medium.com/coinmonks/contractless-contract-cb9b60e9bb91?source=collection_archive---------9-----------------------#2022-04-08</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="ac9e" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">隐藏任何智能合同在一个定期付款机会</h2></div><p id="a49c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们发明了一种叫做<strong class="jk hu"> <em class="ke">无合同契约</em> </strong>的技术，在常规支付(<a class="ae kf" href="https://wiki.bitcoinsv.io/index.php/Bitcoin_Transactions#Pay_to_Public_Key_Hash_.28P2PKH.29" rel="noopener ugc nofollow" target="_blank"> P2PKH </a>)交易中忠实地执行任何智能契约。当各方合作时，它极大地提高了任意多方智能合同的隐私和效率。</p><h1 id="b69d" class="kg kh ht bd ki kj kk kl km kn ko kp kq iz kr ja ks jc kt jd ku jf kv jg kw kx dt translated">无合同合同</h1><p id="bb3a" class="pw-post-body-paragraph ji jj ht jk b jl ky iu jn jo kz ix jq jr la jt ju jv lb jx jy jz lc kb kc kd hm dt translated">我们举例说明了无合同契约在双方之间是如何运作的。它可以很容易地扩展到多方。在有两个当事人的典型合同中，工作流程如下:</p><figure class="le lf lg lh fq li fe ff paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="fe ff ld"><img src="../Images/9235e9b8b92ae39e59b884ea66898d2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RCVVIwTED_1lYOpPtFhPKw.png"/></div></div><figcaption class="lp lq fg fe ff lr ls bd b be z ek">Figure 1: Contract Workflow: Before</figcaption></figure><p id="ee55" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">爱丽丝和鲍勃各自在合同中存入了钱。在契约执行之后，它根据契约的逻辑将输出拆分给Alice和Bob。该执行可以由例如散列前像、签名或由先知签名的体育比赛结果的发布来触发。</p><p id="87d1" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们修改工作流程如下:</p><figure class="le lf lg lh fq li fe ff paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="fe ff lt"><img src="../Images/eb3d9b21cb9b9be088919a5a46e5e159.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lMxZUypKX7cviHqIdwX4bw.png"/></div></div><figcaption class="lp lq fg fe ff lr ls bd b be z ek">Figure 2: Contract Workflow: After</figcaption></figure><p id="c4d5" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们不是直接存进合同，而是先存进一个联名地址，双方签字才能解锁。之后，共同基金被锁定在合同中。</p><p id="1a71" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">乍一看，这个额外的步骤似乎是多余的，只会增加复杂性。<strong class="jk hu">关键思想是合同事务(<em class="ke"> tx2 </em>)不被Alice和Bob广播和离线持有。这份合同是秘密执行的。如果Alice和Bob对结果达成一致，他们都可以签署新的交易tx2’并花费tx1。</strong></p><figure class="le lf lg lh fq li fe ff paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="fe ff lu"><img src="../Images/073b353c6c5b96185b0f4de57b15e56f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qs0Lix5iCqqtEFWgujkfaw.png"/></div></div><figcaption class="lp lq fg fe ff lr ls bd b be z ek">Figure 3: Contract Workflow: Cooperative Signing</figcaption></figure><p id="03b1" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这和广播<em class="ke"> tx2 </em>和<em class="ke"> tx3 </em>的效果是一样的，就爱丽丝和鲍勃收到多少比特币而言，但是有两个好处。</p><ul class=""><li id="6c8b" class="lv lw ht jk b jl jm jo jp jr lx jv ly jz lz kd ma mb mc md dt translated"><em class="ke">隐私</em>:所有交易(<em class="ke"> tx1 </em>和<em class="ke">tx2’</em>)看起来和普通支付(P2PKH)交易一样。外部当事人甚至不知道有一个隐藏的潜在合同。</li><li id="f38e" class="lv lw ht jk b jl me jo mf jr mg jv mh jz mi kd ma mb mc md dt translated">效率:不管合同有多复杂和多大，区块链上只有两笔支付交易，节省了大量矿工费用。</li></ul><h2 id="e0b5" class="mj kh ht bd ki mk ml mm km mn mo mp kq jr mq mr ks jv ms mt ku jz mu mv kw mw dt translated">不合作案件</h2><p id="5134" class="pw-post-body-paragraph ji jj ht jk b jl ky iu jn jo kz ix jq jr la jt ju jv lb jx jy jz lc kb kc kd hm dt translated">当任何一方不配合且拒绝签署<em class="ke">tx2’</em>时，另一方随时可以广播预签<em class="ke"> tx2 </em>并在<em class="ke"> tx3 </em>终止合同。追索权选项激励所有各方进行合作。</p><h1 id="a5e7" class="kg kh ht bd ki kj kk kl km kn ko kp kq iz kr ja ks jc kt jd ku jf kv jg kw kx dt translated">阈值签名</h1><p id="c004" class="pw-post-body-paragraph ji jj ht jk b jl ky iu jn jo kz ix jq jr la jt ju jv lb jx jy jz lc kb kc kd hm dt translated">在<em class="ke"> tx1 </em>中，我们使用一个2选2 <a class="ae kf" href="https://wiki.bitcoinsv.io/index.php/Digital_signatures_in_Bitcoin" rel="noopener ugc nofollow" target="_blank">门限签名方案</a> (TSS):</p><ul class=""><li id="f19f" class="lv lw ht jk b jl jm jo jp jr lx jv ly jz lz kd ma mb mc md dt translated">生成联合公钥</li><li id="577b" class="lv lw ht jk b jl me jo mf jr mg jv mh jz mi kd ma mb mc md dt translated">为了解锁，爱丽丝和鲍勃都必须分别签名。组合两个签名的联合签名对于联合公钥是有效的。</li></ul><p id="eb0b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">从外面看，联合公钥和签名看起来与常规公钥和签名一样。令人惊奇的是，签名时联合公钥对应的私钥不必存在，避免了单点故障。</p><figure class="le lf lg lh fq li fe ff paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="fe ff mx"><img src="../Images/5912b49d7286632edc9f7deff4dd6bc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gAW4g5B2rES9MQlU.png"/></div></div><figcaption class="lp lq fg fe ff lr ls bd b be z ek">Figure 4: Threshold Signature Scheme (Source: <a class="ae kf" href="https://nakasendoproject.org/" rel="noopener ugc nofollow" target="_blank">nakasendo SDK</a>)</figcaption></figure><p id="c132" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">详细解释TSS如何在ECDSA上工作超出了本文的范围。感兴趣的读者可以阅读nChain的白皮书和T2的白皮书。TSS已经在<a class="ae kf" href="https://youtu.be/mOLiwmudaws" rel="noopener ugc nofollow" target="_blank">这里</a>进行了演示，并被广泛用于生产钱包，如<a class="ae kf" href="https://handcash.medium.com/handcash-goes-keyless-b86d27339254" rel="noopener">手动现金</a>和<a class="ae kf" href="https://volt.id/" rel="noopener ugc nofollow" target="_blank">伏特</a>。</p><h1 id="e1ec" class="kg kh ht bd ki kj kk kl km kn ko kp kq iz kr ja ks jc kt jd ku jf kv jg kw kx dt translated">中本聪签署协议</h1><p id="df04" class="pw-post-body-paragraph ji jj ht jk b jl ky iu jn jo kz ix jq jr la jt ju jv lb jx jy jz lc kb kc kd hm dt translated">遵循图2中的工作流程的一种简单方法是，Alice和Bob依次签署并广播tx0/tx0’、tx1和tx2。然而，有几个问题。在Bob获得Alice的部分签名的tx1后，他可以</p><ul class=""><li id="d129" class="lv lw ht jk b jl jm jo jp jr lx jv ly jz lz kd ma mb mc md dt translated">将资金重定向到另一个合同</li><li id="4969" class="lv lw ht jk b jl me jo mf jr mg jv mh jz mi kd ma mb mc md dt translated">或者签了播tx1，后来拒绝签。爱丽丝的基金卡住了。</li></ul><p id="71d9" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">为了克服这些问题，我们受中本聪的启发，分两步建立了合同<a class="ae kf" href="https://www.bitcoin.com/satoshi-archive/emails/mike-hearn/15/" rel="noopener ugc nofollow" target="_blank">，我们称之为中本聪签署协议。</a></p><ol class=""><li id="2442" class="lv lw ht jk b jl jm jo jp jr lx jv ly jz lz kd my mb mc md dt translated">爱丽丝和鲍勃交换<em class="ke"> tx0 </em>和<em class="ke">tx0’</em>的<strong class="jk hu"> txid </strong>，这足以创建和签名<em class="ke"> tx1 </em>和<em class="ke"> tx2 </em>。但是它们还没有彼此共享原始事务<em class="ke"> tx0 </em>和<em class="ke">tx0’</em>，并且使它们保持离线。</li><li id="1432" class="lv lw ht jk b jl me jo mf jr mg jv mh jz mi kd my mb mc md dt translated">Alice检查<em class="ke"> tx1 </em>和<em class="ke"> tx2 </em>是否都已签名，并且它们的输出包含预期的联合地址和合同。如果是，她广播<em class="ke"> tx0 </em>。如果没有，她会中止。鲍勃做同样的事情。</li></ol><p id="01e1" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">由于<em class="ke"> tx1 </em>需要<em class="ke"> tx0 </em>和<em class="ke">tx0’</em>都有效，合同只有在双方都不放弃的情况下才能继续。</p><h1 id="f25e" class="kg kh ht bd ki kj kk kl km kn ko kp kq iz kr ja ks jc kt jd ku jf kv jg kw kx dt translated">与合作合同相比</h1><p id="fa0e" class="pw-post-body-paragraph ji jj ht jk b jl ky iu jn jo kz ix jq jr la jt ju jv lb jx jy jz lc kb kc kd hm dt translated">无合同合同类似于我们介绍过的<a class="ae kf" href="https://xiaohuiliu.medium.com/cooperative-smart-contracts-730c7186fc6c" rel="noopener">合作合同</a>，当各方就最终产出达成一致时，采取一种捷径。它比后者更私密、更高效:</p><ul class=""><li id="f439" class="lv lw ht jk b jl jm jo jp jr lx jv ly jz lz kd ma mb mc md dt translated">在后者中，整个智能合同总是暴露在链上，而在前者中，如果各方合作，则不会暴露。</li><li id="1ee5" class="lv lw ht jk b jl me jo mf jr mg jv mh jz mi kd ma mb mc md dt translated">后者在各方合作签名时，解锁交易中需要所有签名，而前者只需要一个签名。</li></ul></div><div class="ab cl mz na hb nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="hm hn ho hp hq"><p id="304b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">[1]存款和分割金额都可以为零，这意味着只有一方存款和赎回。</p><p id="e82a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">[2]与许多人的想法相反，将多个签名聚合成一个签名并不需要Schnorr签名。</p><blockquote class="ng"><p id="d0f0" class="nh ni ht bd nj nk nl nm nn no np kd ek translated">加入Coinmonks <a class="ae kf" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae kf" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="d283" class="kg kh ht bd ki kj kk kl km kn ko kp kq iz nq ja ks jc nr jd ku jf ns jg kw kx dt translated">另外，阅读</h1><ul class=""><li id="a5f3" class="lv lw ht jk b jl ky jo kz jr nt jv nu jz nv kd ma mb mc md dt translated"><a class="ae kf" href="https://coincodecap.com/huobi-crypto-trading-signals" rel="noopener ugc nofollow" target="_blank">用于Huobi的加密交易信号</a> | <a class="ae kf" rel="noopener" href="/coinmonks/hitbtc-review-c5143c5d53c2"> HitBTC审核</a></li><li id="7b55" class="lv lw ht jk b jl me jo mf jr mg jv mh jz mi kd ma mb mc md dt translated"><a class="ae kf" href="https://coincodecap.com/ftx-futures-trading" rel="noopener ugc nofollow" target="_blank">如何在FTX交易所交易期货</a> | <a class="ae kf" href="https://coincodecap.com/okex-vs-binance" rel="noopener ugc nofollow" target="_blank"> OKEx vs币安</a></li><li id="e1aa" class="lv lw ht jk b jl me jo mf jr mg jv mh jz mi kd ma mb mc md dt translated"><a class="ae kf" href="https://coincodecap.com/okex-kucoin" rel="noopener ugc nofollow" target="_blank"> OKEx vs KuCoin </a> | <a class="ae kf" href="https://coincodecap.com/celsius-alternatives" rel="noopener ugc nofollow" target="_blank">摄氏替代品</a> | <a class="ae kf" href="https://coincodecap.com/buy-vechain" rel="noopener ugc nofollow" target="_blank">如何购买VeChain </a></li><li id="9ce0" class="lv lw ht jk b jl me jo mf jr mg jv mh jz mi kd ma mb mc md dt translated"><a class="ae kf" href="https://coincodecap.com/profitfarmers-review" rel="noopener ugc nofollow" target="_blank"> ProfitFarmers点评</a> | <a class="ae kf" href="https://coincodecap.com/cornix-trading-bot" rel="noopener ugc nofollow" target="_blank">如何使用Cornix交易机器人</a></li><li id="08cb" class="lv lw ht jk b jl me jo mf jr mg jv mh jz mi kd ma mb mc md dt translated"><a class="ae kf" href="https://coincodecap.com/buy-bitcoin-anonymously" rel="noopener ugc nofollow" target="_blank">如何匿名购买比特币</a> | <a class="ae kf" href="https://coincodecap.com/bitcoin-cash-wallets" rel="noopener ugc nofollow" target="_blank">比特币现金钱包</a></li></ul></div></div>    
</body>
</html>