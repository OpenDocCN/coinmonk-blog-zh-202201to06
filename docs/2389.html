<html>
<head>
<title>Solana Blockchain data scraping</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Solana区块链数据抓取</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/solana-blockchain-data-scraping-2cca0dc056aa?source=collection_archive---------4-----------------------#2022-03-13">https://medium.com/coinmonks/solana-blockchain-data-scraping-2cca0dc056aa?source=collection_archive---------4-----------------------#2022-03-13</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="a8bc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">由于区块链上的交易可以作为公共数据访问，我们可以开发一个抓取客户端来检索每个区块中的数据进行分析。</p><p id="bb51" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这里是我用来访问索拉纳区块链的<a class="ae jo" href="https://docs.solana.com/developing/clients/rust-api" rel="noopener ugc nofollow" target="_blank"> Rust API </a>中的代码。</p><p id="cb42" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">创建RPC客户端。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="20bc" class="jy jz ht ju b fv ka kb l kc kd">RpcClient::new("https://solana-api.projectserum.com".to_string());</span></pre><p id="cafb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">获取当前纪元</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="ad02" class="jy jz ht ju b fv ka kb l kc kd">client.get_epoch_info().unwrap();</span></pre><p id="5ce3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">获取历元间隔的时隙号(<code class="eh ke kf kg ju b">absolute_slot</code>)。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="4cf8" class="jy jz ht ju b fv ka kb l kc kd">start_slot = epoch_start.absolute_slot;<br/>end_slot = epoch_end.absolute_slot;</span></pre><p id="acfd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">获取两个时隙号之间的事务块。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="3d03" class="jy jz ht ju b fv ka kb l kc kd">let blocks = _client.get_blocks(start, Some(end)).unwrap();<br/>for s in blocks {<br/>    let _blk = _client.get_block(s);<br/>    // get the data we need from each block</span></pre><p id="20b1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">每个块包含一个事务列表。每个交易都有元数据、消息、交易前后的余额以及帐户列表。</p><p id="549d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">有许多不同种类的信息。从我的测试中，我发现下面的2个消息将表明转移。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="adec" class="jy jz ht ju b fv ka kb l kc kd">"Program 11111111111111111111111111111111 success"</span><span id="2267" class="jy jz ht ju b fv kh kb l kc kd">"Program log: Instruction: Transfer"</span></pre><p id="6b69" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我过滤掉这些信息，然后从前期余额中减去后期余额。可以追踪账户密钥之间转移了多少端口。</p><p id="0d4a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我提取了每笔交易的这些信息，并输入Neo4J graph DB，以建立不同账户之间所有转账的关系。下面是在Neo4J中构建转移关系的Cypher查询。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="4228" class="jy jz ht ju b fv ka kb l kc kd">MATCH (ac1:Account {key: $ckey}),(ac2:Account {key: $dkey}) <br/>MERGE (ac1)-[rel:TRANSFER_TO]-&gt;(ac2)")</span></pre><p id="3679" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">下面显示了传递图的可视化。每个红色节点代表一个Solana帐户，有向链接是transfer_to关系。</p><figure class="jp jq jr js fq kj fe ff paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="fe ff ki"><img src="../Images/780834842eeeb6fd1acea0eaee02a5ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*82GFVhBFT0tWyGua-SHdIw.png"/></div></div></figure><p id="5ebe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">图中显示了几个繁忙的集群，其中的帐户相互传输。</p><div class="jp jq jr js fq ab cb"><figure class="kq kj kr ks kt ku kv paragraph-image"><img src="../Images/7ca31f1d26f64cf0ca002b98464cdbd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*rRRWyexTUFsTVnzrJcGhww.png"/></figure><figure class="kq kj kw ks kt ku kv paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/ae07f589217b96296974372aa10dd931.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*7OsZSXaeNcemLmt-8rLl0g.png"/></div></figure></div><p id="69bf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">图形数据库可以实现许多分析，例如查询哪些帐户是最大的接收者。我们可以很容易地追踪到频繁转账到某个可疑账户的账户群。这有助于识别洗钱。</p><p id="7452" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">刮刀的完整代码可以从我的<a class="ae jo" href="https://github.com/iwasnothing/solana_scraper/blob/main/src/main.rs" rel="noopener ugc nofollow" target="_blank"> Git repo </a>下载。</p><blockquote class="kx"><p id="7a34" class="ky kz ht bd la lb lc ld le lf lg jn ek translated">加入Coinmonks <a class="ae jo" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jo" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="3df3" class="lh jz ht bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md dt translated">另外，阅读</h1><ul class=""><li id="7236" class="me mf ht is b it mg ix mh jb mi jf mj jj mk jn ml mm mn mo dt translated"><a class="ae jo" href="https://coincodecap.com/buy-bitcoin-anonymously" rel="noopener ugc nofollow" target="_blank">如何匿名购买比特币</a> | <a class="ae jo" href="https://coincodecap.com/bitcoin-cash-wallets" rel="noopener ugc nofollow" target="_blank">比特币现金钱包</a></li><li id="5691" class="me mf ht is b it mp ix mq jb mr jf ms jj mt jn ml mm mn mo dt translated"><a class="ae jo" href="https://coincodecap.com/wazirx-nft-review" rel="noopener ugc nofollow" target="_blank">瓦济里克斯NFT评论</a>|<a class="ae jo" href="https://coincodecap.com/bitsgap-vs-pionex" rel="noopener ugc nofollow" target="_blank">Bitsgap vs Pionex</a>|<a class="ae jo" href="https://coincodecap.com/tangem-wallet-review" rel="noopener ugc nofollow" target="_blank">Tangem评论</a></li><li id="e12c" class="me mf ht is b it mp ix mq jb mr jf ms jj mt jn ml mm mn mo dt translated"><a class="ae jo" href="https://coincodecap.com/create-a-dapp-on-ethereum-using-solidity" rel="noopener ugc nofollow" target="_blank">如何使用Solidity在以太坊上创建DApp？</a></li><li id="ee5b" class="me mf ht is b it mp ix mq jb mr jf ms jj mt jn ml mm mn mo dt translated"><a class="ae jo" href="https://coincodecap.com/binance-vs-ftx" rel="noopener ugc nofollow" target="_blank">币安vs FTX </a> | <a class="ae jo" href="https://coincodecap.com/solana-wallets" rel="noopener ugc nofollow" target="_blank">最佳(SOL)索拉纳钱包</a></li><li id="b65d" class="me mf ht is b it mp ix mq jb mr jf ms jj mt jn ml mm mn mo dt translated"><a class="ae jo" href="https://coincodecap.com/swap-crypto-on-uniswap" rel="noopener ugc nofollow" target="_blank">如何在Uniswap上交换加密？</a> | <a class="ae jo" href="https://coincodecap.com/a-ads-review" rel="noopener ugc nofollow" target="_blank"> A-Ads评论</a></li></ul></div></div>    
</body>
</html>