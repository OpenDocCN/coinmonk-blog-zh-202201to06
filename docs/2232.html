<html>
<head>
<title>Best technical indicators for Bitcoin from TA-lib</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">来自TA-lib的比特币最佳技术指标</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/best-technical-indicators-for-bitcoin-fromta-lib-fa5518560e?source=collection_archive---------1-----------------------#2022-03-11">https://medium.com/coinmonks/best-technical-indicators-for-bitcoin-fromta-lib-fa5518560e?source=collection_archive---------1-----------------------#2022-03-11</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/30e995adfb6c63ba2818d8cf840f4b59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eYYLBfJpfyzF4U81.jpg"/></div></div></figure><div class=""/><p id="3f15" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">本文由开源项目AI4Finance的核心团队成员Berend Gort &amp; <a class="ae jz" href="https://ai4finance.medium.com/" rel="noopener"> Bruce Yang </a>撰写。这个项目是一个共享金融AI工具的开源社区，是纽约哥伦比亚大学的一部分。GitHub链接:</p><div class="hs ht fm fo hu ka"><a href="https://github.com/AI4Finance-Foundation" rel="noopener  ugc nofollow" target="_blank"><div class="kb ab ej"><div class="kc ab kd cl cj ke"><h2 class="bd if fv z el kf eo ep kg er et id dt translated">ai4金融基金会</h2><div class="kh l"><h3 class="bd b fv z el kf eo ep kg er et ek translated">一个共享金融AI工具的开源社区。FinRL:第一个用于财务强化的开源项目…</h3></div><div class="ki l"><p class="bd b gc z el kf eo ep kg er et ek translated">github.com</p></div></div><div class="kj l"><div class="kk l kl km kn kj ko ia ka"/></div></div></a></div><p id="6336" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">简介</strong></p><p id="3a4f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这个故事是根据我<a class="ae jz" rel="noopener" href="/coinmonks/crypto-feature-importance-for-deep-reinforcement-learning-38416616c2a36-8416616c2a36">以前的文章</a>，总结了我个人的成果:</p><div class="hs ht fm fo hu ka"><a rel="noopener follow" target="_blank" href="/coinmonks/crypto-feature-importance-for-deep-reinforcement-learning-38416616c2a36-8416616c2a36"><div class="kb ab ej"><div class="kc ab kd cl cj ke"><h2 class="bd if fv z el kf eo ep kg er et id dt translated">加密特征对深度强化学习的重要性</h2><div class="kh l"><h3 class="bd b fv z el kf eo ep kg er et ek translated">本文由开源项目AI4Finance的核心团队成员Berend Gort &amp; Bruce Yang撰写。这个…</h3></div><div class="ki l"><p class="bd b gc z el kf eo ep kg er et ek translated">medium.com</p></div></div><div class="kj l"><div class="kp l kl km kn kj ko ia ka"/></div></div></a></div><p id="5318" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">构建了一个流水线，它允许特征重要性测量和用于深度强化学习的神经网络设计。在用我自己的管道工作了一周之后，我们已经从TA-lib(技术指标库)中识别出了最好的特性。</p><p id="6685" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">临时库概述</strong></p><p id="9ee5" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">下面几个数字显示了我们测试的技术指标。我们尚未关注模式识别指标，因为它们需要特别关注。</p><p id="67db" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><a class="ae jz" href="https://mrjbq7.github.io/ta-lib/" rel="noopener ugc nofollow" target="_blank">https://mrjbq7.github.io/ta-lib/</a></p><figure class="kr ks kt ku fq hv fe ff paragraph-image"><div class="fe ff kq"><img src="../Images/7b798c01b755af952833a36292008ef6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*Z3TGnaEoYhVsp2cznE8Y-A.png"/></div></figure><figure class="kr ks kt ku fq hv fe ff paragraph-image"><div class="fe ff kv"><img src="../Images/cddfd26bf9e85f9babca1c1cd84b3fe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*HUM0XrfiKzHADvP40p-5AQ.png"/></div></figure><figure class="kr ks kt ku fq hv fe ff paragraph-image"><div class="fe ff kw"><img src="../Images/d7a17cfb797b1d688736ba5fc5211153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*pKF_4TuC2CQPpP0YUM5dVQ.png"/></div></figure><figure class="kr ks kt ku fq hv fe ff paragraph-image"><div class="fe ff kv"><img src="../Images/644b135bb621867b3593b57b79976382.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*x7N6TYXMfwENeKQzhtgcNg.png"/></div></figure><figure class="kr ks kt ku fq hv fe ff paragraph-image"><div class="fe ff kx"><img src="../Images/39c346b7316ec040e0942872549a466b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*fimyT-VxFOJUDauC2UgPmg.png"/></div></figure><p id="a089" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">将这些特性添加到币安处理器中</strong></p><p id="993c" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">与我的<a class="ae jz" rel="noopener" href="/coinmonks/crypto-feature-importance-for-deep-reinforcement-learning-38416616c2a36-8416616c2a36">上一篇文章</a>中的旧处理器相比，我们更改了类方法<em class="ky"> add_technical_indicators()，</em>第47行。</p><p id="8f42" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我在一个名为<em class="ky">get _ features _ for _ each _ coin()</em>的独立单元格中添加了一个新函数</p><figure class="kr ks kt ku fq hv"><div class="bz el l di"><div class="kz la l"/></div></figure><p id="c9d4" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">该函数现在是从TA-lib下载所有技术指标的特殊函数，看起来像下一个代码片段中的代码。</p><p id="d509" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">请注意，并不是所有的特性都在这里，因为我们已经在TA-lib中的完整技术指标列表上做了一些特性选择。在下一部分，我们将解释我们做了什么。</p><figure class="kr ks kt ku fq hv"><div class="bz el l di"><div class="kz la l"/></div></figure><p id="83fe" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">高相关滤波器</strong></p><p id="3b38" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">高相关性过滤器应用起来非常简单，但为了在目标的可预测性上有良好的表现，它是非常必要的。想象一下，每一个特性都与另一个特性高度相关，甚至<strong class="jd if">完全</strong> <strong class="jd if">相同，你为什么要添加那个特性呢？它包含的信息与您已经拥有的功能几乎相同。</strong></p><p id="45b7" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这就是为什么我们需要删除这些高度相关的特征。</p><figure class="kr ks kt ku fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff lb"><img src="../Images/d1cf870225124ff12fd60893cf06d8a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uVrlIjFZCUT_fnRzfy2qMQ.png"/></div></div><figcaption class="lc ld fg fe ff le lf bd b be z ek">Example of current DF with 40 features</figcaption></figure><p id="acc4" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">首先，我们从原始数据中再次删除目标</p><pre class="kr ks kt ku fq lg lh li lj aw lk dt"><span id="f82f" class="ll lm ie lh b fv ln lo l lp lq">X = data.drop(['label_barrier'], axis = 1)</span><span id="0fba" class="ll lm ie lh b fv lr lo l lp lq">y = np.squeeze(data[['label_barrier']].values).astype(int)</span></pre><p id="c004" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后我们绘制一张热图:</p><figure class="kr ks kt ku fq hv"><div class="bz el l di"><div class="kz la l"/></div></figure><p id="0a77" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">结果如下所示:</p><figure class="kr ks kt ku fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff ls"><img src="../Images/56315bf8c81799828dcd8cca31c9321c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sgB4f34OLZtcMKHYPXCS2Q.png"/></div></div><figcaption class="lc ld fg fe ff le lf bd b be z ek">Crypto features heatmap</figcaption></figure><p id="6352" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在这个图中，首先看一下对角线轴。这里每种颜色对应完全相关，或1。也就是说，例如，<em class="ky">打开</em>特征与<em class="ky">打开</em>特征本身完全相关，因为它们包含完全相同的信息。</p><p id="83b3" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">同样，注意负相关(红色)也很重要；例如，特征<em class="ky"> minus_di </em>与<em class="ky"> macd完全负相关。</em>因此，我们可以去掉两者中的任何一个。</p><p id="2763" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，假设我们想要丢弃所有相关性(正或负)高于x的要素。我们可以通过首先计算相关性矩阵来实现:</p><pre class="kr ks kt ku fq lg lh li lj aw lk dt"><span id="60cf" class="ll lm ie lh b fv ln lo l lp lq">corr_matrix = pd.DataFrame(X).corr().abs()</span></pre><p id="78f8" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">注意，相关矩阵将围绕对角线镜像，所有对角线分量都等于1。因此，无论我们选择相关矩阵的上三角还是下三角部分，对角元素都不应包括在内。因此，我们选择了上三角形。下面的代码可以做到这一点:</p><pre class="kr ks kt ku fq lg lh li lj aw lk dt"><span id="cb32" class="ll lm ie lh b fv ln lo l lp lq">upper_tri = corr_matrix.where(np.triu(np.ones(corr_matrix.shape),k=1).astype(np.bool))</span></pre><p id="72a0" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在我们得到了上三角矩阵，它包含了丢弃某些高度相关的特征所需的剩余信息。因此，我们选择绝对相关性大于0.95的列，并制作一个名为d<em class="ky">ropping _ these _ features:</em>的列列表</p><pre class="kr ks kt ku fq lg lh li lj aw lk dt"><span id="25f3" class="ll lm ie lh b fv ln lo l lp lq"># So we are selecting the columns which are having absolute correlation greater than 0.95 and making a list of those columns named 'dropping_these_features'.</span><span id="881e" class="ll lm ie lh b fv lr lo l lp lq">dropping_these_features = [column for column in upper_tri.columns if any(upper_tri[column] &gt; 0.9)]</span></pre><p id="c3f2" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">结果如下所示:</p><figure class="kr ks kt ku fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff lt"><img src="../Images/2e516bb198f177bac2d23873e52267f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w_k5xemsxpfvZb1u0Tok6g.png"/></div></div></figure><p id="d444" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后我们有不高度相关的特征，因此包含有价值的信息。我们现在可以开始这些功能的培训过程。</p><p id="e0e1" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">神经网络设计</strong></p><p id="4e81" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">经过反复试验，我们最终得到了下面的神经网络。相比原来的那个<a class="ae jz" rel="noopener" href="/coinmonks/crypto-feature-importance-for-deep-reinforcement-learning-38416616c2a36-8416616c2a36">(见我之前的文章)</a>。</p><p id="5fd6" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">主要区别是更复杂(额外的层)、更高的状态维度(29对应于特性的数量)以及最重要的:辍学。</p><p id="5a6d" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">退出通过正则化防止过度拟合。在下面的视频中有详细的解释:</p><figure class="kr ks kt ku fq hv"><div class="bz el l di"><div class="lu la l"/></div></figure><figure class="kr ks kt ku fq hv"><div class="bz el l di"><div class="kz la l"/></div></figure><p id="961d" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">最终的训练结果如下所示，在测试集上达到75%的准确率:</p><pre class="kr ks kt ku fq lg lh li lj aw lk dt"><span id="8012" class="ll lm ie lh b fv ln lo l lp lq"><br/>Train Fold/Epoch: 0/350 [0/16475 (0%)] train_loss: 0.178466 Train Fold/Epoch: 0/350 [1600/16475 (10%)] train_loss: 0.039930 Train Fold/Epoch: 0/350 [3200/16475 (19%)] train_loss: 0.301063 Train Fold/Epoch: 0/350 [4800/16475 (29%)] train_loss: 0.026820 Train Fold/Epoch: 0/350 [6400/16475 (39%)] train_loss: 0.314050 Train Fold/Epoch: 0/350 [8000/16475 (49%)] train_loss: 0.080817 Train Fold/Epoch: 0/350 [9600/16475 (58%)] train_loss: 0.167541 Train Fold/Epoch: 0/350 [11200/16475 (68%)] train_loss: 0.329580 Train Fold/Epoch: 0/350 [12800/16475 (78%)] train_loss: 0.083508 Train Fold/Epoch: 0/350 [14400/16475 (87%)] train_loss: 0.258400 Train Fold/Epoch: 0/350 [16000/16475 (97%)] train_loss: 0.171635  Train set for fold 0: Average train_loss: 0.0000, Accuracy: 15160/16475 (92.01821%) Test set for fold 0:  Average test_loss:  0.9236, Accuracy: 3103/4119 (75.33382%)</span></pre><p id="2c7c" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">特征重要性</strong></p><p id="cd78" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">基于我在<a class="ae jz" rel="noopener" href="/coinmonks/crypto-feature-importance-for-deep-reinforcement-learning-38416616c2a36-8416616c2a36">上一篇文章</a>中描述的方法，下面列出了每个特性重要性的结果:</p><figure class="kr ks kt ku fq hv fe ff paragraph-image"><div class="fe ff lv"><img src="../Images/14e89a2cc87e3ef024752029e48ece60.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*tYk2HWoMyFIcGIJrd1Nb0A.png"/></div></figure><p id="f4fd" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">新的特性对重要性有巨大的影响，因为错误大大增加了。如果你想要一个更小的模型，你可以从这个重要性列表中去掉最后10个特性，然后重新训练。</p><p id="9b7d" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">结论</strong></p><p id="2e92" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这些新功能，以及新的神经网络，我们将价格方向的可预测性从38%提高到75%；一个很好的改进。现在是时候在我们的DRL实施这一切了！</p><p id="b833" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="ky">感谢寻根“来自TA-lib的比特币最佳技术指标”！</em></p><p id="1f2b" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="ky"> ~贝伦德&amp;布鲁斯</em></p></div></div>    
</body>
</html>