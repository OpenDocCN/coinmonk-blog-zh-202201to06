<html>
<head>
<title>Triangular Arbitrage With Crypto DEX’s: Part One</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带加密指数的三角套利:第一部分</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/triangular-arbitrage-with-crypto-dexs-part-one-add36b136bf1?source=collection_archive---------0-----------------------#2022-04-19">https://medium.com/coinmonks/triangular-arbitrage-with-crypto-dexs-part-one-add36b136bf1?source=collection_archive---------0-----------------------#2022-04-19</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="23e1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">建造一个套利机器人比他们告诉你的要难</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/f66c39cae68896d28878b43abbb2fc08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CPikP2jleG4oSBTj"/></div></div><figcaption class="ka kb fg fe ff kc kd bd b be z ek">Photo by <a class="ae ke" href="https://unsplash.com/@cdd20?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">愚木混株 cdd20</a> on <a class="ae ke" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="03fe" class="kf kg ht bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">简介—印钞机能正常工作吗？</h1><p id="dfce" class="pw-post-body-paragraph iq ir ht is b it ld iv iw ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hm dt translated">套利是利用市场上资产价格差异的做法。由于货币价格的波动，套利在外汇交易中已经使用了很长时间。Investopedia对此有一个很好的介绍——<a class="ae ke" href="https://www.investopedia.com/terms/a/arbitrage.asp" rel="noopener ugc nofollow" target="_blank">https://www.investopedia.com/terms/a/arbitrage.asp</a></p><p id="7ad5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">加密市场中也存在套利机会。事实上，套利，尤其是在分散的交易所，是受到鼓励的。套利是市场对其定价的低效，套利通过将资产带回到其预期水平而使这些价格再次“有效”。</p><h1 id="9a95" class="kf kg ht bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">套利的类型</h1><h2 id="488e" class="li kg ht bd kh lj lk ll kl lm ln lo kp jb lp lq kt jf lr ls kx jj lt lu lb lv dt translated">外汇Arb</h2><p id="28fd" class="pw-post-body-paragraph iq ir ht is b it ld iv iw ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hm dt translated">套利的一个例子是在交易所之间。例如，我可以在比特币基地Pro上购买1BTC英镑，假设我在比特币基地上以32，051.44英镑购买1个比特币，我将我的1个比特币转移到币安，并在那里以32，067.76英镑出售。我赚了16.32英镑。这里有很多因素，比如转会费、滑点、差价等等，但这是基本原则。</p><h2 id="c2af" class="li kg ht bd kh lj lk ll kl lm ln lo kp jb lp lq kt jf lr ls kx jj lt lu lb lv dt translated">三角形Arb</h2><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff lw"><img src="../Images/71b464c90457c718a1d574a63f36a1d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JkW6Phl3sHt2HNpGyEY4Og.png"/></div></div><figcaption class="ka kb fg fe ff kc kd bd b be z ek">Example of Triangular Arbitrage (Image By Author)</figcaption></figure><p id="61d1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">三角套利是一种进行3次或3次以上互换来获利的方法。上面的例子说明，假设我们从1个BTC开始，我们将它换成14个ETH。我们以45，000 USDC的价格出售14个ETH，然后用它来购买1.082 BTC。这产生了0.82 BTC的利润。</p><h1 id="6d68" class="kf kg ht bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">这个计划</h1><p id="2136" class="pw-post-body-paragraph iq ir ht is b it ld iv iw ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hm dt translated">我真的很喜欢ALGO——我不是一个骗子或什么的，不是说要买一些，但我只是觉得它真的很容易使用，便宜又快捷。我的计划是使用tiny man(Algorand上的大型DEX)来看看我是否能找到任何三角机会。流程看起来有点像这样。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/9e11780f11aa0426ffa57f6d8471d160.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*FyDu6UY7l-1Kxf7dwMGTjQ.png"/></div><figcaption class="ka kb fg fe ff kc kd bd b be z ek">Flow of Tinyman Arb Bot</figcaption></figure><p id="0fca" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我不想一直得到所有可用资产排列的交换报价。大约有1200种不同的资产组合(准确地说是1224936种)。如果我只是对每个排列进行暴力破解，那将会有超过一百万次的网络调用，这将会非常慢。我想计算每笔交易的所有报价，并创建一个如下所示的矩阵。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/91b3be81cad510c051de9fc61ce0be30.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*8QsvdbhYQ-y0K3hv0AVBUQ.png"/></div><figcaption class="ka kb fg fe ff kc kd bd b be z ek">Example Matrix (Image by Author)</figcaption></figure><p id="b316" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">其中y轴是要交换的资产，x轴是要接收的资产。如下所示，如果你把ALGO作为A1，把USDC作为A2，那么1个ALGO对应0.751个USDC。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/d5da6b2b8ff711657812268c151cfb28.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*1rpkdMbteSLm0JxT6BMowA.png"/></div><figcaption class="ka kb fg fe ff kc kd bd b be z ek">Matrix Quotes (Image by Author)</figcaption></figure><p id="a1d3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这解决了必须为路径获取多个引号的一些问题，并允许在矩阵中快速查找。我只是将互换汇率乘以赌注，即10个算法到USDC给了我10*0.751 = 7.51 USDC。</p><p id="f12b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我实际上设法让这个工作，缺点是，我运行了2天，没有可能的套利机会。有些接近了，请为下面的关闭互换默哀一分钟——这是使用20 ALGO作为输入。</p><pre class="jp jq jr js fq ma mb mc md aw me dt"><span id="c84b" class="li kg ht mb b fv mf mg l mh mi">Path (0, 31566704, 312769) Close to Profit!</span><span id="26a8" class="li kg ht mb b fv mj mg l mh mi">First Swap Quote: SwapQuote(swap_type='fixed-input', amount_in=ALGO('20'), amount_out=USDC('14.394919'), swap_fees=ALGO('0.06'), slippage=0.01)</span><span id="2e0d" class="li kg ht mb b fv mj mg l mh mi">Second Swap Quote: SwapQuote(swap_type='fixed-input', amount_in=USDC('14.25097'), amount_out=USDt('14.260552'), swap_fees=USDC('0.042752'), slippage=0.01)</span><span id="1cb7" class="li kg ht mb b fv mj mg l mh mi">Third Swap Quote: SwapQuote(swap_type='fixed-input', amount_in=USDt('14.117947'), amount_out=ALGO('19.402954'), swap_fees=USDt('0.042353'), slippage=0.01)</span><span id="dc2d" class="li kg ht mb b fv mj mg l mh mi">Final Amount Of ALGO('19.208925')</span><span id="1a36" class="li kg ht mb b fv mj mg l mh mi">--------------------------------------------------------------------</span><span id="da35" class="li kg ht mb b fv mj mg l mh mi">Path (0, 226701642, 404044168) Close to Profit!</span><span id="87fa" class="li kg ht mb b fv mj mg l mh mi">First Swap Quote: SwapQuote(swap_type='fixed-input', amount_in=ALGO('20'), amount_out=YLDY('6096.563343'), swap_fees=ALGO('0.06'), slippage=0.01)</span><span id="4372" class="li kg ht mb b fv mj mg l mh mi">Second Swap Quote: SwapQuote(swap_type='fixed-input', amount_in=YLDY('6035.59771'), amount_out=Nekos('1242639.8739'), swap_fees=YLDY('18.106793'), slippage=0.01)</span><span id="2733" class="li kg ht mb b fv mj mg l mh mi">Third Swap Quote: SwapQuote(swap_type='fixed-input', amount_in=Nekos('1230213.4752'), amount_out=ALGO('19.212889'), swap_fees=Nekos('3690.6404'), slippage=0.01)</span><span id="116d" class="li kg ht mb b fv mj mg l mh mi">Final Amount Of ALGO('19.020761')</span></pre><p id="2479" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">你可能已经注意到了，路径是数字，而不是ALGO-USDC等。这是因为大多数DEX使用ASA ID作为其池标识符。这些只是资产id(<a class="ae ke" href="https://developer.algorand.org/docs/get-details/asa/" rel="noopener ugc nofollow" target="_blank">https://developer.algorand.org/docs/get-details/asa/</a>)</p></div><div class="ab cl mk ml hb mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hm hn ho hp hq"><h1 id="9536" class="kf kg ht bd kh ki mr kk kl km ms ko kp kq mt ks kt ku mu kw kx ky mv la lb lc dt translated">问题</h1><p id="25dc" class="pw-post-body-paragraph iq ir ht is b it ld iv iw ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hm dt translated">这个概念证明充满了问题，我把自己困在一个角落里，没有意识到这有多困难，以及需要考虑多少因素。</p><ul class=""><li id="7d1a" class="mw mx ht is b it iu ix iy jb my jf mz jj na jn nb nc nd ne dt translated">这很慢，迭代数百万个排列并首先获得报价需要时间，更不用说对相同的互换进行多次矩阵查找了</li><li id="20e4" class="mw mx ht is b it nf ix ng jb nh jf ni jj nj jn nb nc nd ne dt translated">流动性会扭曲事物。如果我得到一个用1 goBTC换USDC的报价，由于美元价值的差异，资金池中可能没有足够的流动性来支持它。也就是说，1 goBTC(价值40，000美元)将只兑换200 USDC(价值200美元)，因为池中没有足够的USDC来全部兑换，这扭曲了矩阵中的报价</li><li id="c327" class="mw mx ht is b it nf ix ng jb nh jf ni jj nj jn nb nc nd ne dt translated">包括其他交换将意味着必须使用3D矩阵，这很好，但会增加复杂性，并且查询会更加困难。</li><li id="9e5c" class="mw mx ht is b it nf ix ng jb nh jf ni jj nj jn nb nc nd ne dt translated">我只做了长度为3的排列，增加这个长度会使性能更差，但我想看看5+交换的可能性——费用和滑点会对此产生更大的影响，但这一切都很有趣！</li></ul><h1 id="1124" class="kf kg ht bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">新方法</h1><p id="075a" class="pw-post-body-paragraph iq ir ht is b it ld iv iw ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hm dt translated">代码有效，但它找不到任何有利可图的交易，并且受到性能问题的困扰。</p><p id="6bf0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我不得不进行彻底的重构，以支持多个交易所，并提高速度，否则永远不会盈利。</p><p id="f34e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我将在第2部分继续这个话题！</p></div><div class="ab cl mk ml hb mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hm hn ho hp hq"><p id="8640" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你对代码感兴趣，请欣赏我最终设法开始用这个机器人获得一些不错的利润。在这种情况下，我会把自己放在第一位，不会发布代码，因为我知道这将使机会更难利用。</p><blockquote class="nk"><p id="f5b9" class="nl nm ht bd nn no np nq nr ns nt jn ek translated"><em class="nu">加入Coinmonks </em> <a class="ae ke" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank"> <em class="nu">电报频道</em> </a> <em class="nu">和</em> <a class="ae ke" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> <em class="nu"> Youtube频道</em> </a> <em class="nu">了解加密交易和投资</em></p></blockquote><h1 id="dbae" class="kf kg ht bd kh ki kj kk kl km kn ko kp kq nv ks kt ku nw kw kx ky nx la lb lc dt translated">另外，阅读</h1><ul class=""><li id="2834" class="mw mx ht is b it ld ix le jb ny jf nz jj oa jn nb nc nd ne dt translated"><a class="ae ke" href="https://coincodecap.com/bookmap-review-2021-best-trading-software" rel="noopener ugc nofollow" target="_blank"> Bookmap评论</a> | <a class="ae ke" href="https://coincodecap.com/crypto-exchange-usa" rel="noopener ugc nofollow" target="_blank">美国5大最佳加密交易所</a></li><li id="0977" class="mw mx ht is b it nf ix ng jb nh jf ni jj nj jn nb nc nd ne dt translated">最佳加密<a class="ae ke" rel="noopener" href="/coinmonks/hardware-wallets-dfa1211730c6">硬件钱包</a> | <a class="ae ke" rel="noopener" href="/coinmonks/bitbns-review-38256a07e161"> Bitbns评论</a></li><li id="5952" class="mw mx ht is b it nf ix ng jb nh jf ni jj nj jn nb nc nd ne dt translated"><a class="ae ke" href="https://coincodecap.com/crypto-exchange-in-singapore" rel="noopener ugc nofollow" target="_blank">新加坡十大最佳加密交易所</a> | <a class="ae ke" href="https://coincodecap.com/buy-axs-token" rel="noopener ugc nofollow" target="_blank">收购AXS </a></li><li id="c56d" class="mw mx ht is b it nf ix ng jb nh jf ni jj nj jn nb nc nd ne dt translated"><a class="ae ke" href="https://coincodecap.com/red-dog-casino-review" rel="noopener ugc nofollow" target="_blank">红狗赌场评论</a> | <a class="ae ke" href="https://coincodecap.com/swyftx-review" rel="noopener ugc nofollow" target="_blank"> Swyftx评论</a> | <a class="ae ke" href="https://coincodecap.com/coingate-review" rel="noopener ugc nofollow" target="_blank"> CoinGate评论</a></li><li id="3016" class="mw mx ht is b it nf ix ng jb nh jf ni jj nj jn nb nc nd ne dt translated"><a class="ae ke" href="https://coincodecap.com/best-crypto-to-invest-in-india-in-2021" rel="noopener ugc nofollow" target="_blank">投资印度的最佳加密软件</a>|<a class="ae ke" href="https://coincodecap.com/wazirx-p2p" rel="noopener ugc nofollow" target="_blank">WazirX P2P</a>|<a class="ae ke" href="https://coincodecap.com/hi-dollar-review" rel="noopener ugc nofollow" target="_blank">Hi Dollar Review</a></li><li id="f9fc" class="mw mx ht is b it nf ix ng jb nh jf ni jj nj jn nb nc nd ne dt translated"><a class="ae ke" href="https://coincodecap.com/5-best-crypto-trading-bots-in-canada" rel="noopener ugc nofollow" target="_blank">加拿大最佳加密交易机器人</a> | <a class="ae ke" href="https://coincodecap.com/kucoin-review" rel="noopener ugc nofollow" target="_blank">库币评论</a></li></ul></div></div>    
</body>
</html>