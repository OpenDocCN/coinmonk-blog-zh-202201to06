<html>
<head>
<title>Crypto Market Forecast: StatsModels VARMAX Method</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">加密市场预测:StatsModels VARMAX方法</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/crypto-market-forecast-statsmodels-varmax-method-9c2aa07145f4?source=collection_archive---------10-----------------------#2022-03-24">https://medium.com/coinmonks/crypto-market-forecast-statsmodels-varmax-method-9c2aa07145f4?source=collection_archive---------10-----------------------#2022-03-24</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="15fc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这是对广阔的价格行为预测模型的一个小小的贡献，谢天谢地，这个模型已经存在了足够长的时间，足以让它保持如此巨大的价值。我希望这能带来一些启示，如果不是只有一个的话，至少在VARMAX领域，预测输出，或者只是陶醉于我的鸡毛蒜皮的编码。不管你继续阅读的原因是什么，你至少会看到我应用前瞻函数来模拟一个加密货币样本的预测与观察价格行为。</p><p id="6d73" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">可以在这里看到代码:[<a class="ae jo" href="https://www.kaggle.com/code/dascient/crypto-forecast-using-statsmodels-varmax" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/code/da scient/crypto-forecast-using-stats models-varmax</a>]</p><p id="ca67" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我将用更少甚至为零的幽默来开始剩下的部分:</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="4724" class="jy jz ht ju b fv ka kb l kc kd"># packages<br/>import numpy as np <em class="ke"># linear algebra</em><br/>import pandas as pd <em class="ke"># data processing &amp; cdv</em></span></pre><p id="c426" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们来看看最常见的货币，比特币。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="7f9c" class="jy jz ht ju b fv ka kb l kc kd"><em class="ke"># bring in data</em><br/>df = pd.read_csv('/kaggle/input/all-crypto-currencies/crypto-markets.csv')<br/><br/><em class="ke"># isolate BTC</em><br/>df = df.loc[df.symbol == 'BTC']<br/>df.head()</span></pre><figure class="jp jq jr js fq kg fe ff paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="fe ff kf"><img src="../Images/bbae3c617bf5e7900c2a4e8b82eba389.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ffdnh3niVQx6Tji53_SpA.png"/></div></div><figcaption class="kn ko fg fe ff kp kq bd b be z ek">BTC Price Action 2013, April/May</figcaption></figure><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="6cf3" class="jy jz ht ju b fv ka kb l kc kd"># plot<br/>df.set_index('date')['close'].tail(500).plot(figsize=(15,4), title='BTC - close')</span></pre><figure class="jp jq jr js fq kg fe ff paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="fe ff kr"><img src="../Images/bd6b9c6e186506b005b0ec69732ded35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MdVcs4vw6ZWo8pG1pFAu3A.png"/></div></div><figcaption class="kn ko fg fe ff kp kq bd b be z ek">Close Price 2017–2018</figcaption></figure><p id="4b6b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用sklearn MinMaxScaler和/或MaxAbsScaler缩放数据。下面的单元格也创建了“训练”和“测试”数据帧。“训练”包含模型要解释的观察数据。“测试”是用来预测模型的观察数据。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="dfb6" class="jy jz ht ju b fv ka kb l kc kd"><em class="ke"># Use Scikit-learn to transform with maximum absolute scaling</em><br/>from sklearn.preprocessing import MinMaxScaler,MaxAbsScaler<br/><br/>scaled_df = df.set_index('date')[['open','high','low','close']]<br/><br/>scaler = MaxAbsScaler()<br/>scaler.fit(scaled_df)<br/>scaled = scaler.transform(scaled_df)<br/>scaled_df = pd.DataFrame(scaled_df, columns=scaled_df.columns)<br/><br/><em class="ke"># use first 1000 days as train</em><br/>train = scaled_df[:1000]<br/><br/><em class="ke"># simulation window</em><br/>window = 100 <em class="ke"># days look ahead</em><br/>test = scaled_df[1000:1000+window]</span></pre><figure class="jp jq jr js fq kg fe ff paragraph-image"><div class="fe ff ks"><img src="../Images/e2da378cbac224746ac3a1e766afc16f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*5cEfvhWzKxz_G2G3gLoGkA.png"/></div><figcaption class="kn ko fg fe ff kp kq bd b be z ek">train.tail()</figcaption></figure><figure class="jp jq jr js fq kg fe ff paragraph-image"><div class="fe ff kt"><img src="../Images/5790281f3e0a8b546f15ba542404d8fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*4i44mDcORKiTkQ_DauQ3fQ.png"/></div><figcaption class="kn ko fg fe ff kp kq bd b be z ek">test.head()</figcaption></figure><p id="9093" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">启动VARMAX建模</strong></p><p id="406d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">以及每个变量[o，h，l，c]的输出模型摘要。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="0c46" class="jy jz ht ju b fv ka kb l kc kd"><em class="ke"># VARMA example</em><br/>from statsmodels.tsa.statespace.varmax import VARMAX<br/><br/><em class="ke"># contrived dataset</em><br/>data = train[['open','high','low','close']]<br/><em class="ke"># fit model</em><br/>model = VARMAX(data, freq = 'D', order=(1,1), seasonal_order=(0, 0, 0, 0),<br/>                mle_regression = True,<br/>                filter_concentrated = True)<br/>model_fit = model.fit(disp=True)<br/><br/><em class="ke"># make prediction</em><br/>yhat = model_fit.predict(len(data), len(data))</span></pre><figure class="jp jq jr js fq kg fe ff paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="fe ff ku"><img src="../Images/03cbd7fd619880095018af37d5412266.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hoBfrc9wMr7wzTZMhGLy_g.png"/></div></div><figcaption class="kn ko fg fe ff kp kq bd b be z ek">model_fit.summary() [0]</figcaption></figure><figure class="jp jq jr js fq kg fe ff paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="fe ff kv"><img src="../Images/725b3d227886d149b9344185bdfd3f9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vk-Nj9jKkTv8b6FGMVpjPA.png"/></div></div><figcaption class="kn ko fg fe ff kp kq bd b be z ek">model_fit.summary() [1]</figcaption></figure><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="c17b" class="jy jz ht ju b fv ka kb l kc kd"><em class="ke"># simulate prediction</em><br/>model_fit.plot_diagnostics(3,figsize=(20,5))</span></pre><figure class="jp jq jr js fq kg fe ff paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="fe ff kw"><img src="../Images/bf417e0687eca98675e616b0d91bb598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dpf69i2hOSkM_QyGyQGlBQ.png"/></div></div></figure><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="5f94" class="jy jz ht ju b fv ka kb l kc kd"><em class="ke"># plot prediction vs observed</em><br/>pred = pd.DataFrame()<br/>pred['prediction'] = model_fit.simulate(window).reset_index(drop=True).close<br/>pred['observed'] = test.reset_index(drop=True).close<br/>pred.plot(figsize=(20,5),title='prediction vs observed',color=['blue','black'],style=['--','-'])</span></pre><figure class="jp jq jr js fq kg fe ff paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="fe ff kx"><img src="../Images/bb25c5993a44d45606e56c1bba7b07d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_3t_OSjdhwdJrNDdc_tkYA.png"/></div></div></figure><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="fd99" class="jy jz ht ju b fv ka kb l kc kd"># plot prediction - observed<br/>pred['prediction - observed'] = pred['prediction'] - pred['observed']<br/>pred.plot(figsize=(20,5),title='forecast error',color=['blue','black','green'],style=['--','-',':'])</span></pre><figure class="jp jq jr js fq kg fe ff paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="fe ff ky"><img src="../Images/2a3ec1a58fc21f85856850bc7afb497b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JPLNVBJ8ryEWnXW07XI64A.png"/></div></div></figure><p id="499a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">查看上面的结果，我发现不管训练数据如何，运行VARMAX预测器都会生成随机预测。这部分是由于模型参数中随机产生的因素，仍然可以探索。未来的工作包括VARMAX模型，根据实时价格行为数据生成交易信号。</p><p id="2c9c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">请随意对我的项目/存储库进行评价、评论、观察甚至审查/批评:</p><div class="kz la fm fo lb lc"><a href="https://github.com/DaScient/SuperTrendTradingBot" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab ej"><div class="le ab lf cl cj lg"><h2 class="bd hu fv z el lh eo ep li er et hs dt translated">GitHub-DaScient/SuperTrendTradingBot:一个DaScient Capital，LP专有项目&amp;完全…</h2><div class="lj l"><h3 class="bd b fv z el lh eo ep li er et ek translated">一个资金短缺、LP专有的项目&amp;超级趋势指标在加密货币上的完全自主应用…</h3></div><div class="lk l"><p class="bd b gc z el lh eo ep li er et ek translated">github.com</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq kl lc"/></div></div></a></div><div class="kz la fm fo lb lc"><a href="https://www.kaggle.com/code/dascient/daily-crypto-buy-sell-decision-maker" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab ej"><div class="le ab lf cl cj lg"><h2 class="bd hu fv z el lh eo ep li er et hs dt translated">每日加密买/卖决策者</h2><div class="lj l"><h3 class="bd b fv z el lh eo ep li er et ek translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自无附加数据源的数据</h3></div><div class="lk l"><p class="bd b gc z el lh eo ep li er et ek translated">www.kaggle.com</p></div></div><div class="ll l"><div class="lr l ln lo lp ll lq kl lc"/></div></div></a></div><p id="8700" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我的资历和其他贡献可以在我的LinkedIn个人资料中得到验证:</p><p id="ff57" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">https://www.linkedin.com/in/dontadaya</p><div class="kz la fm fo lb lc"><a href="https://www.DaScient.com" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab ej"><div class="le ab lf cl cj lg"><h2 class="bd hu fv z el lh eo ep li er et hs dt translated">DaScient有限责任公司</h2><div class="lj l"><h3 class="bd b fv z el lh eo ep li er et ek translated">快速服务-行业和地面水平分析，可视化和企业介绍，软件开发和人工智能…</h3></div><div class="lk l"><p class="bd b gc z el lh eo ep li er et ek translated">www.dascient.com</p></div></div><div class="ll l"><div class="ls l ln lo lp ll lq kl lc"/></div></div></a></div><div class="kz la fm fo lb lc"><a href="https://www.DaScientCapital.us" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab ej"><div class="le ab lf cl cj lg"><h2 class="bd hu fv z el lh eo ep li er et hs dt translated">DaScient资本集团</h2><div class="lj l"><h3 class="bd b fv z el lh eo ep li er et ek translated">Don D.M. Tadaya是公认的获奖数学家、首席数据科学家和统计研究分析师…</h3></div><div class="lk l"><p class="bd b gc z el lh eo ep li er et ek translated">www.dascientcapital.us</p></div></div><div class="ll l"><div class="lt l ln lo lp ll lq kl lc"/></div></div></a></div><blockquote class="lu"><p id="9060" class="lv lw ht bd lx ly lz ma mb mc md jn ek translated">谢谢大家！</p><p id="f234" class="lv lw ht bd lx ly me mf mg mh mi jn ek translated">加入Coinmonks <a class="ae jo" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jo" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="17d4" class="mj jz ht bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf dt translated">另外，阅读</h1><ul class=""><li id="2216" class="ng nh ht is b it ni ix nj jb nk jf nl jj nm jn nn no np nq dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/3commas-review-an-excellent-crypto-trading-bot-2020-1313a58bec92">3商业评论</a> | <a class="ae jo" href="https://coincodecap.com/pionex-review-exchange-with-crypto-trading-bot" rel="noopener ugc nofollow" target="_blank"> Pionex评论</a> | <a class="ae jo" rel="noopener" href="/coinmonks/coinrule-review-2021-a-beginner-friendly-crypto-trading-bot-daf0504848ba"> Coinrule评论</a></li><li id="306e" class="ng nh ht is b it nr ix ns jb nt jf nu jj nv jn nn no np nq dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/ledger-vs-ngrave-zero-7e40f0c1d694">莱杰vs n rave</a>|<a class="ae jo" rel="noopener" href="/coinmonks/ledger-nano-s-vs-x-battery-hardware-price-storage-59a6663fe3b0">莱杰nano s vs x </a> | <a class="ae jo" rel="noopener" href="/coinmonks/binance-review-ee10d3bf3b6e">币安评论</a></li><li id="b8ee" class="ng nh ht is b it nr ix ns jb nt jf nu jj nv jn nn no np nq dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/bybit-exchange-review-dbd570019b71"> Bybit Exchange审查</a> | <a class="ae jo" href="https://coincodecap.com/bityard-reivew" rel="noopener ugc nofollow" target="_blank"> Bityard审查</a> | <a class="ae jo" href="https://coincodecap.com/jet-bot-review" rel="noopener ugc nofollow" target="_blank"> Jet-Bot审查</a></li><li id="99cb" class="ng nh ht is b it nr ix ns jb nt jf nu jj nv jn nn no np nq dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/3commas-vs-pionex-vs-cryptohopper-best-crypto-bot-6a98d2baa203">3 commas vs crypto hopper</a>|<a class="ae jo" rel="noopener" href="/coinmonks/earn-crypto-interest-b10b810fdda3">赚取加密利息</a></li><li id="03fa" class="ng nh ht is b it nr ix ns jb nt jf nu jj nv jn nn no np nq dt translated">最好的比特币<a class="ae jo" rel="noopener" href="/coinmonks/hardware-wallets-dfa1211730c6">硬件钱包</a> | <a class="ae jo" rel="noopener" href="/coinmonks/bitbox02-review-your-swiss-bitcoin-hardware-wallet-c36c88fff29"> BitBox02回顾</a></li><li id="20e0" class="ng nh ht is b it nr ix ns jb nt jf nu jj nv jn nn no np nq dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/blockfi-vs-celsius-vs-hodlnaut-8a1cc8c26630"> BlockFi vs摄氏度</a> | <a class="ae jo" rel="noopener" href="/coinmonks/hodlnaut-review-best-way-to-hodl-is-to-earn-interest-on-your-bitcoin-6658a8c19edf"> Hodlnaut审核</a> | <a class="ae jo" href="https://coincodecap.com/kucoin-review" rel="noopener ugc nofollow" target="_blank"> KuCoin审核</a></li></ul></div></div>    
</body>
</html>