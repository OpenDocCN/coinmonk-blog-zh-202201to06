# 加密货币 101:流动性池和非永久性损失

> 原文：<https://medium.com/coinmonks/crypto-101-liquidity-pools-and-impermanent-loss-feb297ce5fba?source=collection_archive---------1----------------------->

## 似乎每天都有一则新广告宣称，投入流动性可以获得巨额回报。它是如何运作的，有哪些风险？

![](img/68d4b6732ec07196e93c0547ce2424f6.png)

Image: PixTeller

> 如果你还没有计算过，这就不是一个经过计算的风险——纳维德·阿卜杜拉

# 了解加密流动性池

从外部看，加密货币流动性池似乎相当混乱。当然，许多这样的池背后的数学计算可能相当复杂。不过，我相信，如果从基本面入手，过程本身并不难把握。从基本面来看，流动性池正试图实现三大目标:

1.  他们希望通过财务激励来改变投资者的行为。
2.  他们希望收取费用来结算不相关的资产交易。
3.  他们希望维持稳定的资产价格。

这些都是相对简单的问题，但在实践中却非常难以实现。

## 如何修补投资者行为

让我们稍微简化一下。就修改投资者行为而言，这相对容易解释。以银行为例。如果 A 银行为储蓄账户提供 5%的年利率(APR)，而 B 银行提供 10%的年利率，这就是一种财务激励。越高的 APR 激励我把我的储蓄账户从 A 银行转移到 B 银行，因为我会赚更多的钱。

再举个例子，以消费者奖励为例，比如百事可乐。在这里，百事公司正在鼓励人们购买百事产品。每次购买时，他们都可以获得兑换奖励的点数，例如帽子或毛巾。当然，这么小的报酬不太可能导致人们从可口可乐转向百事可乐。然而，它可能会激励那些没有偏好购买百事可乐的人。它还能激励那些已经更喜欢百事可乐的人多买一些。

很直接，对吧？在这两种情况下，如果银行或百事公司想增加行为矫正的可能性，他们所要做的就是增加奖励。就银行而言，也许开立一个新账户并将我所有的钱从 A 银行转移到 B 银行的费用和困难对我来说不值额外的 5% APR。但如果 B 银行的年利率是 75%，我就不会把钱投在那里了。百事也是如此。如果我是可口可乐(Coca-Cola)的粉丝，但百事可乐(Pepsi)给我的价格是每杯 10 美元，我可能会转而喝百事可乐。

## 数字加密货币交易所通过奖励来吸引流动性

加密交易所使用类似的方法来激励投资者的行为。一种激励方式是提供一定比例的交易费。比如，如果你向一家交易所提供流动性，他们将从所有交易中收取流动性费用，并将该费用分配给所有增加流动性的人。费用奖励一般根据你对资金池的相对贡献来分配。例如，如果以太坊(ETH)和 USDT(US Dollar Tether)有一个各有 100 万美元的资金池，您向该资金池各提供 10 万美元，您将收取 10%的流动性费用(您的相对贡献)。

交易所还可以利用本地代币奖励来进一步激励投资者的行为。例如，你可以购买[蛋糕](https://coinmarketcap.com/currencies/pancakeswap/) (PancakeSwap 的原生令牌)或者你可以收到蛋糕作为增加流动性的奖励。这些奖励通常是您从参与活动中获得的基于资产的费用奖励之外的奖励。这就是广告中 500% APR 数字的来源。如果你提供流动性，你可能会从资产回报中获得 4-12%的年利率，而高于这个数字的一切都将来自本地代币发行。如果原生代币有超出流动性回报(一种空洞的回报)的需求，这种方法可能会非常有效。

## 交易不匹配的东西

就结算不相关资产的交易而言，这也相对简单。想象两个农民，农民 A 种植蛇果苹果，农民 B 种植富士苹果。假设蛇果苹果和富士苹果每公斤都值 5 美元。如果农民 A 想和农民 B 交易，这很简单。农民 A 会给农民 B 一公斤蛇果，农民 B 会给农民 A 一公斤藤条。像苹果派一样容易。

现在，假设全国有五十个蛇果和五十个富士苹果种植者。一个有事业心的人(EP)可能会出现，主动帮助农民有效地交易蛇果和富士苹果。对于我们的 EP 来说，一个简单的方法就是创建一个[订单簿](https://www.investopedia.com/terms/o/order-book.asp)。在 A 列，他们写下了所有想交易蛇果苹果的农民。在 B 列，他们写下了所有想交易富士苹果的农民。

因为苹果的价格是相等的，剩下唯一要做的事情就是将 A 列农民想要的苹果数量与 B 列农民想要的苹果数量相匹配(反之亦然)。欧洲议会可以设定提供这项服务的费用，也许就像农民每交易一个苹果。既然只有我们 EP 一家这么做，那就是一个 [*集中*](https://www.investopedia.com/terms/c/centralizedmarket.asp) 蛇果/富士苹果 [*交换*](https://www.investopedia.com/terms/e/exchange.asp) *。*反过来，我们的 EP 已经成为一个收费的 [*做市商*](https://www.investopedia.com/terms/m/marketmaker.asp) 连接蛇果和富士苹果农民之间的交易。

让我们更进一步。如果蛇果和富士在不同的时间收获会怎么样？如果蛇果首先被收获并被带到交易所，我们的 EP 将不会有任何藤条，因为它们还没有被收获。在这种情况下，蛇果苹果在市场上将会是[](https://www.investopedia.com/terms/i/illiquid.asp)**。有很多蛇果，但没有藤条可供交易，因为它们还没有收获。**

**但是，我们的进取者是聪明的！他们知道苹果在不同的时间收获。所以，在他们创建交易所之前，他们买了 1000 公斤蛇果和 1000 公斤富士苹果。现在，无论苹果何时收获，交易所都可以进行交易。就这样，我们的 EP 帮助确保了蛇果和富士的市场是[](https://www.investopedia.com/terms/l/liquidity.asp)**。通过持有这么多苹果，他们手头应该有足够的苹果，以便在农民需要的时候进行交易。****

**当蛇果收获季节到来时，交易所用他们的 1000 公斤富士苹果进行交易。然后，当富士苹果收获季节到来时，交易所就用“多余的”(来自上次收获的)蛇果苹果进行交易，同时“补充”他们的富士苹果商店。在这种情况下，我们 EP 中藤黄和蛇果的比例会随着每个收获季节而变化。但是，这将平衡，只要蛇果和富士的交易量相等，每次收获。**

## **汇集流动性**

**现在，如果没有一个 EP 有足够的苹果来为交易所创造足够的流动性会怎么样？农民要做什么？一个解决方案是，我们的 EP 要求所有 50 个蛇果和所有 50 个富士苹果农从他们的苹果中拿出一小部分，然后集中起来。我们的 EP 仍然收取费用以促进交易，但现在流动性来自苹果农民制造的*流动性池*，而不是来自 EPs 供应。**

**为了激励农民向流动资金池贡献苹果，欧洲议会从交易所的每笔交易中给他们一个百分比。假设农民贡献的苹果数量完全相同。让我们也假设他们都签署了一份合同，将任何费用锁定在一个苹果公司。每次交易时，我们的 EP 会为他们自己收取一个苹果(交易费)，并收取一个苹果(流动费)来平均分配给每个农民(每次交易一个苹果的 1/100)。**

**从事交易的农民仍需支付交易费，但他们将从流动资金费中拿回一部分。T2 的农民不交易 T3，但仍将苹果加入流动资金池，收取一定比例的流动资金费，基本上是免费的。但是，我们来补充一点。如果我们的 EP 拿了一堆苹果作为流动资金池，而不是用它们来促进交易，他们'[从农民那里拉出地毯](https://www.coingecko.com/en/glossary/rug-pulled)并拿走所有的苹果，会怎么样？**

## **分散汇兑差额**

**或者，如果我们的 EP 不断提高他们的交易费用怎么办？或者，如果我们的 EP 开始偏袒一个农民的交易，也许是因为贿赂，或者出于自身利益？在过去，他们能做的不多，尤其是如果我们的 EP 非常富有或强大。但是，假设我们的一个农民发明了一个机器人，可以自动为农民储存苹果*和*运行订单簿。更好的是，我们的工程农民与所有其他农民免费分享这个机器人的计划，所以他们都可以有一份副本。**

**现在农民可以创建一个交易所，完全取消我们的 EP。每个农民可以把他的苹果的[](https://www.techcryption.com/2021/07/12/staking-or-liquidity-pool/)**股份交给他自己的机器人，然后送到交易所。一旦到了那里，机器人就可以同步订单和流动资产池中的苹果供应。没有一个机器人会控制交换，因为他们都必须一起工作，使订单簿工作。换句话说，农民将把对交易所的控制权分散给每个参与者。****

***由于机器人(可能)不关心利润，农民就不必再支付交易费了。但是，他们仍然可以收取流动资金费，以鼓励那些不想交易的农民贡献流动资金。虽然这在原则上听起来很棒，但也有一些风险。如果其中一个机器人出现故障怎么办？或者，如果有人“黑”了机器人，让它们做了不该做的事情，比如给某人苹果却不放进去，那该怎么办？***

***在实践中(类似于上面的例子)，集中式和分散式交换都有各自的优点和缺点。在实践中，对于每一个问题都有(非常)不完善的人力和技术解决方案。只有时间才能证明这些解决方案有多稳健。与此同时，我们必须尽最大努力了解我们现有的系统。***

***到目前为止，我们一直在讨论一个非常简单的双资产单一市场。但是当它变得更复杂时会发生什么呢？好消息是基本面没有改变。然而，如何执行该过程可能会变得非常复杂。我会尽力保持简单。***

## ***很简单，但是很复杂***

***让我们给我们的蛇果/富士市场增加几层。除了苹果，我们再来看看瓦伦西亚橘农和美元。现在，我们有了一个市场，农民们想在这里交易富士苹果、蛇果苹果、巴伦西亚橙子和美元。让我们进一步说，藤条每公斤 5 美元，蛇果每公斤 10 美元，瓦伦西亚每公斤 20 美元。美元(显然)是 1 美元一个。***

***如果是集中交易(CEX)，他们如何在订单簿上这些非常不同的资产之间“平衡”交易？可能最安全和最容易的方法是创建 [*交易对*](https://www.gemini.com/cryptopedia/what-are-cryptocurrency-pairs) 。想法是，他们挑选最稳定的资产(在这种情况下是美元)并分别与蛇果、富士和瓦伦西亚配对。每一对货币都有自己的流动性池。理想情况下，它们在 50/50 分割中始终保持线对的值相等。***

**在这个假设中，假设我们的 CEX 创建了三个分别价值 5000 美元和 5000 美元的富士、蛇果和瓦伦西亚对子。CEX 提供美元流动性，苹果/橙子流动性从农民那里汇集。记住藤条的价格是 5 美元/公斤，蛇果围棋的价格是 10 美元/公斤，巴伦西亚的价格是 20 美元/公斤，价格大概是这样的:**

1.  **美元/富士:5000 美元/5000 美元(1000 公斤，5 美元)**
2.  **美元/蛇果:5000 美元/5000 美元(500 公斤，10 美元)**
3.  **美元/巴伦西亚:5000 美元/5000 美元(250 公斤，20 美元)**
4.  **总计:15000 美元/15000 美元水果/1750 公斤**

**如果一个巴伦西亚农民想要交易富士，交易所将首先用巴伦西亚交易美元，然后用美元交易富士，然后在收取交易和流动性费用后将富士发送给巴伦西亚农民。同样的基本过程也会发生在分散交易(DEX)中，除了农民必须提供货币对的双方:富士农民的富士/美元；蛇果农民的蛇果/美元；巴伦西亚农民的巴伦西亚/美元。**

**所以，让我们来看看当一个农民想用 10 公斤的巴伦西亚换藤条时会发生什么。注意，农民可以选择按*重量*或*价格*(以美元计)交易。在账面上，我们的交易所将:**

1.  **增加 10 公斤巴伦西亚，从巴伦西亚/美元对中减去 200 美元；**
2.  **从富士/美元对中加上 200 美元，减去 40 公斤富士；**
3.  **把 40 公斤藤条交给巴伦西亚的农民。**

**这是这本书现在的样子:**

1.  **美元/富士:5200 美元/4800 美元(960 公斤，每公斤 5 美元)**
2.  **美元/蛇果:5000 美元/5000 美元(500 公斤，每公斤 10 美元)**
3.  **美元/巴伦西亚:4800 美元/5200 美元(260 公斤，每公斤 20 美元)**
4.  **总计:15000 美元/15000 美元/1720 公斤**

**请记住，交换的目标是保持一切对半。但在这里，我们不再有 50/50 的美元/富士对和美元/瓦伦西亚对的平衡。由于美元的价值是稳定的(固定的)，而水果的重量是固定的，所以重新获得平衡的唯一方法是改变美元资产的价格。也就是说，我们的交易所需要提高 Fujis 的价格，降低 Valencias 的价格，直到一切都恢复到 50/50。现在这本书看起来像这样:**

1.  **美元/富士:5200 美元/5200 美元(960 公斤，每公斤 5.416 美元)**
2.  **美元/蛇果:5000 美元/5000 美元(500 公斤，每公斤 10 美元)**
3.  **美元/巴伦西亚:4800 美元/4800 美元(260 公斤，每公斤 18.46 美元)**
4.  **总计:15000 美元/15000 美元/1720 公斤**

**很简单，对吧？但是你看到问题了吗？富士的单价现在高了，瓦伦西亚的单价现在低了。当价格像这样变动时， [*非永久性损失*](https://academy.binance.com/en/articles/impermanent-loss-explained) 就会发生。从最简单的意义上说，非永久性损失是指提供流动性的回报低于资产价值的增值。**

## **这是供给和需求…某种程度上**

**如果交易只发生在一个交易所，这就不是问题。像这样的价格变动将是一个简单的供求问题。但是，当有其他交易所交易相同的商品时，不同交易所的价格可能不同。这些价格差异创造了 [*套利*](https://www.investopedia.com/terms/a/arbitrage.asp) 机会。套利交易利用了这种市场低效率，从财务上激励交易者寻找交易所之间的价格差异。**

**让我们添加第二个交换来看看这看起来像什么:**

## ****瓦伦西亚农民交易所(VFX)** :**

**美元/巴伦西亚:4800 美元/4800 美元(260 公斤，每公斤 18.46 美元)**

## ****套利者的交易所(AX)** :**

**美元/巴伦西亚:5000 美元/5000 美元(250 公斤，每公斤 20 美元)**

**在这里，套利者可以以 18.46 美元的价格买入 VFX 的瓦伦西亚。他们可以转而以 20 美元的价格出售巴伦西亚，每公斤利润为 1.64 美元。正因为如此，他们将继续在 VFX 买入瓦伦西亚，在 AX 卖出，直到他们无法再盈利(价格达到均衡)。在这个例子中，每个人都是赢家，因为交易所收取费用，套利者获利，流动性提供者获得少量费用，套利者的购买有助于将价格带回原位。**

**当瓦伦西亚的价格在所有交易所中上下波动时，问题就出现了。比方说，一个瓦伦西亚的农民 C 走过来，在 VFX 以 2000 美元的价格出售 100 公斤的瓦伦西亚。这是价格调整后的书的样子:**

## **VFX 图书:**

1.  **美元/富士:5000 美元/5000 美元(1000 公斤，每公斤 5 美元)**
2.  **美元/蛇果:5000 美元/5000 美元(500 公斤，每公斤 10 美元)**
3.  **美元/巴伦西亚:3000 美元/3000 美元(350 公斤，每公斤 8.57 美元)**

**更糟糕的是，巴伦西亚农民 D 也在 AX 交易所以 2000 美元的价格卖出了 100 公斤，所以这本书现在是这样的:**

## **斧书:**

1.  **美元/巴伦西亚:3000 美元/3000 美元(350 公斤，每公斤 8.57 美元)**

## **理解暂时的损失**

**如你所见，不存在套利机会。对我们的 VFX 流动性提供者来说更糟糕的是，他们交易了 2000 美元，现在仍然值 2000 美元，但他们收到了 100 公斤的瓦伦西亚，现在每公斤只值 8.57 美元。显然，这将是 VFX 流动性提供者的巨大损失。但是，这对每一个拥有瓦伦西亚橙子股份的人来说都是一个损失。**

**所有这一切的棘手之处在于非永久性的损失。为了证明这一点，让我们将一个拥有 5000 美元和 250 公斤巴伦西亚的 HODL 投资者与 VFX 巴伦西亚的流动性池进行比较:**

## ****HODL 投资者开始**:**

**美元/巴伦西亚:5000 美元/5000 美元(250 公斤，每公斤 15 美元)**

## ****VFX 流动资金池启动**:**

**美元/巴伦西亚 5000 美元/5000 美元(250 公斤，每公斤 15 美元)**

## ****价格暴跌后的 HODL 投资者:****

**美元/巴伦西亚:5000 美元/2142.50 美元(250 公斤，8.57 美元**

## ****价格暴跌后的 VFX 流动性池:****

**美元/巴伦西亚:3000 美元/3000 美元(350 公斤，8.57 美元)**

**这就是无常的损失的样子。HODL 投资者和 VFX 流动性池都遭受了重大损失。HODL 投资者在瓦伦西亚损失了 2857.50 美元，但仍有 5000 美元。相比之下，VFX 流动性提供者在瓦伦西亚损失了 2000 美元*和*2000 美元。两项损失之间的差额(1142 美元)是非永久性损失。**

**我知道这是一个很深奥的话题，但我希望这篇文章能帮助你理解流动性池是如何工作的，以及什么是非永久性损失。如果还是有点困惑，不要难过，我花了很长时间才想明白这一点。然而，在提供流动性方面，可能会有一些相当大的机会。它也会很快吞噬你。**

**网上出现了一些非常有趣的解决方案，会让事情变得更加有趣。想到了班柯(V2) 和[平衡器](https://coinmarketcap.com/currencies/balancer/)。这些系统利用一种算法方法来动态调整流动性池，目的是减少或消除非永久性损失。这种代码有多健壮还有待观察，但目前看来很有希望。**

**在这些项目获得更多收益之前，我不会提供流动性。像附近的[这样的项目为参与风险(在我看来)小得多的赌注池提供奖励。无论你是否决定参与流动性池，我希望这篇文章能让你更好地理解你可能会遇到的情况。注意安全，系好骆驼。](https://coinmarketcap.com/currencies/near-protocol/)**

> **加入 Coinmonks [电报频道](https://t.me/coincodecap)和 [Youtube 频道](https://www.youtube.com/c/coinmonks/videos)了解加密交易和投资**

## **另外，阅读**

*   **[3 商业评论](/coinmonks/3commas-review-an-excellent-crypto-trading-bot-2020-1313a58bec92) | [Pionex 评论](https://blog.coincodecap.com/pionex-review-exchange-with-crypto-trading-bot) | [Coinrule 评论](/coinmonks/coinrule-review-2021-a-beginner-friendly-crypto-trading-bot-daf0504848ba)**
*   **[莱杰 vs Ngrave](/coinmonks/ledger-vs-ngrave-zero-7e40f0c1d694) | [莱杰 nano s vs x](/coinmonks/ledger-nano-s-vs-x-battery-hardware-price-storage-59a6663fe3b0) | [币安评论](/coinmonks/binance-review-ee10d3bf3b6e)**
*   **[Bybit Exchange 审查](/coinmonks/bybit-exchange-review-dbd570019b71) | [Bityard 审查](https://blog.coincodecap.com/bityard-reivew) | [Jet-Bot 审查](https://blog.coincodecap.com/jet-bot-review)**
*   **[3 commas vs crypto hopper](/coinmonks/3commas-vs-pionex-vs-cryptohopper-best-crypto-bot-6a98d2baa203)|[赚取加密利息](/coinmonks/earn-crypto-interest-b10b810fdda3)**
*   **最好的比特币[硬件钱包](/coinmonks/hardware-wallets-dfa1211730c6) | [BitBox02 回顾](/coinmonks/bitbox02-review-your-swiss-bitcoin-hardware-wallet-c36c88fff29)**
*   **[BlockFi vs 摄氏](/coinmonks/blockfi-vs-celsius-vs-hodlnaut-8a1cc8c26630) | [Hodlnaut 点评](/coinmonks/hodlnaut-review-best-way-to-hodl-is-to-earn-interest-on-your-bitcoin-6658a8c19edf) | [KuCoin 点评](https://blog.coincodecap.com/kucoin-review)**
*   **[支持卡审核](https://blog.coincodecap.com/uphold-card-review) | [信任钱包 vs 元掩码](https://blog.coincodecap.com/trust-wallet-vs-metamask)**
*   **[Exness 回顾](https://blog.coincodecap.com/exness-review)|[moon xbt Vs bit get Vs Bingbon](https://blog.coincodecap.com/bingbon-vs-bitget-vs-moonxbt)**
*   **[如何开始通过加密贷款赚取被动收入](https://blog.coincodecap.com/passive-income-crypto-lending)**
*   **[BigONE 交易所评论](/coinmonks/bigone-exchange-review-64705d85a1d4) | [电网交易 Bot](https://blog.coincodecap.com/grid-trading)**
*   **[氹欞侊贸易评论](https://blog.coincodecap.com/anny-trade-review) | [CoinSpot 评论](https://blog.coincodecap.com/coinspot-review)**
*   **[新加坡十大最佳加密交易所](https://blog.coincodecap.com/crypto-exchange-in-singapore) | [购买 AXS](https://blog.coincodecap.com/buy-axs-token)**
*   **[投资印度的最佳加密软件](https://blog.coincodecap.com/best-crypto-to-invest-in-india-in-2021) | [WazirX P2P](https://blog.coincodecap.com/wazirx-p2p)**
*   **[7 个最佳零费用加密交易平台](https://blog.coincodecap.com/zero-fee-crypto-exchanges)**
*   **[最佳网上赌场](https://blog.coincodecap.com/best-online-casinos) | [期货交易机器人](/coinmonks/futures-trading-bots-5a282ccee3f5)**
*   **[去中心化交易所](https://blog.coincodecap.com/what-are-decentralized-exchanges)|[Bitbns FIP](https://blog.coincodecap.com/bitbns-fip)|[Bingbon 评论](https://blog.coincodecap.com/bingbon-review)**
*   **[用信用卡购买密码的 10 个最佳地点](https://blog.coincodecap.com/buy-crypto-with-credit-card)**