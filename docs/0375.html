<html>
<head>
<title>The Freelancer’s Smart Contract: Solidity Codes Explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自由职业者的智能合同:可靠性代码解释</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/the-freelancers-smart-contract-solidity-codes-explained-3abbac8ac03b?source=collection_archive---------3-----------------------#2022-01-30">https://medium.com/coinmonks/the-freelancers-smart-contract-solidity-codes-explained-3abbac8ac03b?source=collection_archive---------3-----------------------#2022-01-30</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="84f8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这是4部分系列的第3部分，记录了我为自由职业者构建一个<a class="ae jo" href="https://ethereum.org/en/dapps/" rel="noopener ugc nofollow" target="_blank">分散式应用程序</a> (DApp)的过程，该应用程序为他与客户一起承担的项目接收多个部分付款。</p><p id="1be8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">关于这个过程的业务逻辑的逐步指南，请参考本系列的第1部分。有关分散式应用程序如何工作的演示，请参考<a class="ae jo" rel="noopener" href="/coinmonks/the-freelancers-smart-contract-dapp-demo-6f5b23a82bfa">第2部分</a>。该项目的源代码可以在该项目的<a class="ae jo" href="https://github.com/jacksonng77/freelancer" rel="noopener ugc nofollow" target="_blank"> Github库</a>中找到。</p><p id="ee12" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在本系列的第三部分，我将介绍自由职业者智能合同背后的可靠性代码。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff jp"><img src="../Images/a481b31cdf94c96c35d3b58ddbb77c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0PWtQIXN3G6fAnpj9IZacw.jpeg"/></div></div><figcaption class="kb kc fg fe ff kd ke bd b be z ek">Photo by <a class="ae jo" href="https://unsplash.com/@woodyyan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Woody Yan</a> on <a class="ae jo" href="https://unsplash.com/s/photos/soil-hand?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a85c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">状态</strong></p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="01dd" class="kk kl ht kg b fv km kn l ko kp">enum ScheduleState {planned, funded, started, approved, released}<br/>enum ProjectState {initiated, accepted, closed}</span></pre><p id="d77c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">有两种状态<code class="eh kq kr ks kg b">enum</code>——一种用于时间表，另一种用于项目。智能合同中的每个进度(如设计阶段、开发阶段、实施阶段)都有5种状态，即- <code class="eh kq kr ks kg b">planned</code>、<code class="eh kq kr ks kg b">funded</code>、<code class="eh kq kr ks kg b">started</code>、<code class="eh kq kr ks kg b">approved</code>和<code class="eh kq kr ks kg b">released</code>。</p><p id="69a6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">该项目有三种状态，即<code class="eh kq kr ks kg b">initiated</code>、<code class="eh kq kr ks kg b">accepted</code>和<code class="eh kq kr ks kg b">closed</code>。</p><p id="7f4a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">结构&amp;全局变量</strong></p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="7251" class="kk kl ht kg b fv km kn l ko kp">struct schedule{<br/>        string shortCode;<br/>        string description;<br/>        uint256 value;<br/>        ScheduleState scheduleState;<br/>}  <br/>  <br/>int256 public totalSchedules = 0;<br/>address payable public freelancerAddress;<br/>address public clientAddress;<br/>ProjectState public projectState;<br/>    <br/>mapping(int256 =&gt; schedule) public scheduleRegister;</span></pre><p id="4647" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">时间表结构包含以下变量，即:</p><ul class=""><li id="297a" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">shortCode</code>:如设计阶段的“DSG”</li><li id="1c82" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">description</code>:例如“设计阶段”</li><li id="509e" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">value</code> : 1e .例如ETH</li><li id="fce2" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">scheduleState</code>:该日程当前所处的状态之一，即<code class="eh kq kr ks kg b">planned</code>、<code class="eh kq kr ks kg b">funded</code>、<code class="eh kq kr ks kg b">started</code>、<code class="eh kq kr ks kg b">approved</code>和<code class="eh kq kr ks kg b">released</code></li></ul><p id="2c01" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">变量<code class="eh kq kr ks kg b">totalSchedule</code>跟踪这个项目的总进度数。变量<code class="eh kq kr ks kg b">freelancerAddress</code>存储自由职业者的钱包地址。变量<code class="eh kq kr ks kg b">clientAddress</code>存储客户端的钱包地址。变量<code class="eh kq kr ks kg b">projectState</code>存储项目的当前状态。</p><p id="fd56" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">地图用于存储项目的所有时间表。</p><p id="f38f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">修改器</strong></p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="1b5c" class="kk kl ht kg b fv km kn l ko kp">modifier condition(bool _condition) {<br/>		require(_condition);<br/>		_;<br/>}</span><span id="1793" class="kk kl ht kg b fv lh kn l ko kp">modifier onlyFreelancer() {<br/>		require(msg.sender == freelancerAddress);<br/>		_;<br/>}</span><span id="3ac8" class="kk kl ht kg b fv lh kn l ko kp">modifier onlyClient() {<br/>		require(msg.sender == clientAddress);<br/>		_;<br/>}<br/>	<br/>modifier bothClientFreelancer(){<br/>		require(msg.sender == clientAddress || msg.sender == freelancerAddress);<br/>		_;	    <br/>}</span></pre><p id="0bb2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这些在智能合同的功能中使用，以验证是否允许客户和/或自由职业者调用它们。有些功能，如<code class="eh kq kr ks kg b">releaseFunds()</code>(允许在计划结束时释放资金)只能由自由职业者调用。其他函数，如<code class="eh kq kr ks kg b">approveTask()</code>(批准向日程表添加新任务)只能由客户端调用。还有像<code class="eh kq kr ks kg b">endProject()</code>这样的函数，客户和/或自由职业者都可以调用。</p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="d6f3" class="kk kl ht kg b fv km kn l ko kp">modifier inProjectState(ProjectState _state) {<br/>		require(projectState == _state);<br/>		_;<br/>}</span></pre><p id="762e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kq kr ks kg b">inProjectState() </code>修饰符检查项目当前是否处于特定的状态(例如，关闭)。某些功能只有在项目处于某种状态时才能执行。例如，只有当项目处于启动状态时，才能添加新的计划，而当项目已经关闭时，则不能添加。</p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="00d5" class="kk kl ht kg b fv km kn l ko kp">modifier <strong class="kg hu">in</strong>ScheduleState(int256 _scheduleID, ScheduleState _state){<br/>        require((_scheduleID &lt;= totalSchedules - 1) &amp;&amp; scheduleRegister[_scheduleID].scheduleState == _state);<br/>        _;<br/>}</span></pre><p id="5355" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kq kr ks kg b">inScheduleState()</code>修改器检查所讨论的时间表是否处于特定状态(例如，已拨款)。这允许函数测试一个调度是否准备好进入下一个状态——例如，一个调度只有在当前处于<code class="eh kq kr ks kg b">planned</code>状态时才能进入<code class="eh kq kr ks kg b">funded</code>状态。</p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="985a" class="kk kl ht kg b fv km kn l ko kp">modifier ampleFunding(int256 _scheduleID, uint256 _funding){<br/>        require(scheduleRegister[_scheduleID].value == _funding);<br/>        _;<br/>}</span><span id="c659" class="kk kl ht kg b fv lh kn l ko kp">modifier noMoreFunds(){<br/>        require(address(<strong class="kg hu">this</strong>).balance == 0);<br/>        _;<br/>}</span></pre><p id="7a64" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kq kr ks kg b">ampleFunding() </code>修饰符检查一个调度的资金是否等于它应该收到的资金。例如，“设计阶段”花费1 ETH。此修改人检查以确保客户确实已将1 ETH资金投入该计划。</p><p id="196b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kq kr ks kg b">noMoreFunds()</code>修饰符检查智能契约是否仍然持有任何ETH的托管权。</p><p id="ee0d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">功能</strong></p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="9d4d" class="kk kl ht kg b fv km kn l ko kp">constructor()<br/>{<br/>        freelancerAddress = payable(msg.sender);<br/>        projectState = ProjectState.initiated;<br/>}</span></pre><p id="c5ef" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kq kr ks kg b">constructor() </code>函数将启动该智能合约的人的钱包地址保存在<code class="eh kq kr ks kg b">freelancerAddress</code>变量中，并将<code class="eh kq kr ks kg b">projectState</code>设置为initiated。</p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="21f4" class="kk kl ht kg b fv km kn l ko kp"><strong class="kg hu">function</strong> <strong class="kg hu">addSchedule</strong>(string memory _shortCode, string memory _description, uint256 _value)<br/>    <strong class="kg hu">public</strong><br/>    <strong class="kg hu">inProjectState</strong>(ProjectState.initiated)<br/>    <strong class="kg hu">onlyFreelancer</strong><br/>{<br/>        schedule memory s;<br/>        s.shortCode = _shortCode;<br/>        s.description = _description;<br/>        s.scheduleState = ScheduleState.planned;<br/>        s.value = _value;<br/>        scheduleRegister[totalSchedules] = s;<br/>        totalSchedules++;<br/>        emit scheduleAdded(_shortCode);<br/>}</span></pre><p id="0eb2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kq kr ks kg b">addSchedule()</code>只能在项目处于发起状态时调用。只能由发起此智能合约的人员执行(<code class="eh kq kr ks kg b">onlyFreelancer</code>)。该函数初始化一个新的日程，并将该日程的<code class="eh kq kr ks kg b">shortCode</code>、<code class="eh kq kr ks kg b">description</code>和<code class="eh kq kr ks kg b">value</code>保存到<code class="eh kq kr ks kg b">scheduleRegister</code>映射中。它增加了变量<code class="eh kq kr ks kg b">totalSchedule</code>,以跟踪这个项目中计划的总数。</p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="3698" class="kk kl ht kg b fv km kn l ko kp"><strong class="kg hu">function</strong> <strong class="kg hu">acceptProject</strong>()<br/>    <strong class="kg hu">public</strong><br/>    <strong class="kg hu">inProjectState</strong>(ProjectState.initiated)<br/>{<br/>        clientAddress = msg.sender;<br/>        projectState = ProjectState.accepted;<br/>        emit projectAccepted(msg.sender);<br/>}</span></pre><p id="8ed6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当<code class="eh kq kr ks kg b">acceptProject()</code>被调用时，它将执行它的人的钱包地址保存到<code class="eh kq kr ks kg b">clientAddress</code>变量中。然后将<code class="eh kq kr ks kg b">projectState</code>设置为<code class="eh kq kr ks kg b">accepted</code>。调用<code class="eh kq kr ks kg b">acceptProject()</code>的人成为这个项目的客户。</p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="4975" class="kk kl ht kg b fv km kn l ko kp"><strong class="kg hu">function</strong> <strong class="kg hu">fundTask</strong>(int256 _scheduleID)<br/>    <strong class="kg hu">public</strong><br/>    <strong class="kg hu">payable</strong><br/>    <strong class="kg hu">inProjectState</strong>(ProjectState.accepted)<br/>    <strong class="kg hu">inScheduleState</strong>(_scheduleID, ScheduleState.planned)<br/>    <strong class="kg hu">ampleFunding</strong>(_scheduleID, msg.value)<br/>    <strong class="kg hu">onlyClient</strong><br/>{<br/>        scheduleRegister[_scheduleID].scheduleState = ScheduleState.funded;<br/>        emit taskFunded(_scheduleID);<br/>}</span></pre><p id="bc3d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当客户准备好允许自由职业者按照特定的时间表开始工作(如设计阶段)时，他通过执行<code class="eh kq kr ks kg b">fundTask()</code>来为任务提供资金。<code class="eh kq kr ks kg b">fundTask() </code>仅当满足以下条件时才可调用:</p><ul class=""><li id="ed24" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">payable</code> -调用fundTask()时存放ETH</li><li id="a590" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">inProjectState</code>:接受——项目必须被客户接受。</li><li id="a591" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">inScheduleState</code>:已计划——待拨款的进度处于计划状态</li><li id="99da" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">ampleFunding</code> -存入智能合同的ETH等于待资助计划的价值(即，如果设计阶段花费1 ETH，则必须存入1 ETH)</li><li id="d07d" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">onlyClient </code> -该功能仅由客户端执行</li></ul><p id="df36" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当执行时，该时间表的状态从<code class="eh kq kr ks kg b">planned</code>变为<code class="eh kq kr ks kg b">funded</code>。</p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="6bbc" class="kk kl ht kg b fv km kn l ko kp"><strong class="kg hu">function</strong> <strong class="kg hu">startTask</strong>(int256 _scheduleID)<br/>    <strong class="kg hu">public</strong><br/>    <strong class="kg hu">inProjectState</strong>(ProjectState.accepted)<br/>    <strong class="kg hu">inScheduleState</strong>(_scheduleID, ScheduleState.funded)<br/>    <strong class="kg hu">onlyFreelancer</strong><br/>{<br/>        scheduleRegister[_scheduleID].scheduleState = ScheduleState.started;<br/>        emit taskStarted(_scheduleID);<br/>}</span></pre><p id="75d5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">自由职业者执行<code class="eh kq kr ks kg b">startTask()</code>功能是为了表明他已经开始从事一项特定的任务。<code class="eh kq kr ks kg b">startTask()</code>只有满足以下条件时才可调用:</p><ul class=""><li id="1b63" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn ky kz la lb dt translated">接受-客户必须已经接受了这个项目</li><li id="e4a3" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">inScheduleState</code>:已拨款-客户必须已为此计划拨款</li><li id="1e14" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">onlyFreelancer</code>:只有自由职业者才能调用这个功能。</li></ul><p id="6727" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当执行时，该时间表的状态从<code class="eh kq kr ks kg b">funded</code>变为<code class="eh kq kr ks kg b">started</code>。</p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="a47e" class="kk kl ht kg b fv km kn l ko kp"><strong class="kg hu">function</strong> <strong class="kg hu">approveTask</strong>(int256 _scheduleID)<br/>    <strong class="kg hu">public</strong><br/>    <strong class="kg hu">inProjectState</strong>(ProjectState.accepted)<br/>    <strong class="kg hu">inScheduleState</strong>(_scheduleID, ScheduleState.started)<br/>    <strong class="kg hu">onlyClient</strong><br/>{<br/>    scheduleRegister[_scheduleID].scheduleState = ScheduleState.approved;<br/>    emit taskApproved(_scheduleID);<br/>}</span></pre><p id="0e00" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">客户执行<code class="eh kq kr ks kg b">approveTask()</code>功能来表明他已经看到并批准了一个任务。<code class="eh kq kr ks kg b">approveTask()</code>仅当满足以下条件时才可调用:</p><ul class=""><li id="2de7" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">inProjectState</code>:已接受——客户必须接受这个项目</li><li id="cc87" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated">开始-自由职业者必须已经开始这项任务的工作</li><li id="7896" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">onlyClient </code> -只有客户可以批准任务。</li></ul><p id="a066" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当执行时，该时间表的状态从<code class="eh kq kr ks kg b">started</code>变为<code class="eh kq kr ks kg b">approved</code>。</p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="c186" class="kk kl ht kg b fv km kn l ko kp"><strong class="kg hu">function</strong> <strong class="kg hu">releaseFunds</strong>(int256 _scheduleID)<br/>    <strong class="kg hu">public</strong><br/>    <strong class="kg hu">payable</strong><br/>    <strong class="kg hu">inProjectState</strong>(ProjectState.accepted)<br/>    <strong class="kg hu">inScheduleState</strong>(_scheduleID, ScheduleState.approved)<br/>    <strong class="kg hu">onlyFreelancer</strong><br/>{<br/>        freelancerAddress.transfer(scheduleRegister[_scheduleID].value);<br/>        scheduleRegister[_scheduleID].scheduleState = ScheduleState.released;<br/>        emit fundsReleased(_scheduleID, scheduleRegister[_scheduleID].value);<br/>}</span></pre><p id="1e46" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">自由职业者执行<code class="eh kq kr ks kg b">releaseFunds() </code>功能，将智能合同保管的资金释放到他的钱包地址。这意味着一项任务的完成，因此，要向自由职业者支付报酬。<code class="eh kq kr ks kg b">releaseFunds()</code>仅当满足以下条件时才可调用:</p><ul class=""><li id="d647" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn ky kz la lb dt translated">接受-客户必须已经接受了这个项目</li><li id="985d" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated">批准-客户必须已经接受了自由职业者为这项任务所做的工作。</li><li id="2bec" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">onlyFreelancer</code>:只有自由职业者可以调用此功能向自己释放资金</li></ul><p id="183f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">执行时，<code class="eh kq kr ks kg b">releaseFunds()</code>会将智能合同为此任务保管的ETH转移到自由职业者的钱包地址。它还将时间表的状态从<code class="eh kq kr ks kg b">approved</code>更改为<code class="eh kq kr ks kg b">released</code>。</p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="2bb7" class="kk kl ht kg b fv km kn l ko kp"><strong class="kg hu">function</strong> <strong class="kg hu">endProject</strong>()<br/>    <strong class="kg hu">public</strong><br/>    <strong class="kg hu">bothClientFreelancer</strong><br/>    <strong class="kg hu">noMoreFunds</strong><br/>{<br/>        projectState = ProjectState.closed;<br/>        emit projectEnded();<br/>}</span></pre><p id="cf49" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kq kr ks kg b">endProject()</code>功能标志着项目的完成。仅当满足以下条件时，此函数才可调用:</p><ul class=""><li id="f618" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn ky kz la lb dt translated"><code class="eh kq kr ks kg b">noMoreFunds</code>:本项目不再托管任何ETH。所有的ETH都被释放给了自由职业者。</li></ul><p id="f6cc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">执行时，<code class="eh kq kr ks kg b">endProject()</code>将项目状态更改为关闭。</p><pre class="jq jr js jt fq kf kg kh ki aw kj dt"><span id="dc08" class="kk kl ht kg b fv km kn l ko kp"><strong class="kg hu">function</strong> <strong class="kg hu">getBalance</strong>()<br/>    <strong class="kg hu">public</strong><br/>    <strong class="kg hu">view</strong><br/>    <strong class="kg hu">returns</strong> (uint256 balance)<br/>{<br/>        <strong class="kg hu">return</strong> address(<strong class="kg hu">this</strong>).balance;<br/>}</span></pre><p id="7568" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kq kr ks kg b">getBalance()</code>将智能合约持有的总余额返回给调用者。知道智能合约地址的可以打<code class="eh kq kr ks kg b">getBalance()</code>。</p><p id="82d0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">下一步是什么？</p><p id="1402" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这个项目的源代码可以在我的<a class="ae jo" href="https://github.com/jacksonng77/freelancer" rel="noopener ugc nofollow" target="_blank"> Github库</a>中找到。</p><p id="d2a0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在本教程的最后一部分，我将解释自由职业者分散式应用程序的基于Javascript的代码。敬请期待！</p><ol class=""><li id="2ced" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn li kz la lb dt translated">自由职业者的智能合同:如何运作</li><li id="0992" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn li kz la lb dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/the-freelancers-smart-contract-dapp-demo-6f5b23a82bfa">自由职业者的智能合同:DApp演示</a></li><li id="fbe7" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn li kz la lb dt translated">自由职业者的智能合同:可靠性代码解读(这一部分)</li><li id="8f04" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn li kz la lb dt translated">自由职业者的智能合同:DApp法典解读</li></ol><p id="6d54" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您喜欢本教程，也许您也希望阅读:</p><ul class=""><li id="d002" class="kt ku ht is b it iu ix iy jb kv jf kw jj kx jn ky kz la lb dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/the-freelancers-smart-contract-how-it-works-fda5e1fddf8d">自由职业者智能合同</a>:自由职业者和他的客户之间的一个支付系统，以确保交货和付款。</li><li id="3401" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/ropsten-ethereum-faucet-web-app-cc9a50ee45fd"> Ropsten以太坊龙头</a>:我做了一个以太坊龙头在Ropsten网络上发布ETH。</li><li id="2e96" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/voting-on-a-blockchain-how-it-works-3bb41582f403">区块链投票</a>:以太坊投票DApp的实现。</li><li id="663e" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/deploy-a-private-ethereum-blockchain-in-10-minutes-with-kaleido-73c21a26d5bb">使用Kaleido在10分钟内部署一个私有以太坊区块链</a>:在瞬间启动并运行一个私有以太坊区块链。</li><li id="5b46" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/smart-contract-explained-by-demonstration-93b06e938474">演示解释智能合约</a>:托管服务智能合约DApp的演示——在我看来，这是向外行人解释区块链是什么的最快方式。</li><li id="996c" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/ethereum-iot-kid-grounding-device-iv-arduino-in-retrospect-b7a32e5ec185">以太坊IOT Kid Grounding Device </a>:我将区块链与物联网结合的尝试。</li><li id="350a" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/lottery-as-a-smart-contract-the-business-logic-3bd22d3a6c4e">彩票作为智能合约</a>:去中心化彩票，在以太坊区块链上构建彩票系统的尝试。</li></ul><blockquote class="lj"><p id="42b2" class="lk ll ht bd lm ln lo lp lq lr ls jn ek translated">加入Coinmonks <a class="ae jo" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jo" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h2 id="594f" class="kk kl ht bd lt lu lv lw lx ly lz ma mb jb mc md me jf mf mg mh jj mi mj mk ml dt translated">也阅读</h2><div class="mm mn fm fo mo mp"><a href="https://coincodecap.com/best-telegram-channels" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab ej"><div class="mr ab ms cl cj mt"><h2 class="bd hu fv z el mu eo ep mv er et hs dt translated">40个最佳电报频道，用于加密、电影、表演和演讲| CoinCodeCap</h2><div class="mw l"><h3 class="bd b fv z el mu eo ep mv er et ek translated">免费下载所有电影。德国免费加密信号。下载讲座。CoinCodeCap经典，网飞电影等。是……</h3></div><div class="mx l"><p class="bd b gc z el mu eo ep mv er et ek translated">coincodecap.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd jz mp"/></div></div></a></div><div class="mm mn fm fo mo mp"><a href="https://coincodecap.com/keevo-wallet-review" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab ej"><div class="mr ab ms cl cj mt"><h2 class="bd hu fv z el mu eo ep mv er et hs dt translated">Keevo钱包点评:是最安全的硬件钱包吗？2022 | CoinCodeCap</h2><div class="mw l"><h3 class="bd b fv z el mu eo ep mv er et ek translated">在这篇Keevo Wallet评论中，我们将讨论他们如何改变我们看待硬件钱包的方式。基沃是…</h3></div><div class="mx l"><p class="bd b gc z el mu eo ep mv er et ek translated">coincodecap.com</p></div></div><div class="my l"><div class="ne l na nb nc my nd jz mp"/></div></div></a></div><div class="mm mn fm fo mo mp"><a href="https://coincodecap.com/best-social-trading-platforms" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab ej"><div class="mr ab ms cl cj mt"><h2 class="bd hu fv z el mu eo ep mv er et hs dt translated">2022年5大最佳社交交易平台</h2><div class="mw l"><h3 class="bd b fv z el mu eo ep mv er et ek translated">5个最佳社交交易平台阅读加密产品评论和比较，了解比特币交易和…</h3></div><div class="mx l"><p class="bd b gc z el mu eo ep mv er et ek translated">coincodecap.com</p></div></div><div class="my l"><div class="nf l na nb nc my nd jz mp"/></div></div></a></div><div class="mm mn fm fo mo mp"><a href="https://coincodecap.com/blockfi-review" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab ej"><div class="mr ab ms cl cj mt"><h2 class="bd hu fv z el mu eo ep mv er et hs dt translated">BlockFi评论:2022年的利弊和利率</h2><div class="mw l"><h3 class="bd b fv z el mu eo ep mv er et ek translated">今天，我们提出了一个全面的BlockFi评论，这是一个成立于2017年的加密贷款平台，拥有其…</h3></div><div class="mx l"><p class="bd b gc z el mu eo ep mv er et ek translated">coincodecap.com</p></div></div><div class="my l"><div class="ng l na nb nc my nd jz mp"/></div></div></a></div><div class="mm mn fm fo mo mp"><a rel="noopener follow" target="_blank" href="/coinmonks/buy-bitcoin-in-india-feb50ddfef94"><div class="mq ab ej"><div class="mr ab ms cl cj mt"><h2 class="bd hu fv z el mu eo ep mv er et hs dt translated">如何在印度购买比特币？2021年购买比特币的7款最佳应用[手机版]</h2><div class="mw l"><h3 class="bd b fv z el mu eo ep mv er et ek translated">如何使用移动应用程序购买比特币印度</h3></div><div class="mx l"><p class="bd b gc z el mu eo ep mv er et ek translated">medium.com</p></div></div><div class="my l"><div class="nh l na nb nc my nd jz mp"/></div></div></a></div><div class="mm mn fm fo mo mp"><a rel="noopener follow" target="_blank" href="/coinmonks/best-crypto-tax-tool-for-my-money-72d4b430816b"><div class="mq ab ej"><div class="mr ab ms cl cj mt"><h2 class="bd hu fv z el mu eo ep mv er et hs dt translated">加密税务软件——五大最佳比特币税务计算器[2021]</h2><div class="mw l"><h3 class="bd b fv z el mu eo ep mv er et ek translated">不管你是刚接触加密还是已经在这个领域呆了一段时间，你都需要交税。</h3></div><div class="mx l"><p class="bd b gc z el mu eo ep mv er et ek translated">medium.com</p></div></div><div class="my l"><div class="ni l na nb nc my nd jz mp"/></div></div></a></div><div class="mm mn fm fo mo mp"><a href="https://coincodecap.com/crypto-to-buy-in-2022" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab ej"><div class="mr ab ms cl cj mt"><h2 class="bd hu fv z el mu eo ep mv er et hs dt translated">9个2022年最值得购买的密码| CoinCodeCap</h2><div class="mw l"><h3 class="bd b fv z el mu eo ep mv er et ek translated">9个2022年最值得购买的加密产品阅读加密产品评论和比较，了解比特币交易和…</h3></div><div class="mx l"><p class="bd b gc z el mu eo ep mv er et ek translated">coincodecap.com</p></div></div><div class="my l"><div class="nj l na nb nc my nd jz mp"/></div></div></a></div><div class="mm mn fm fo mo mp"><a href="https://coincodecap.com/best-hardware-wallet-bitcoin" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab ej"><div class="mr ab ms cl cj mt"><h2 class="bd hu fv z el mu eo ep mv er et hs dt translated">存储比特币的最佳加密硬件钱包2022 | CoinCodeCap</h2><div class="mw l"><h3 class="bd b fv z el mu eo ep mv er et ek translated">硬件钱包是我们存储加密资产的唯一可靠选择。在本文中，我们将讨论8个…</h3></div><div class="mx l"><p class="bd b gc z el mu eo ep mv er et ek translated">coincodecap.com</p></div></div><div class="my l"><div class="nk l na nb nc my nd jz mp"/></div></div></a></div><div class="mm mn fm fo mo mp"><a rel="noopener follow" target="_blank" href="/coinmonks/pionex-review-exchange-with-crypto-trading-bot-1e459d0191ea"><div class="mq ab ej"><div class="mr ab ms cl cj mt"><h2 class="bd hu fv z el mu eo ep mv er et hs dt translated">Pionex评论2021 |免费加密交易机器人和交换</h2><div class="mw l"><h3 class="bd b fv z el mu eo ep mv er et ek translated">Pionex是为交易自动化提供工具的后起之秀。Pionex上提供了9个加密交易机器人…</h3></div><div class="mx l"><p class="bd b gc z el mu eo ep mv er et ek translated">medium.com</p></div></div><div class="my l"><div class="nl l na nb nc my nd jz mp"/></div></div></a></div><div class="mm mn fm fo mo mp"><a rel="noopener follow" target="_blank" href="/coinmonks/top-3-telegram-channels-for-crypto-traders-in-2021-8385f4411ff4"><div class="mq ab ej"><div class="mr ab ms cl cj mt"><h2 class="bd hu fv z el mu eo ep mv er et hs dt translated">2022年密码交易员的三大电报渠道</h2><div class="mw l"><h3 class="bd b fv z el mu eo ep mv er et ek translated">加密信号是来自专业交易者的交易想法，以特定的价格或价格买卖特定的加密货币</h3></div><div class="mx l"><p class="bd b gc z el mu eo ep mv er et ek translated">medium.com</p></div></div><div class="my l"><div class="nm l na nb nc my nd jz mp"/></div></div></a></div><div class="mm mn fm fo mo mp"><a href="https://coincodecap.com/free-crypto-portfolio-trackers" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab ej"><div class="mr ab ms cl cj mt"><h2 class="bd hu fv z el mu eo ep mv er et hs dt translated">2022年5个最佳免费加密投资组合追踪器</h2><div class="mw l"><h3 class="bd b fv z el mu eo ep mv er et ek translated">在这篇文章中，我们将带你通过一些最好的免费加密投资组合追踪器，让你选择最好的…</h3></div><div class="mx l"><p class="bd b gc z el mu eo ep mv er et ek translated">coincodecap.com</p></div></div><div class="my l"><div class="nn l na nb nc my nd jz mp"/></div></div></a></div></div></div>    
</body>
</html>