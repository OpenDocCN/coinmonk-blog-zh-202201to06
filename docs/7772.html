<html>
<head>
<title>Ethereum checksummed addresses, importance, and implementation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太坊校验和地址、重要性和实现</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/ethereum-checksummed-addresses-importance-and-implementation-eef74aa3ae18?source=collection_archive---------21-----------------------#2022-05-31">https://medium.com/coinmonks/ethereum-checksummed-addresses-importance-and-implementation-eef74aa3ae18?source=collection_archive---------21-----------------------#2022-05-31</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="c1d2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">校验和地址是包含一些验证其完整性的数据的地址。</p><p id="d751" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">校验和是从其他数据中获得的一小段数据，用于检测数据在网络传输过程中的错误，或者由于用户操作错误而导致的错误。</p><p id="2bcb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在区块链，计算地址校验和并以某种方式将校验和附加到地址本身是一种常见的做法。这样，当我们使用该地址向其发送资金时，钱包、区块链客户端或区块链本身就有办法检查该地址的完整性，以检测错误并防止资金损失。</p><h1 id="a09d" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated">以太坊</h1><p id="7082" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated">以太坊现在支持校验和地址。以太坊最初并不支持校验和地址，而是使用原始的十六进制地址。这是一个问题，因为以太坊客户端无法检查地址的完整性，如果地址不正确，用户可能会损失资金。</p><p id="fa63" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">以太坊改进提案(EIP)提交了一种以向后兼容的方式给以太坊地址添加校验和的方法。参见<a class="ae kr" href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-55.md" rel="noopener ugc nofollow" target="_blank"> EIP-55 </a>。</p><p id="a63a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在EIP-55之前，以太坊地址通常是这样的:</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="6016" class="lb jp ht kx b fv lc ld l le lf">0x6827b8f6cc60497d9bf5210d602c0ecafdf7c405</span></pre><p id="b698" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">十六进制地址的所有字符都是小写的。</p><p id="ace4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在，使用EIP-55，以太坊地址看起来像这样:</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="3d27" class="lb jp ht kx b fv lc ld l le lf">0x6827b8f6cc60497d9bf5210d602C0EcaFDF7C405</span></pre><p id="7175" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">低位和高位字符的混合，对以太坊客户端(如Metamask和Web3js)可以检测和检查正确性的校验和进行编码。</p><p id="8e09" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们仍然可以将资金发送到一个全小写的地址(一个没有校验和的地址)，以太坊客户端和以太坊协议将接受它并锁定资金，而不验证其正确性(因为没有办法验证其完整性)，潜在地将资金锁定在一个无效的地址，并永远失去资金。</p><p id="455a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在向该地址发送资金之前，请务必使用校验和地址。</p><p id="456d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">EIP-55如何工作</strong></p><p id="7aa3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">要为以太坊地址创建校验和:</p><ol class=""><li id="bc5e" class="lg lh ht is b it iu ix iy jb li jf lj jj lk jn ll lm ln lo dt translated">我们需要以小写形式计算地址的Keccack-256哈希，不带前缀“0x”。</li><li id="5ec8" class="lg lh ht is b it lp ix lq jb lr jf ls jj lt jn ll lm ln lo dt translated">比较地址和哈希的第I个字符，如果地址的第I个字符是字母，哈希十六进制值的第I个字符大于或等于8，则将地址的第I个字符设置为大写。</li></ol><figure class="ks kt ku kv fq lu"><div class="bz el l di"><div class="lv lw l"/></div></figure><p id="5cb2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这将打印出如下内容:</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="3a51" class="lb jp ht kx b fv lc ld l le lf">e898144c41032142c62479606b2c4a63e9f18f4023297d6673d4eeb13cafdb50</span></pre><p id="5e7d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们把地址和散列一个放在另一个下面:</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="1bec" class="lb jp ht kx b fv lc ld l le lf">6827b8f6cc60497d9bf5210d602c0ecafdf7c405<br/>e898144c41032142c62479606b2c4a63e9f18f4023297d6673d4eeb13cafdb50</span></pre><p id="ab5b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们只需要散列的前20个字节(40个字符),忽略其余的，因为以太坊地址是20个字节。</p><p id="a8b4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果我们比较地址和散列的第I个索引处的每个字符，并检查上面提到的条件，我们会观察到以下字符匹配这些条件，用红色突出显示:</p><figure class="ks kt ku kv fq lu fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff lx"><img src="../Images/c281b10055e58113bf2e5b6b16c1bfc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JM9OHO6mXdJ43-jZuRH7SA.png"/></div></div></figure><p id="e428" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">索引27处的地址字符是c，是一个字母，索引27处的哈希字符是c，十六进制值大于8，所以，我们将索引27处的地址字母设置为大写，如结果行所示。我们在索引29、32、33、34和36处找到匹配的字符，所以只有这些字符被设置为大写。</p><p id="31f9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当以太坊客户端获得校验和地址并想要验证它时，它会复制它，将其设置为小写并运行与上述相同的步骤，并将结果与它收到的校验和地址进行比较，如果它们不匹配，则地址无效并引发错误。</p><p id="e788" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">改变地址，哪怕是一点点，都会产生完全不同的keccack256哈希，校验和也会不同。</p><blockquote class="me mf mg"><p id="6779" class="iq ir mh is b it iu iv iw ix iy iz ja mi jc jd je mj jg jh ji mk jk jl jm jn hm dt translated">交易新手？试试<a class="ae kr" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或者<a class="ae kr" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote><p id="8c3d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这里有一个工具可以在线尝试不同的哈希算法:<a class="ae kr" href="https://emn178.github.io/online-tools/keccak_256.html" rel="noopener ugc nofollow" target="_blank"> emn178.github.io </a></p><p id="d016" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这里有一小段代码来展示如何实现它:</p><figure class="ks kt ku kv fq lu"><div class="bz el l di"><div class="lv lw l"/></div></figure><p id="c620" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这将打印:</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="49f9" class="lb jp ht kx b fv lc ld l le lf">6827b8f6cc60497d9bf5210d602C0EcaFDF7C405<br/>true</span></pre><p id="dba7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您使用元掩码，您会看到它默认显示校验和地址。如果您尝试修改校验和地址，哪怕只是一点点，它都会抱怨地址无效。让我们将示例地址的最后一位数字从5改为6，并尝试使用元掩码向其发送资金:</p><figure class="ks kt ku kv fq lu fe ff paragraph-image"><div class="fe ff ml"><img src="../Images/d5602d5a9db215de213844fb58309f6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*VGGUmbG-NLi7xapRUJivuA.png"/></div></figure><p id="6185" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">此外，如果你进入e <a class="ae kr" href="https://etherscan.io/" rel="noopener ugc nofollow" target="_blank"> therscan.io </a>并在搜索栏中粘贴一个没有校验和的地址，然后点击enter，它会显示带有校验和的地址:</p><figure class="ks kt ku kv fq lu fe ff paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="fe ff mm"><img src="../Images/daa4295939a03754627a248582c23f93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5pTU_biskoWrrxdH1HKqKg.png"/></div></div></figure><figure class="ks kt ku kv fq lu fe ff paragraph-image"><div class="fe ff mn"><img src="../Images/a5010bedc64076eb092515cb6b122a8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*FvsptyXQ0mZ0SMMk_c-dHA.png"/></div></figure><p id="74db" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">给以太坊地址添加校验和的简单方法！</p><h1 id="9ca5" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated">结论</h1><p id="4352" class="pw-post-body-paragraph iq ir ht is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hm dt translated">我们已经看到以太坊客户端如何给以太坊地址添加校验和。其他区块链也对其地址进行校验和编码，以减少向无效地址发送资金的机会。</p><p id="4fc5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">还提出了一种不同的方法来标准化带有内置校验和的以太坊地址，称为<a class="ae kr" href="https://eth.wiki/ideas/inter-exchange-client-address-protocol-icap" rel="noopener ugc nofollow" target="_blank"> ICAP </a> (Interexchange客户端地址协议)，它基于IBAN(国际银行帐号)格式。这不常用。</p><p id="7534" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">以太坊地址从一开始就没有被添加校验和和编码，因为它们不应该被直接使用，而是来自区块链的一个域名，带有以太坊名称服务(ENS)，在<a class="ae kr" href="https://eips.ethereum.org/EIPS/eip-137" rel="noopener ugc nofollow" target="_blank"> EIP-137 </a>中引入。因此，用户可以使用一个内部指向其地址的域，而不是使用原始的十六进制地址。类似于:jeremythen.eth</p><p id="336d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">以太坊名称服务的开发没有在预期的时间内完成，现在使用原始的十六进制地址是规范。</p></div></div>    
</body>
</html>