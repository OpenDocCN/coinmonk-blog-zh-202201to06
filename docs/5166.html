<html>
<head>
<title>Connect Browser Wallet with useDapp</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用useDapp连接浏览器钱包</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/connect-browser-wallet-with-usedapp-f090212eb882?source=collection_archive---------7-----------------------#2022-04-19">https://medium.com/coinmonks/connect-browser-wallet-with-usedapp-f090212eb882?source=collection_archive---------7-----------------------#2022-04-19</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="19cf" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">简单的React应用程序，展示了如何用useDapp和ethers.js连接浏览器钱包</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ji"><img src="../Images/e35fad400e76fb754cb96700b8cb5621.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*taKV4LXmjcCMoHqXC0tjFg.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Metamask Logo.</figcaption></figure><p id="9b3d" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">阅读完本文后，您将知道如何将浏览器钱包连接到您的Web应用程序。我会尽量简短。为了启动项目，我们将使用Create React App。</p><pre class="jj jk jl jm fq ku kv kw kx aw ky dt"><span id="3973" class="kz la ht kv b fv lb lc l ld le">$ npx create-react-app connect-wallet<br/>$ cd connect-wallet</span></pre><p id="a41a" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated"><em class="lf">注:如果你来这里只是为了代码，可以从我的GitHub </em>  <em class="lf">中抓取</em> <a class="ae lg" href="https://github.com/krisograbek/usedapp-playground" rel="noopener ugc nofollow" target="_blank"> <em class="lf">。此外，您会发现文章中缺少的CSS文件。</em></a></p><p id="20e0" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated"><em class="lf">注2:要跟随文章，JavaScript的基础知识应该足够了。此外，您的计算机上需要node.js和npm。否则，您将无法调用上述命令。</em></p><h2 id="cef7" class="kz la ht bd lh li lj lk ll lm ln lo lp kh lq lr ls kl lt lu lv kp lw lx ly lz dt translated">安装useDapp和ethers.js</h2><p id="3347" class="pw-post-body-paragraph jy jz ht ka b kb ma iu kd ke mb ix kg kh mc kj kk kl md kn ko kp me kr ks kt hm dt translated">在我们的项目中，我们将使用两个web3专用的库:<strong class="ka hu"> useDapp </strong>和<strong class="ka hu"> Ethers.js </strong>。要安装它们，请在您的终端中键入:</p><pre class="jj jk jl jm fq ku kv kw kx aw ky dt"><span id="f2d0" class="kz la ht kv b fv lb lc l ld le">$ npm install @usedapp/core ethers</span></pre><h2 id="b54d" class="kz la ht bd lh li lj lk ll lm ln lo lp kh lq lr ls kl lt lu lv kp lw lx ly lz dt translated">将useDapp添加到项目中。</h2><p id="9892" class="pw-post-body-paragraph jy jz ht ka b kb ma iu kd ke mb ix kg kh mc kj kk kl md kn ko kp me kr ks kt hm dt translated">为了在我们的项目中启用useDapp库，我们必须用<strong class="ka hu"> DAppProvider </strong>包装我们的应用程序。基本设置如下所示:</p><figure class="jj jk jl jm fq jn"><div class="bz el l di"><div class="mf mg l"/></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Enabling useDapp to our front-end using the DAppProvider Component.</figcaption></figure><p id="ce79" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">以上片段的关键部分:</p><ul class=""><li id="7c56" class="mh mi ht ka b kb kc ke kf kh mj kl mk kp ml kt mm mn mo mp dt translated"><strong class="ka hu">配置</strong>设置配置，</li><li id="0b61" class="mh mi ht ka b kb mq ke mr kh ms kl mt kp mu kt mm mn mo mp dt translated"><strong class="ka hu"> DAppProvider </strong>在整个应用程序中启用useDapp。</li></ul><h2 id="bae3" class="kz la ht bd lh li lj lk ll lm ln lo lp kh lq lr ls kl lt lu lv kp lw lx ly lz dt translated">添加前端。</h2><p id="92bb" class="pw-post-body-paragraph jy jz ht ka b kb ma iu kd ke mb ix kg kh mc kj kk kl md kn ko kp me kr ks kt hm dt translated">让我们把事情简单化。我们的整个前端部分将看起来像这样。</p><figure class="jj jk jl jm fq jn"><div class="bz el l di"><div class="mf mg l"/></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Front-end part for connecting the wallet.</figcaption></figure><p id="187b" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">让我们来分解一下:</p><ul class=""><li id="875c" class="mh mi ht ka b kb kc ke kf kh mj kl mk kp ml kt mm mn mo mp dt translated">我们的应用程序只有两个组件:一个标题和一个按钮，</li><li id="f9f2" class="mh mi ht ka b kb mq ke mr kh ms kl mt kp mu kt mm mn mo mp dt translated">我们使用<strong class="ka hu">三元运算符</strong>，这是一个带问号(？).我们需要它来定制按钮和显示的文本，</li><li id="02ac" class="mh mi ht ka b kb mq ke mr kh ms kl mt kp mu kt mm mn mo mp dt translated">我们根据是否有连接的帐户呈现不同类型的按钮。</li></ul><h2 id="46e7" class="kz la ht bd lh li lj lk ll lm ln lo lp kh lq lr ls kl lt lu lv kp lw lx ly lz dt translated">运行前端。</h2><p id="2bda" class="pw-post-body-paragraph jy jz ht ka b kb ma iu kd ke mb ix kg kh mc kj kk kl md kn ko kp me kr ks kt hm dt translated">要运行该应用程序，请在您的终端中键入:</p><pre class="jj jk jl jm fq ku kv kw kx aw ky dt"><span id="624b" class="kz la ht kv b fv lb lc l ld le">$ npm start</span></pre><p id="91e6" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">然后，在浏览器中打开<code class="eh mv mw mx kv b"><a class="ae lg" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a></code>。您应该会看到这个基本布局:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff my"><img src="../Images/5e8a1915022c165d8ff660de86d2449a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*7xLXQ0Ks-cRguvN1D_AkOA.png"/></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Basic Layout of our app.</figcaption></figure><h2 id="4317" class="kz la ht bd lh li lj lk ll lm ln lo lp kh lq lr ls kl lt lu lv kp lw lx ly lz dt translated"><strong class="ak">连接浏览器钱包。</strong></h2><p id="4275" class="pw-post-body-paragraph jy jz ht ka b kb ma iu kd ke mb ix kg kh mc kj kk kl md kn ko kp me kr ks kt hm dt translated">注意:我假设你的浏览器扩展中已经有一个钱包。</p><p id="a29a" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">当然，我们想连接一个钱包。点击“连接”按钮调用<code class="eh mv mw mx kv b">activateBrowserWallet()</code>功能。让我们看看它的实际效果。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff mz"><img src="../Images/0af2de2df68b8630dfbdd51b473970b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*Gy0uOpaZpLCQUnvk3XdQtg.gif"/></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Connecting MetaMask with our simple App.</figcaption></figure><p id="ab35" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">完美！我们的连接按钮工作正常。让我来分析一下发生了什么:</p><ul class=""><li id="0085" class="mh mi ht ka b kb kc ke kf kh mj kl mk kp ml kt mm mn mo mp dt translated">我点击“连接”,给<code class="eh mv mw mx kv b">activateBrowserWallet()</code>打电话</li><li id="5067" class="mh mi ht ka b kb mq ke mr kh ms kl mt kp mu kt mm mn mo mp dt translated">将弹出一个元掩码窗口，</li><li id="6b4b" class="mh mi ht ka b kb mq ke mr kh ms kl mt kp mu kt mm mn mo mp dt translated">我选择一个我想连接到我的应用程序的帐户，然后单击“下一步”，</li><li id="0828" class="mh mi ht ka b kb mq ke mr kh ms kl mt kp mu kt mm mn mo mp dt translated">我确认要连接到我的应用程序，</li><li id="ac33" class="mh mi ht ka b kb mq ke mr kh ms kl mt kp mu kt mm mn mo mp dt translated">我的帐户已连接。</li></ul><p id="8f26" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">让我们看看断开后会发生什么。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff mz"><img src="../Images/c08f779cfa1b0a581d1f6b51def4df4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*J3inoPwgmkNbh6U6MzzXBQ.gif"/></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Disconnecting and Connecting back. MetaMask doesn’t pop up anymore.</figcaption></figure><p id="8a3d" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">当我们点击“断开”按钮时，我们调用<code class="eh mv mw mx kv b">deactivate()</code>函数。它将变量<code class="eh mv mw mx kv b">account</code>设置为未定义。但是当我们再次尝试连接时，不再有MetaMask弹出窗口。是因为Metamask记得我们用app连接了一个账号。它节省时间。使用Web 3应用程序时，您不希望总是确认您允许MetaMask使用该应用程序。</p><p id="e3e8" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">要断开应用程序，我们应该在MetaMask本身中完成。让我告诉你怎么做。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff mz"><img src="../Images/654f6de0da8c16ba2535a195619a9308.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*02PQ-ff_uKntx93RcmUiDg.gif"/></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Disconnecting the application through MetaMask.</figcaption></figure><p id="e4f1" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">通过元掩码断开连接后，我们又回到了起点。下次点击“连接”时，MetaMask会再次弹出，要求您确认。</p><h2 id="9bc1" class="kz la ht bd lh li lj lk ll lm ln lo lp kh lq lr ls kl lt lu lv kp lw lx ly lz dt translated">最后的想法</h2><p id="6ed2" class="pw-post-body-paragraph jy jz ht ka b kb ma iu kd ke mb ix kg kh mc kj kk kl md kn ko kp me kr ks kt hm dt translated">你有它！您学习了如何使用useDapp库将浏览器钱包连接到您的应用程序。虽然这个库很实用，但是它有纯文档。希望它的开发者早点管起来。</p><p id="6333" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">连接钱包不足以创建Web 3应用程序。然而，我无法想象没有这种能力的人。</p><blockquote class="na"><p id="0f65" class="nb nc ht bd nd ne nf ng nh ni nj kt ek translated"><em class="nk">加入Coinmonks </em> <a class="ae lg" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank"> <em class="nk">电报频道</em> </a> <em class="nk">和</em> <a class="ae lg" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> <em class="nk"> Youtube频道</em> </a> <em class="nk">了解加密交易和投资</em></p></blockquote><h1 id="ab5f" class="nl la ht bd lh nm nn no ll np nq nr lp iz ns ja ls jc nt jd lv jf nu jg ly nv dt translated">另外，阅读</h1><ul class=""><li id="0a83" class="mh mi ht ka b kb ma ke mb kh nw kl nx kp ny kt mm mn mo mp dt translated"><a class="ae lg" rel="noopener" href="/coinmonks/3commas-review-an-excellent-crypto-trading-bot-2020-1313a58bec92">3商业评论</a> | <a class="ae lg" href="https://coincodecap.com/pionex-review-exchange-with-crypto-trading-bot" rel="noopener ugc nofollow" target="_blank"> Pionex评论</a> | <a class="ae lg" rel="noopener" href="/coinmonks/coinrule-review-2021-a-beginner-friendly-crypto-trading-bot-daf0504848ba"> Coinrule评论</a></li><li id="df7c" class="mh mi ht ka b kb mq ke mr kh ms kl mt kp mu kt mm mn mo mp dt translated"><a class="ae lg" rel="noopener" href="/coinmonks/ledger-vs-ngrave-zero-7e40f0c1d694">莱杰vs n rave</a>|<a class="ae lg" rel="noopener" href="/coinmonks/ledger-nano-s-vs-x-battery-hardware-price-storage-59a6663fe3b0">莱杰nano s vs x </a> | <a class="ae lg" rel="noopener" href="/coinmonks/binance-review-ee10d3bf3b6e">币安评论</a></li><li id="7a30" class="mh mi ht ka b kb mq ke mr kh ms kl mt kp mu kt mm mn mo mp dt translated"><a class="ae lg" rel="noopener" href="/coinmonks/bybit-exchange-review-dbd570019b71"> Bybit Exchange审查</a> | <a class="ae lg" href="https://coincodecap.com/bityard-reivew" rel="noopener ugc nofollow" target="_blank"> Bityard审查</a> | <a class="ae lg" href="https://coincodecap.com/jet-bot-review" rel="noopener ugc nofollow" target="_blank"> Jet-Bot审查</a></li><li id="0f3e" class="mh mi ht ka b kb mq ke mr kh ms kl mt kp mu kt mm mn mo mp dt translated"><a class="ae lg" rel="noopener" href="/coinmonks/3commas-vs-pionex-vs-cryptohopper-best-crypto-bot-6a98d2baa203">3 commas vs crypto hopper</a>|<a class="ae lg" rel="noopener" href="/coinmonks/earn-crypto-interest-b10b810fdda3">赚取加密利息</a></li><li id="799c" class="mh mi ht ka b kb mq ke mr kh ms kl mt kp mu kt mm mn mo mp dt translated">最好的比特币<a class="ae lg" rel="noopener" href="/coinmonks/hardware-wallets-dfa1211730c6">硬件钱包</a> | <a class="ae lg" rel="noopener" href="/coinmonks/bitbox02-review-your-swiss-bitcoin-hardware-wallet-c36c88fff29"> BitBox02回顾</a></li><li id="c920" class="mh mi ht ka b kb mq ke mr kh ms kl mt kp mu kt mm mn mo mp dt translated"><a class="ae lg" rel="noopener" href="/coinmonks/blockfi-vs-celsius-vs-hodlnaut-8a1cc8c26630"> BlockFi vs摄氏</a> | <a class="ae lg" rel="noopener" href="/coinmonks/hodlnaut-review-best-way-to-hodl-is-to-earn-interest-on-your-bitcoin-6658a8c19edf"> Hodlnaut点评</a> | <a class="ae lg" href="https://coincodecap.com/kucoin-review" rel="noopener ugc nofollow" target="_blank"> KuCoin点评</a></li></ul></div></div>    
</body>
</html>