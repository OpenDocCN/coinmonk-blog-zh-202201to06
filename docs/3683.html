<html>
<head>
<title>An Intro To Near Dapp Development With Rust, WASM, Parcel and React -Part 3.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Rust，WASM，Parcel和React的近Dapp开发介绍-第3部分。</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/an-intro-to-near-dapp-development-with-rust-wasm-parcel-and-react-part-3-6e4782dce459?source=collection_archive---------9-----------------------#2022-03-29">https://medium.com/coinmonks/an-intro-to-near-dapp-development-with-rust-wasm-parcel-and-react-part-3-6e4782dce459?source=collection_archive---------9-----------------------#2022-03-29</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/48c783cd828edee511ee3a5978c78a2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sukc6HX0zVtmY8tJL8Eliw.jpeg"/></div></div></figure><div class=""/><p id="2461" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">本文用一个简单、实用、从头到尾的例子向现有的Web3开发人员介绍了Near协议，分为三个部分。</p><p id="d5e5" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">对于那些刚刚加入我们的人来说，请随意浏览一下本教程的前两部分以加快速度:</p><p id="ac4d" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">第1部分位于<a class="ae jz" rel="noopener" href="/coinmonks/an-intro-to-near-dapp-development-with-rust-wasm-parcel-and-react-part-1-e500a3abc597?source=friends_link&amp;sk=216f6365fcd46133ae278961c5260243"> <strong class="jd if">这里</strong> </a>，第2部分位于<a class="ae jz" rel="noopener" href="/coinmonks/an-intro-to-near-dapp-development-with-rust-wasm-parcel-and-react-part-2-6bd3a071b74e?source=friends_link&amp;sk=620e52f438cf57780e3c5de22044a704"> <strong class="jd if">这里</strong> </a> <strong class="jd if">。</strong></p><p id="9b40" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">这些文章的完整代码库可以在</strong>  <strong class="jd if">这里找到</strong> <a class="ae jz" href="https://github.com/Panasthetik/near-starter-app" rel="noopener ugc nofollow" target="_blank"> <strong class="jd if">。</strong></a></p><p id="1b69" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">上一次，我们通过编写一些Rust单元测试来运行我们的smart契约，继续我们在区块链附近的开发之旅。然后，我们在Near-CLI中创建了一个部署子帐户，将我们的合同部署到Near Testnet，并且能够在开发人员控制台中与它进行交互。</p><p id="de2c" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在本周的会议中，我们将把我们部署的智能合同与一个简单的React前端相集成。我们教程的这个JavaScript部分可以作为一个入门模板来适应您的需要(例如，您可以选择用Next.js或将来的另一个框架构建一个更全面、响应更快的界面)。</p><p id="a143" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">在我们切换到React / JavaScript之前的一些后续项目</strong></p><p id="2d14" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">正如上次会议结束时所提到的，在我们继续进行前端工作之前，还有一些“未解决的问题”需要与我们的合同部署联系起来。其中之一是解决当Rust代码发生变化或某些东西不能按预期工作时，我们如何在Near上“升级”我们的智能合同。</p><p id="0a19" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在区块链附近开发的优势之一是这种能力，可以重写Rust代码，重新编译到WASM，并且当我们需要在同一个契约地址完全替换契约。</p><p id="4d64" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果您还记得在实际部署契约之前，我们是如何首先在Near Testnet上创建子帐户的，您会注意到在VSCode终端中创建子帐户的以下代码:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="2088" class="kk kl ie kg b fv km kn l ko kp">near create-account near-starter-dapp.myaccount.testnet --masterAccount myaccount.testnet</span></pre><p id="43db" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">事实上，更新智能合同的过程首先取决于<strong class="jd if">删除</strong>该子账户——一旦子账户被删除，合同就从Testnet附近消失了，并且可以被替换。在VSCode终端中，输入:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="e79b" class="kk kl ie kg b fv km kn l ko kp">near delete near-starter-dapp.myaccount.testnet myaccount.testnet</span></pre><p id="1ec5" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">请注意，您不必像创建子账户一样在这里填写“主账户”。只要您仍然使用主帐户登录Near，您就有权删除您用它创建的任何子地址，如上所述。</p><p id="d1e8" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">在</strong>附近升级/更换智能合同</p><p id="ee42" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们现在需要做的第一件事是使用与之前相同的过程再次重新创建相同的子帐户(如上所示):</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="1df8" class="kk kl ie kg b fv km kn l ko kp">near create-account near-starter-dapp.myaccount.testnet --masterAccount myaccount.testnet</span></pre><p id="6131" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">当然，您可以用不同的方式命名新的子帐户，或者在Testnet上的单独子帐户名称下保存合同本身的替代版本。</p><p id="51a6" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">但是，每次升级时删除并重新创建smart contract子帐户通常是一种好的做法，这样可以让Near上的事情更有条理。通过这种方式，我们减少了区块链上浪费的、重复的、不在使用的合同！</p><p id="ed33" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">重要提示:<em class="ka">现在我们又创建了一个空账户来包含智能合约，我们可以在Rust中进行修改了。我会把任何潜在的编辑留给开发人员，但一旦我们改变了Rust代码，我们还需要删除“res”文件夹中的WASM文件，然后再用我们的构建脚本重新编译它。继续之前，请仔细检查“res”文件夹，确保它是空的！</em></p><p id="09af" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">从“res”文件夹中删除以下内容后，您的Rust发生变化…</p><p id="5ef9" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">" res/near_starter_dapp.wasm "</p><p id="d50a" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们用我们在教程中一直使用的相同的构建脚本重新编译我们新修订的Rust代码:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="fcdb" class="kk kl ie kg b fv km kn l ko kp">bash ./build.sh</span></pre><p id="2ace" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">编译完成后，您应该在“res”中有一个新的、更新的WASM文件。然后，我们可以像以前一样再次运行部署命令:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="bbe5" class="kk kl ie kg b fv km kn l ko kp">near deploy --accountId near-starter-dapp.myaccount.testnet --wasmFile res/near_starter_dapp.wasm</span></pre><p id="7ac9" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果一切顺利，您应该会在终端中再次看到与上次一样的部署确认屏幕:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="8412" class="kk kl ie kg b fv km kn l ko kp">Starting deployment. Account id: near-starter-dapp.myaccount.testnet, node: https://rpc.testnet.near.org, helper: https://helper.testnet.near.org, file: res/near_starter_dapp.wasm</span><span id="330c" class="kk kl ie kg b fv kq kn l ko kp">Transaction Id 3fqzA9vpuKSSsrBry9jE2k2FjoKFZBCdwPU38fTcPVkTTo </span><span id="209d" class="kk kl ie kg b fv kq kn l ko kp">see the transaction in the transaction explorer, please open this url in your browser</span><span id="4505" class="kk kl ie kg b fv kq kn l ko kp">https://explorer.testnet.near.org/transactions/3fqzA9vpuKSSsrBry9jE2k2FjoKFZBCdwPU38fTcPVkT</span></pre><p id="5b34" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">注意:您的具体交易ID将与上述不同！</p><p id="5946" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">为了完善我们的“未解决的问题”，在开发Near时经常出现的最后一个问题是:</p><p id="d219" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">"我在区块链部署的合同地址的最长十六进制字符串在哪里？"</p><p id="df97" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">"你知道，就是我需要在我的React应用程序中调用的那个？"</p><p id="a6a7" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">“我没有在终端中看到像EVM链上的Truffle/Hardhat那样的大十六进制字符串(甚至也没有像Solana上的Anchor那样的长十六进制字符串)。”</p><p id="1f68" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">答案是:<em class="ka">对于契约实例，Near上没有长而复杂的十六进制字符串</em>——我们已经为契约保留了一个人类可读的地址！请记住，为了在Near上部署合同，我们创建了以下子帐户:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="db09" class="kk kl ie kg b fv km kn l ko kp">near-starter-dapp.myaccount.testnet</span></pre><p id="5453" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这是我们将粘贴到React应用程序中来调用我们的函数的<em class="ka">实际地址</em>——这里不需要跟踪复杂的十六进制字符串！这将是相同类型的可读合同地址，只要它可用。例如，它可能是这样的:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="0481" class="kk kl ie kg b fv km kn l ko kp">near-starter.myaccount.near</span></pre><p id="f4b6" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">因此，现在我们已经了解了如何在Near Testnet上“升级”我们的智能契约，并且我们了解了更多关于契约地址如何工作的信息，我们准备切换到React/JavaScript来与一个简单的前端模板集成！</p><p id="b231" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">为前端集成设置目录和配置文件</strong></p><p id="d8c5" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们需要做的第一件事是在我们的文件夹结构中向上移动一级，从“合同”文件夹(保存项目的Rust/WASM部分的文件夹)进入我们的根目录:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="6d02" class="kk kl ie kg b fv km kn l ko kp">cd ../</span><span id="7237" class="kk kl ie kg b fv kq kn l ko kp">near-starter-dapp $</span></pre><p id="ca62" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">一旦我们进入这个根目录(near-starter-dapp ),让我们用如下依赖项创建一个“package.json”文件:</p><figure class="kb kc kd ke fq hv"><div class="bz el l di"><div class="kr ks l"/></div></figure><p id="0096" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">正如我们所见，与其他教程相比，这个列表非常简洁。原因是我使用了package 2.0+进行捆绑、传输和开发服务器，这消除了对“Babel”、“Bundler”和许多其他常见依赖项的需要。</p><p id="15b5" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这为您提供了一个基本的、可工作的开发模板，它在本地端口上的浏览器中运行，并且可以在以后为最终的产品版本进行增强。</p><p id="9a7e" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在让我们在Yarn中运行我们的JS依赖项安装程序(或者NPM，如果你喜欢的话——我将在这里使用Yarn):</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="4e34" class="kk kl ie kg b fv km kn l ko kp">near-starter-dapp $</span><span id="8c6e" class="kk kl ie kg b fv kq kn l ko kp">yarn</span></pre><p id="288f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在我们的项目依赖项已经安装好了，我们需要再创建两个文件，它们的行为类似于您在Anchor、Hardhat或Truffle中找到的其他配置文件。通常这些是其他框架中的“配置”文件，它们标识网络信息、钱包配置和前端的契约ID。</p><p id="ff79" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在根目录(near-starter-dapp)中，创建一个“src”文件夹:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="0483" class="kk kl ie kg b fv km kn l ko kp">near-starter-dapp $</span><span id="2d9e" class="kk kl ie kg b fv kq kn l ko kp">mkdir src</span><span id="faf8" class="kk kl ie kg b fv kq kn l ko kp">cd src</span></pre><p id="e1a3" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">对于我们的Near配置文件，第一个应该是我们新的“src”目录中的以下内容。我们将这个文件命名为“config.js”:</p><p id="2876" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">配置文件</p><figure class="kb kc kd ke fq hv"><div class="bz el l di"><div class="kr ks l"/></div></figure><p id="198e" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这个文件做两件事:</p><ol class=""><li id="44d5" class="kt ku ie jd b je jf ji jj jm kv jq kw ju kx jy ky kz la lb dt translated">它定义了我们的Dapp将通过契约地址(CONTRACT_NAME)调用的智能契约。您可以看到顶部的指定合同地址与我们预订/部署的地址相同！在所有情况下，这应该与您在部署时使用的任何地址相匹配。</li><li id="8c6c" class="kt ku ie jd b je lc ji ld jm le jq lf ju lg jy ky kz la lb dt translated">它列出了Near的网络配置。在我们的例子中，我们只使用Testnet配置(与配置中的“开发”相同)，但是最好在这个文件中包含所有选项(包括Mainnet)以供将来参考。</li></ol><p id="51c8" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们将在“src”文件夹中创建的下一个文件是一个API连接器文件。它初始化钱包、活动帐户ID和智能合约本身。它还定义了我们将使用Dapp调用的函数。我们将该文件命名为“utils.js ”,如下所示:</p><p id="d62f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">实用工具</p><figure class="kb kc kd ke fq hv"><div class="bz el l di"><div class="kr ks l"/></div></figure><p id="8d64" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这里需要注意的一些重要代码行是第19–24行:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="567e" class="kk kl ie kg b fv km kn l ko kp">window.contract = await newContract(window.walletConnection.account(), nearConfig.contractName, { <br/>viewMethods: ["exhibition_count"],    <br/>changeMethods: ['add_exhibition', 'add_vote', 'list_exhibitions', })</span></pre><p id="e350" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在此代码块中，我们列出了我们将需要在前端应用程序中调用的每个智能合约函数，它们分为“查看方法”(只读且不更改合约状态的方法)和“更改方法”(启动状态更改的函数)。</p><p id="aaa5" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">当然，当我们扩展我们的Rust代码和构建我们的项目时，我们可以添加到这个函数列表中，然后在React中，我们也可以为我们的前端加入相应的功能。</p><p id="71a4" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">只要确保你在Testnet上“升级”了合同(就像我们在上面学到的那样)，如果你在Rust上做了任何进一步的改变！</p><p id="3ee3" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">编写反应组件</strong></p><p id="30e1" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在我们处理“App.js”和React的一些组件文件之前，让我们首先将一些我们需要的通用文件添加到我们的“src”目录中——“index . js”、“index.html”和“global.css”:</p><p id="237d" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">索引. js</p><figure class="kb kc kd ke fq hv"><div class="bz el l di"><div class="kr ks l"/></div></figure><p id="bcc1" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">index.html</p><figure class="kb kc kd ke fq hv"><div class="bz el l di"><div class="kr ks l"/></div></figure><p id="b5ae" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">global.css</p><figure class="kb kc kd ke fq hv"><div class="bz el l di"><div class="kr ks l"/></div></figure><p id="5c8a" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们的基本文件已经完成，现在我们将把注意力集中在App.js文件上，这是Dapp的主要入口文件。在我们的“src”文件夹中，添加以下内容:</p><p id="0310" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">App.js</p><figure class="kb kc kd ke fq hv"><div class="bz el l di"><div class="kr ks l"/></div></figure><p id="b0fc" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">完成App.js文件后，我们可以将最后两个文件添加到一个新的“components”子目录中。首先在“src”目录下创建一个新文件夹“components ”:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="e23a" class="kk kl ie kg b fv km kn l ko kp">near-starter-dapp/src $</span><span id="df26" class="kk kl ie kg b fv kq kn l ko kp">mkdir components</span><span id="483f" class="kk kl ie kg b fv kq kn l ko kp">cd components</span></pre><p id="4d9d" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在新的“components”文件夹中，我们将创建文件“CreateEvents.js”和“ListEvents.js”:</p><p id="e8e0" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">CreateEvents.js</p><figure class="kb kc kd ke fq hv"><div class="bz el l di"><div class="kr ks l"/></div></figure><p id="4d12" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">列表事件. js</p><figure class="kb kc kd ke fq hv"><div class="bz el l di"><div class="kr ks l"/></div></figure><p id="7002" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果我们回头参考我们的Rust代码以及特定的函数调用和变量，我们可以在上面的文件中识别出我们在Rust中编写的特定项目:</p><p id="ddcb" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">信任函数:添加事件、添加投票、列表事件</p><p id="1368" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">信任变量:估计预算、总票数、标题、id、描述</p><p id="5e20" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">创建所有这些文件并添加到适当的目录后，我们最终的文件结构应该是:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="555f" class="kk kl ie kg b fv km kn l ko kp">"near-starter-dapp" root folder:</span><span id="931d" class="kk kl ie kg b fv kq kn l ko kp">near-starter-dapp--|<br/>                   |contract<br/>                   |src<br/>                   |package.json<br/>                   |package-lock.json<br/>                   |node_modules</span><span id="4606" class="kk kl ie kg b fv kq kn l ko kp">"src" front end folder (in list above) w/ "components" sub-directory:</span><span id="b1ce" class="kk kl ie kg b fv kq kn l ko kp">src-------|<br/>          |global.css<br/>          |App.js<br/>          |utils.js<br/>          |config.js<br/>          |index.html<br/>          |index.js<br/>          |components--|<br/>                       |CreateEvents.js<br/>                       |ListEvents.js</span></pre><p id="735d" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">关于这个项目反应部分的一些想法</strong></p><p id="3a56" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">您会注意到，这个React示例基于您可能已经看到的现有Near tutorial模板，在功能和状态管理方面是一个非常<strong class="jd if">简单的例子。</strong></p><p id="a915" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">例如，我们只依赖“UseState”和“UseEffect”挂钩来更新区块链上的合同状态，在我们开始在浏览器窗口中显示页面之前，没有服务器端的页面呈现(或更高级的路由)。</p><p id="331c" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">正如我们将了解到的，对于生产来说，这肯定<strong class="jd if">不</strong>理想，因为在客户端刷新这个更新的状态信息会有一些延迟。</p><p id="c6e8" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">出于本教程的目的，我们假设可能需要不时地“刷新”浏览器窗口，以显示更新的合同状态。由于我们只在本地机器上启动它，我们对此没有意见，但是如果它是一个真实的生产部署，我们将需要实现更高级的React——使用上下文、路由器和/或Redux，或者其他一些用于状态管理的“存储”(例如:Next.js with SSR)来自动及时地预呈现页面。</p><p id="9b4a" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们还需要部署到数字海洋，Vultr，Heroku，Vercel或其他一些主机服务，将处理服务器端的高级节点应用程序。</p><p id="11d7" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然而，这超出了本教程的范围。这是将来另一篇Near文章的绝佳主题——特别是在前端使用Next.js扩展一个Near项目，并将服务器端部署到云！我期待这一领域的其他开发者做出贡献。</p><p id="5d87" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">(终于！)用包</strong>在我们的本地机器上启动我们的React Dapp</p><p id="525f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">因此，让我们确保我们在我们的根目录…</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="2946" class="kk kl ie kg b fv km kn l ko kp">near-starter-dapp $</span></pre><p id="4308" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后是“npm开始”或“纱线开始”:</p><pre class="kb kc kd ke fq kf kg kh ki aw kj dt"><span id="3ec6" class="kk kl ie kg b fv km kn l ko kp">npm start</span></pre><p id="0e55" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们应该在VSCode终端中看到以下内容:</p><figure class="kb kc kd ke fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/e498bf560b29b9ddec50e51963afbab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wtQ_VT1zquU9QK6LgMk2IQ.jpeg"/></div></div></figure><p id="30cd" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="ka">注意:确保你已经完全</em><strong class="jd if"><em class="ka"/></strong><em class="ka">“注销”了你之前可能加载的这个Dapp的任何版本。Near wallet接口中存在一个缺陷，如果智能合约代码发生更改或被替换，该缺陷将在循环中反复“强制”交易批准。目前正在诊断该问题的确切原因。</em></p><p id="f3eb" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果我们在localhost:1234的浏览器中确认(推荐使用Chrome或Firefox ),您将会看到我们Dapp的“登录”页面。</p><figure class="kb kc kd ke fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/a5281e56fad6fa7fc3e149ef34455bf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ak4QTAeCpWvmhCUjAoeImg.jpeg"/></div></div></figure><p id="3f45" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">继续使用Near Wallet照常登录(批准使用“localhost”应用程序登录Near Testnet的“交易”):</p><figure class="kb kc kd ke fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/3064bef1d9b81da52780ddbe18b0bf25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SjbEfHYx0J5oV6SVoPS1DQ.jpeg"/></div></div></figure><p id="81b2" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们进入“事件”屏幕:点击“添加事件”按钮，填写下拉切换反应表单:</p><figure class="kb kc kd ke fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/52a00bf67d7d3959d27cd556159508e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EVsA_E9gL6Q9ZRRJtn5fuA.jpeg"/></div></div></figure><p id="0689" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在活动表单中填写标题、建议预算和活动描述，并点击“提交”:</p><figure class="kb kc kd ke fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/3615557374eafa5710f2013dbaa96722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I5LL5etm9t2_ZknZRXYWPg.jpeg"/></div></div></figure><p id="9dfb" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们提交事件后，会有一个短暂的“重置”期(如上所述的等待时间),您可能需要<strong class="jd if">刷新</strong>浏览器，我们才能在主页上看到更新的事件列表:</p><figure class="kb kc kd ke fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/cfe2addb458820be61ec9daad3ada454.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rg-eEkyAbOyrBJkqIZMsZA.jpeg"/></div></div></figure><p id="596f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">要为项目添加“投票”,您可以点击“投票”按钮，<strong class="jd if">再次刷新</strong>页面，您投票的项目将出现更新的投票数。</p><p id="358e" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">一些结束语(以及改进的空间)</strong></p><p id="689d" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">因此，我们已经实现了一个非常基本的端到端解决方案来开始使用Near协议，我希望这整个教程对您和我来说都是愉快的。</p><p id="1dca" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我一直在考虑的一件事是在我们的契约逻辑中加入基于Rust的检查和平衡，虽然这可能是(又一个)完全不同的文章，但我们可能会在任何升级中包括以下内容:</p><ol class=""><li id="4e4c" class="kt ku ie jd b je jf ji jj jm kv jq kw ju kx jy ky kz la lb dt translated">Allow-listing for addresses:如果合同所有者要求对谁可以添加到平台上的事件列表进行一些限制，我们可以在Rust中实现检查，以汇集一个“批准的”用户列表。</li><li id="5085" class="kt ku ie jd b je lc ji ld jm le jq lf ju lg jy ky kz la lb dt translated">选民检查:类似于“允许列表”，这将强制执行“尚未投票”和“已经投票”的逻辑，以确保一个选民不能投票超过一次，或者“所有者”不能对他们自己的事件投票。</li><li id="3c6e" class="kt ku ie jd b je lc ji ld jm le jq lf ju lg jy ky kz la lb dt translated">本地令牌对事件平台上的项目的贡献:如果要为平台铸造一个具有初始供应的本地令牌，并且允许注册用户使用，我们可以相应地记录他们的事件捐赠。项目贡献的代币余额可以包含在我们的事件数据中。这些都可以在Rust中使用标准的FT令牌合同标准来完成。</li><li id="9509" class="kt ku ie jd b je lc ji ld jm le jq lf ju lg jy ky kz la lb dt translated">最后，正如我上面所描述的React部分的重新设计包含了类似Next.js的内容，重点是路由器、“GetStaticProps”和一些服务器端渲染(SSR ),这肯定会使我们的应用程序响应更快，并为真正的生产部署做好准备。为此，多页面设置也是有意义的，因为我们可以在Next.js中使用“slugs []”为每个事件生成一个单独的、唯一的页面。</li></ol><p id="cfc3" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们教程的第三部分也是最后一部分到此结束——感谢您完成这个项目。我鼓励您使用这个基本模板作为您近期开发之旅的基础，在您认为适合未来更强大的解决方案时，根据您的需求对其进行调整。</p><p id="1c76" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">再次感谢您的阅读，下次再见！。— Panasthetik。</p><p id="4107" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">资源:</strong></p><div class="hs ht fm fo hu lh"><a href="https://parceljs.org/" rel="noopener  ugc nofollow" target="_blank"><div class="li ab ej"><div class="lj ab lk cl cj ll"><h2 class="bd if fv z el lm eo ep ln er et id dt translated">网络零配置构建工具。</h2><div class="lo l"><h3 class="bd b fv z el lm eo ep ln er et ek translated">Parcel将出色的开箱即用开发体验与可扩展的架构相结合，可让您的项目…</h3></div><div class="lp l"><p class="bd b gc z el lm eo ep ln er et ek translated">parceljs.org</p></div></div><div class="lq l"><div class="lr l ls lt lu lq lv ia lh"/></div></div></a></div><div class="hs ht fm fo hu lh"><a href="https://reactjs.org/" rel="noopener  ugc nofollow" target="_blank"><div class="li ab ej"><div class="lj ab lk cl cj ll"><h2 class="bd if fv z el lm eo ep ln er et id dt translated">react——用于构建用户界面的JavaScript库</h2><div class="lo l"><h3 class="bd b fv z el lm eo ep ln er et ek translated">React使得创建交互式ui变得不那么痛苦。为应用程序中的每个状态设计简单的视图，并反应…</h3></div><div class="lp l"><p class="bd b gc z el lm eo ep ln er et ek translated">reactjs.org</p></div></div><div class="lq l"><div class="lw l ls lt lu lq lv ia lh"/></div></div></a></div><div class="hs ht fm fo hu lh"><a href="https://docs.near.org/docs/develop/basics/getting-started" rel="noopener  ugc nofollow" target="_blank"><div class="li ab ej"><div class="lj ab lk cl cj ll"><h2 class="bd if fv z el lm eo ep ln er et id dt translated">开始使用|靠近文档</h2><div class="lo l"><h3 class="bd b fv z el lm eo ep ln er et ek translated">NEAR平台上的开发分为两个主要类别:这里是对您…</h3></div><div class="lp l"><p class="bd b gc z el lm eo ep ln er et ek translated">docs.near.org</p></div></div></div></a></div><div class="hs ht fm fo hu lh"><a href="https://docs.rs/near-sdk/latest/near_sdk/" rel="noopener  ugc nofollow" target="_blank"><div class="li ab ej"><div class="lj ab lk cl cj ll"><h2 class="bd if fv z el lm eo ep ln er et id dt translated">near_sdk - Rust</h2><div class="lo l"><h3 class="bd b fv z el lm eo ep ln er et ek translated">智能合约可用的env区块链特定方法。这是一个包装器，围绕着一个低级…</h3></div><div class="lp l"><p class="bd b gc z el lm eo ep ln er et ek translated">文件</p></div></div><div class="lq l"><div class="lx l ls lt lu lq lv ia lh"/></div></div></a></div><div class="hs ht fm fo hu lh"><a href="https://www.rust-lang.org/" rel="noopener  ugc nofollow" target="_blank"><div class="li ab ej"><div class="lj ab lk cl cj ll"><h2 class="bd if fv z el lm eo ep ln er et id dt translated">锈</h2><div class="lo l"><h3 class="bd b fv z el lm eo ep ln er et ek translated">Rust速度惊人，内存效率高:没有运行时或垃圾收集器，它可以支持关键性能…</h3></div><div class="lp l"><p class="bd b gc z el lm eo ep ln er et ek translated">www.rust-lang.org</p></div></div><div class="lq l"><div class="ly l ls lt lu lq lv ia lh"/></div></div></a></div><blockquote class="lz"><p id="83cd" class="ma mb ie bd mc md me mf mg mh mi jy ek translated">加入Coinmonks <a class="ae jz" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jz" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="ee27" class="mj kl ie bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf dt translated">另外，阅读</h1><ul class=""><li id="ecc4" class="kt ku ie jd b je ng ji nh jm ni jq nj ju nk jy nl kz la lb dt translated"><a class="ae jz" href="https://coincodecap.com/buy-monero" rel="noopener ugc nofollow" target="_blank">如何购买Monero </a> | <a class="ae jz" href="https://coincodecap.com/idex-review" rel="noopener ugc nofollow" target="_blank"> IDEX评论</a> | <a class="ae jz" href="https://coincodecap.com/bitkan-trading-bot" rel="noopener ugc nofollow" target="_blank"> BitKan交易机器人</a></li><li id="4f51" class="kt ku ie jd b je lc ji ld jm le jq lf ju lg jy nl kz la lb dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/coindcx-review-8444db3621a2"> CoinDCX评论</a> | <a class="ae jz" href="https://coincodecap.com/crypto-margin-trading-exchanges" rel="noopener ugc nofollow" target="_blank">加密保证金交易交易所</a></li><li id="fa34" class="kt ku ie jd b je lc ji ld jm le jq lf ju lg jy nl kz la lb dt translated"><a class="ae jz" href="https://coincodecap.com/red-dog-casino-review" rel="noopener ugc nofollow" target="_blank">红狗赌场评论</a> | <a class="ae jz" href="https://coincodecap.com/swyftx-review" rel="noopener ugc nofollow" target="_blank"> Swyftx评论</a> | <a class="ae jz" href="https://coincodecap.com/coingate-review" rel="noopener ugc nofollow" target="_blank">造币厂评论</a></li><li id="5867" class="kt ku ie jd b je lc ji ld jm le jq lf ju lg jy nl kz la lb dt translated"><a class="ae jz" href="https://coincodecap.com/bookmap-review-2021-best-trading-software" rel="noopener ugc nofollow" target="_blank"> Bookmap评论</a> | <a class="ae jz" href="https://coincodecap.com/crypto-exchange-usa" rel="noopener ugc nofollow" target="_blank">美国5大最佳加密交易所</a></li><li id="8206" class="kt ku ie jd b je lc ji ld jm le jq lf ju lg jy nl kz la lb dt translated"><a class="ae jz" href="https://coincodecap.com/ftx-futures-trading" rel="noopener ugc nofollow" target="_blank">如何在FTX交易所交易期货</a> | <a class="ae jz" href="https://coincodecap.com/okex-vs-binance" rel="noopener ugc nofollow" target="_blank"> OKEx vs币安</a></li></ul></div></div>    
</body>
</html>