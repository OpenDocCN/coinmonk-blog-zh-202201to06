<html>
<head>
<title>Predicting Bitcoin price with and without Sentiment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测有情绪和没有情绪的比特币价格</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/predicting-bitcoin-price-with-and-without-sentiment-697710760f3b?source=collection_archive---------1-----------------------#2022-04-30">https://medium.com/coinmonks/predicting-bitcoin-price-with-and-without-sentiment-697710760f3b?source=collection_archive---------1-----------------------#2022-04-30</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/1805e536fda3da0b3e920adc9e03e909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6NOLBGOcy4LMFiTkuzg02g.png"/></div></div></figure><h1 id="79da" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">TL；速度三角形定位法(dead reckoning)</h1><p id="0cab" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">这篇文章专注于使用深度学习模型来试验使用新闻来源预测比特币情绪，然后将该情绪应用于比特币价格预测模型，该模型使用区块链特征，如交易数量、哈希率、内存池大小等。(即不仅仅是市场价格)。然后对结果进行分析，以确定情绪对预测模型准确性的影响。如果你需要一本入门书，我在这里提供了单词嵌入、长短记忆(LSTM)网络和卷积神经网络(CNN)的简要概述。</p><p id="7c61" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">该代码可在https://github.com/pahurlocker/bitcoin-price-prediction的<a class="ae kx" href="https://github.com/pahurlocker/bitcoin-price-prediction" rel="noopener ugc nofollow" target="_blank">获得。在以后的文章中，我会写更多关于代码和模型特性的内容。Python、Tensorflow、scikit-learn、</a><a class="ae kx" href="https://optuna.org/" rel="noopener ugc nofollow" target="_blank"> Optuna </a>和<a class="ae kx" href="https://github.com/capitalone/rubicon-ml" rel="noopener ugc nofollow" target="_blank"> Rubicon ML </a>用于实现。</p><p id="f990" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated"><strong class="kb hu">*免责声明</strong> —本文仅用于信息和教育目的，不应被视为财务建议。我没有使用这些模型的预测来做交易决定，也不建议其他人这样做。</p><h1 id="1599" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">介绍</h1><p id="9026" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">预测任何金融工具的近期价格波动都是一项艰巨的任务，尤其是像比特币这样的加密货币那样波动的金融工具。单单技术分析就忽略了构成市场情绪的人类互动，而这种互动会对市场的运动产生重大影响。情绪是一个重要因素，但很难有效及时地捕捉，因为它来自许多不同的来源，并具有不同程度的影响。</p><p id="79a2" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">衡量加密货币领域情绪的重点主要集中在不太权威的声音上，这些声音通常来自Twitter或Reddit等社交媒体平台上的各种影响者。随着加密货币成为主流，权威和可信的新闻来源将在塑造市场情绪方面发挥越来越重要的作用。这促使我尝试确定权威新闻来源的情绪对预测比特币价格的影响。下图显示了在用于训练和测试所开发模型的时间段内比特币的价格。极易波动！</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ld"><img src="../Images/b0e3c4a28ad3e655d78e9a36666fe75b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oWTAXUogChUmXEh7"/></div></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Bitcoin price between January 1, 2021 and November 5, 2021.</figcaption></figure><h1 id="eaea" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">方法</h1><p id="967b" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">这项实验通过确定是否可以通过添加情绪数据来提高仅使用技术时间序列信息的深度学习预测模型的准确性，来检查新闻文章的情绪和比特币价格之间的相互作用。这需要建立一个成功预测新闻文章情绪的模型，并将这些特征添加到预测比特币价格(回归)和比特币价格会上升还是下降(分类)的模型中。在这篇文章中，我主要关注回归模型。</p><p id="a49e" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">平均绝对百分比误差(MAPE)用于测量回归模型的性能，准确度用于测量分类模型的性能。以下是MAPE和精确度的计算:</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lm"><img src="../Images/0109588cc9ce3a73e782fe54fede9e20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EkHZsSbs64Q2tarsvMf-1Q.png"/></div></div></figure><p id="42c9" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">系统流程如下图所示，代码可在<a class="ae kx" href="https://github.com/pahurlocker/bitcoin-price-prediction" rel="noopener ugc nofollow" target="_blank">https://github.com/pahurlocker/bitcoin-price-prediction</a>获得。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ln"><img src="../Images/3a56889be7075b748e54fce0c4360005.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_9n9lystV6JouEAZ"/></div></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Pipeline view of Bitcoin price prediction system.</figcaption></figure><p id="2690" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">自述文件提供了有关如何通过命令行执行系统不同阶段的详细信息。数据包括在内，Optuna用于超参数优化，因此您可以运行自己的实验，并根据需要调整模型。</p><h1 id="447d" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">数据和特征工程</h1><p id="9489" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">比特币新闻数据收集自cryptonews-api.com，时间跨度为2021年1月1日至2021年11月5日。来自cryptonews-api.com的信息仅提供文章摘要，因此进一步的信息是使用Python报纸库搜集的。</p><p id="735e" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">最初的语料库包括该时间段的23，912条记录。福布斯、美国消费者新闻与商业频道电视台、比特币、雅虎财经、彭博市场和财经、路透社、福克斯商业、彭博科技、Coindesk和美国消费者新闻与商业频道的文章都被保留为新闻来源，导致语料库中共有16，162篇文章。训练集由两个特征组成，全文文本和极性(0表示负面，1表示正面)。使用80%的训练集和20%的测试集来拆分数据。</p><p id="69da" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">出于价格和信号预测的目的，从Blockchain.com收集了比特币区块链信息。Blockchain.com API拥有丰富的市场数据，分为四类:货币统计、市场信号、区块详情、挖掘信息和网络活动。这些指标每天都有，检索时间与新闻文章相同，从2021年1月1日到2021年11月5日。两种类型的技术指标，简单移动平均线和指数移动平均线，是使用每日比特币价格计算的。计算了10天和50天简单和指数移动平均价格的特征。</p><p id="e0dc" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">情感分析模型在2021年1月1日至2021年6月6日之间的新闻语料数据上进行训练。然后使用训练好的情感模型预测2021年6月7日至2021年11月5日新闻的情感(1代表积极，0代表消极)。然后，对每篇新闻文章的预测情绪进行每天的平均，并与同一时期的比特币区块链数据合并。这些数据为比特币价格回归和分类模型提供了基础，训练集和测试集各占70%和30%。</p><h1 id="8614" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">实验</h1><p id="c931" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">本节详细介绍了用于情绪分析和比特币价格预测和分类的数据准备、系统和模型，以及每个阶段的结果。各种深度学习架构被用于情绪分析、价格和信号预测，这些可以在代码库中更详细地查看。支持该实验的系统具有以下流程:</p><ul class=""><li id="1196" class="lo lp ht kb b kc ky kg kz kk lq ko lr ks ls kw lt lu lv lw dt translated">检索并保存原始新闻语料库和区块链数据(2021年1月1日至2021年11月5日)</li><li id="6a10" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">将训练数据分段用于情感分析，并执行80/20训练/测试分割(2021年1月1日和2021年6月6日)</li><li id="d6c8" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">使用超参数优化训练情感模型</li><li id="bb8d" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">坚持表现最佳的情感模型</li><li id="5ac4" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">预测每天(2021年6月7日和2021年11月5日)的新闻语料库和平均值的情绪</li><li id="960d" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">通过将预测的情绪值与区块链数据合并，准备用于价格回归和分类的训练数据，并执行80/20训练/测试分割(2021年6月7日和2021年11月5日)</li><li id="1c6a" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">使用带有和不带有情绪数据的超参数优化来训练价格回归和分类模型，以确定对模型准确性的影响</li></ul><h1 id="f0a1" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">情感分析</h1><h2 id="5b91" class="mc jc ht bd jd md me mf jh mg mh mi jl kk mj mk jp ko ml mm jt ks mn mo jx mp dt translated">数据准备</h2><p id="2285" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">为了准备用于情感分析的数据，所有单词都被转换为小写，并且数字、标点符号和停用词都被删除。Keras tokenizer用于将文本转换为向量，并填充长度为100的序列。记号赋予器被保存为pickle文件，以便在稍后阶段使用训练好的模型进行预测。使用80%的训练集和20%的测试集来拆分数据。</p><h2 id="e3ee" class="mc jc ht bd jd md me mf jh mg mh mi jl kk mj mk jp ko ml mm jt ks mn mo jx mp dt translated">深度学习模型</h2><p id="f5be" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">LSTM和CNN模型的第一层利用嵌入层。每个嵌入层的词汇大小设置为10，000，输入长度为100，这与每个序列的填充相匹配。嵌入层每次都结合LSTM和CNN模型进行训练。每个模型的最终层利用具有1个单位和sigmoid激活的致密层。使用二进制交叉熵作为损失函数，使用准确度来衡量模型的性能。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/5a17a81a2baeb3c52147513c34663715.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/0*IrRR8_33LLYdq8Y7"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Sentiment analysis model architectures.</figcaption></figure><h1 id="08f7" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated"><strong class="ak">价格和信号预测的深度学习模型</strong></h1><h2 id="9536" class="mc jc ht bd jd md me mf jh mg mh mi jl kk mj mk jp ko ml mm jt ks mn mo jx mp dt translated">数据准备</h2><p id="6e31" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">为了准备回归和分类模型的数据，使用时间步长<em class="mr"> t </em>和特征<em class="mr"> f </em>将数据整形为序列<em class="mr"> S </em>，如下图所示。数据准备过程产生<em class="mr">天数</em> - <em class="mr"> t- </em> 1序列<em class="mr"> S </em>。有20个<em class="mr"> f </em>和用于回归的目标变量价格，21个<em class="mr"> f </em>和用于分类的目标变量信号。因此，每个<em class="mr"> f </em>都包含在长度为20或21的每日值向量中。当添加情感特征时，有21个和22个特征用于回归和分类。实验值为5、10和20的<em class="mr"> t </em>的数量决定了每个时间步中包含多少个大小为<em class="mr"> f </em>的特征向量。每个<em class="mr"> S </em>或<em class="mr">S【I】</em>中有<em class="mr"> t </em>个特征向量。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div class="fe ff ms"><img src="../Images/e8e4d71833f8edf7604afa8edaf30656.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/0*876E8MZW2pTL7Dyl"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Example structure of data processed with 5 time steps <em class="mt">t</em> into 994 sequences <em class="mt">S</em> with 20 features <em class="mt">f </em>in each daily vector.</figcaption></figure><p id="e522" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">第t + 1天的价格或信号是通过使用前t天的特征向量来预测的。例如，当为回归模型选择5天时间步长时，第6天之前的5个特征向量(<em class="mr"> t </em> +1)用于预测第6天的价格。使用70%的训练集和30%的测试集来拆分数据。使用scikit-learn的最小-最大标度库对数据进行归一化。</p><h2 id="6de8" class="mc jc ht bd jd md me mf jh mg mh mi jl kk mj mk jp ko ml mm jt ks mn mo jx mp dt translated">深度学习模型</h2><p id="aea9" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">每个模型中的层数保持不变，因为早期的实验表明，额外的层数会由于过度拟合而对模型性能产生负面影响。RNN由单个LSTM输入层、泄漏ReLu激活层、下降层和具有一个输出单元的密集层组成。CNN由单个二维卷积层、平坦层和具有一个输出单元的密集层组成。线性活化用于回归的最终致密层，而sigmoid活化用于分类。损失函数对于回归是均方误差，对于分类是二元交叉熵。除了这两个模型之外，还开发了各种其他模型体系结构，每个模型的结果将在下面提供。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div class="fe ff mu"><img src="../Images/91f9d7c67204437f675af8b9f7ef3be8.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*62T_KvrIL1BmOzKQwxTCHQ.png"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Bitcoin price prediction model architectures.</figcaption></figure><h1 id="1866" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">实验结果</h1><h2 id="fdf6" class="mc jc ht bd jd md me mf jh mg mh mi jl kk mj mk jp ko ml mm jt ks mn mo jx mp dt translated">情感分析实验结果</h2><p id="c6dc" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">使用超参数优化对各种长短期记忆(LSTM)和卷积神经网络(CNN)模型架构执行实验。下表中的结果表明，表现最好的CNN模型略微优于表现最好的LSTM模型。CNN模型被选择用于向比特币价格回归和分类模型添加情绪特征。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mv"><img src="../Images/224e8d01a171600b69a499145d4e9cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tfNScd9Regq0d7ZB9xZv2w.png"/></div></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Best experiment results for sentiment analysis models with hyperparameter optimization.</figcaption></figure><p id="9a49" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">下图描绘了比特币的价格和表现最好的CNN模型预测的情绪。一天的平均情绪值在0.3到1之间。这些值被添加到区块链图表数据中，作为一个称为极性的特征。请注意，情绪值和比特币价格具有相似的波动模式。在大部分时间里，市场情绪也趋于0.5及以上。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ld"><img src="../Images/c1e2dffab2f7c46f4d17e98ac0a80c8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xVfbiMw2BHaNGh4i"/></div></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Bitcoin price and news sentiment between June 7, 2021 and November 5, 2021.</figcaption></figure><p id="6ed5" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">下图显示了价格和用于比特币价格预测的特征之间的相关性。虽然诸如块大小和散列率之类的特征与价格有更强的相关性，但是在价格和极性之间至少有适度的相关性。所以这些模型并不完美，当然有更好的情绪模型，但是对于这个实验来说已经足够了。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mw"><img src="../Images/cbae13d68aa1e00eb68567416722f0e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DUlbDOd3mpzg4vP4"/></div></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Spearman correlation of price, blockchain features and news sentiment.</figcaption></figure><h2 id="7fb1" class="mc jc ht bd jd md me mf jh mg mh mi jl kk mj mk jp ko ml mm jt ks mn mo jx mp dt translated">价格回归和分类实验结果</h2><p id="91f0" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">使用超参数优化执行实验，超参数的可能值如下表所示。实验中使用了1、5和10天的预测时间范围(回想一下数据准备部分)。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mx"><img src="../Images/9acfb066c5d6ef0dca0fc394946b3ad3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ai74T8Ci-LNp1R7VVILUCQ.png"/></div></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Hyperparameter settings for deep learning regression and classification models.</figcaption></figure><p id="7928" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">超参数优化(使用Optuna)用于执行150项训练研究，每项研究进行100次试验，预测1、5和10天，总共450项研究。每个时间步长值(5、10、20)和模型类型(LSTM和CNN)的研究数量相等。下表提供了每次试验中最佳性能模型的结果(粗体值是每个预测日和时间步长的最低值，下划线值是预测日的最佳值)。按照自述文件中的说明自己运行这些实验。以下是一些主要观察结果:</p><p id="203a" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated"><strong class="kb hu"> 1预测日</strong></p><ul class=""><li id="5ba6" class="lo lp ht kb b kc ky kg kz kk lq ko lr ks ls kw lt lu lv lw dt translated">整体最精确的模型，MAPE为0.0071</li><li id="4463" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">有情感的模型最准确</li><li id="8940" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">LSTM模型有更强的结果</li></ul><p id="df8e" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated"><strong class="kb hu"> 5个预测日</strong></p><ul class=""><li id="f36e" class="lo lp ht kb b kc ky kg kz kk lq ko lr ks ls kw lt lu lv lw dt translated">最精确的模型的MAPE为0.4853</li><li id="d53d" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">没有情感的模型最准确</li><li id="a1eb" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">LSTM模式表现最好，CNN模式紧随其后</li></ul><p id="dfad" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated"><strong class="kb hu"> 10天预测</strong></p><ul class=""><li id="08f3" class="lo lp ht kb b kc ky kg kz kk lq ko lr ks ls kw lt lu lv lw dt translated">最精确的模型的MAPE为1.0645</li><li id="8a35" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">没有情感的模型最准确</li><li id="e082" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">两种类型混合使用时，CNN模型表现最佳</li></ul><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff my"><img src="../Images/d497e5da1c7d22723eefb3e1e2272053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mpcv3Sz9b-Qx1u_X_TM9Sg.png"/></div></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Best experiment results predicting 5 days for deep learning regression models with and without sentiment using hyperparameter optimization.</figcaption></figure><p id="a723" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">下面的可视化表明，使用新闻情绪的模型对于1个预测日更准确，但是它对5天和10天的模型的准确性有负面影响。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ld"><img src="../Images/f10d39d816a0d77a596bbf47a8315b16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7Sj8sm6rH8t8QQbk"/></div></div></figure><p id="473c" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">我决定观察MAPE在所有研究中的分布，看看我是否能证明新闻情绪对模型准确性的重要性。请记住，使用Optuna的研究各有100项试验，因此我正在查看150项研究中这些试验的分布情况。如果这还不清楚，请查看代码并了解更多关于<a class="ae kx" href="https://optuna.org/" rel="noopener ugc nofollow" target="_blank"> Optuna </a>如何工作的信息。在所有预测日长的研究中，MAPE在0.007%到10%之间。下图导致了以下观察结果:</p><ul class=""><li id="d3d2" class="lo lp ht kb b kc ky kg kz kk lq ko lr ks ls kw lt lu lv lw dt translated">MAPE总体上是右倾的</li><li id="9b53" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">具有20个时间步长的CNN模型对所有预测的日期都有广泛的分布，并且显然不太准确</li><li id="4b59" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">具有5和10个时间步长的CNN模型对于所有预测的日期都是右偏的，并且更加准确</li><li id="d42b" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">20个时间步长的LSTM模型对所有预测日都是右偏的，这证明了它的“记忆”价值</li></ul><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ld"><img src="../Images/c646c7e1cfcf1f209c42496c4c46d976.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Fd0snl1CsuX_0HoO"/></div></div></figure><p id="c1a4" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">继续观察MAPE在所有研究中的分布，下图显示了在预测的第5天和第10天，带有情绪的模型的准确性逐渐下降。以下是主要观察结果:</p><ul class=""><li id="7c29" class="lo lp ht kb b kc ky kg kz kk lq ko lr ks ls kw lt lu lv lw dt translated">对于1个预测日，有和没有情绪的模型有一个右偏</li><li id="a244" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">预测第5天和第10天的情绪模型越来越不准确</li><li id="88a8" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">对于预测的第5天和第10天，不带情绪的模型比带情绪的模型更准确</li></ul><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ld"><img src="../Images/30974b51bcce3a7c360e4897ba8802c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rxhBx2xApj8APHYm"/></div></div></figure><h1 id="1eba" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">结论</h1><p id="637e" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">这个实验评估了情绪对比特币价格预测模型准确性的影响。这表明新闻情绪确实对比特币价格预测模型的预测能力有影响。我得出了以下结论:</p><ul class=""><li id="a1c6" class="lo lp ht kb b kc ky kg kz kk lq ko lr ks ls kw lt lu lv lw dt translated">比特币价格和新闻情绪之间存在相关性，包含它的模型达到了最高的准确性(这里没有大的启示！)</li><li id="44b0" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">新闻情绪显著提高了短期回归预测的准确性，因为它们成功地捕捉了情绪趋势(尤其是具有较大时间步长的LSTMs)</li><li id="974c" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">新闻情绪对长期回归预测的准确性有负面影响，因为它们正在失去情绪趋势</li></ul><p id="b29c" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">在本实验中，新闻情绪在较短时间范围内的益处以及新闻情绪在较长时间范围内的负面影响可能归因于时间序列数据不是静态的。鉴于新闻情绪和比特币价格的高度波动性，这些趋势可能会在相对较短的时间内消失，这导致不同时间范围内模型表现的微小但一致的差异。</p><p id="8fc0" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">作为这个实验的结果，可以得出一个推论，即在任何时间范围内，有效地捕捉新闻情绪趋势作为一个特征，将导致更准确的模型。然而，需要做更多的工作来验证这一假设。该项目和以下项目代表了与该工作相关的改进和额外研究的机会:</p><ul class=""><li id="e3b3" class="lo lp ht kb b kc ky kg kz kk lq ko lr ks ls kw lt lu lv lw dt translated">为情绪分析和价格预测任务尝试不同的模型架构，以提高准确性(参见代码回购，了解我在这里没有涉及的其他模型架构)</li><li id="2d54" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">引入社交媒体情绪分析，评估有无新闻情绪和社交媒体情绪对比特币价格预测的影响</li><li id="5a75" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">增加培训语料库中的天数</li><li id="df97" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">引入不同的回溯测试策略，以进一步验证结论(即通过超参数调整进行前向验证)</li><li id="c106" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">训练预测7、30、90等的模型。未来几天验证情绪趋势的假设</li><li id="97ee" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated">测试交易策略中表现最好的模型，以确定现实世界的适用性</li></ul><h1 id="e940" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">参考</h1><p id="70e4" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated"><strong class="kb hu">代码回购</strong>:【https://github.com/pahurlocker/bitcoin-price-prediction】T2(包括数据、代码、研究结果)</p><p id="bd0d" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">【Blockchain】比特币区块链数据来源:T4</p><p id="2db1" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated"><strong class="kb hu">新闻语料库数据来源</strong>:cryptonews-api.com</p><p id="3c06" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">Sezer、Omer Berat、Gudelek、Mehmet Ugur和Ozbayoglu、Ahmet Murat。<strong class="kb hu">“深度学习的金融时间序列预测:系统性文献综述:2005–2019。”</strong>arXiv.org，2019。<a class="ae kx" href="https://arxiv.org/abs/1911.13288" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1911.13288</a>。</p><p id="d856" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">布莱恩·佩里·卡雷拉。<strong class="kb hu">“情绪对比特币价格形成的影响。”</strong>，2018。<a class="ae kx" href="https://sites.duke.edu/djepapers/files/2018/06/brianperrycarrera-dje.pdf" rel="noopener ugc nofollow" target="_blank">https://sites . duke . edu/djepa pers/files/2018/06/brianperrycarrera-dje . pdf</a>。</p><p id="876b" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">Lamon，Connor，Nielsen，Eric，和Redondo，E. <strong class="kb hu">“使用新闻和社交媒体情绪的加密货币价格预测。”</strong>，2017。<a class="ae kx" href="http://cs229.stanford.edu/proj2017/final-reports/5237280.pdf" rel="noopener ugc nofollow" target="_blank">http://cs 229 . Stanford . edu/proj 2017/final-reports/5237280 . pdf</a>。</p><p id="daac" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">黄、辛、、、黄、唐雪娇、、Jayachander Surbiryala、Vasileios Iosifidis、、。<strong class="kb hu">“基于LSTM的加密货币预测情感分析”【arXiv.org 】, 2021年。<a class="ae kx" href="https://arxiv.org/abs/2103.14804v2" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/2103.14804v2</a>。</strong></p><p id="861c" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">卡拉维丘斯，维陶塔斯。<strong class="kb hu">“利用情绪分析预测日间比特币价格走势。”</strong> <em class="mr"> ResearchGate </em>，2017。<a class="ae kx" href="https://doi.org/10.1108%5C/JRF-06-2017-0092" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1108\/JRF-06-2017-0092</a>。</p><p id="e003" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">我是吴英东。<strong class="kb hu">“有效预测加密货币价格的新闻情感分析”</strong> <em class="mr">国际知识工程杂志</em> 5，第2期(2019):47–52。<a class="ae kx" href="https://doi.org/10.18178/ijke.2019.5.2.116" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.18178/ijke.2019.5.2.116</a>。</p><p id="fa83" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">罗格农、拉维尼娅、斯图尔特·海德和莎拉·张。<strong class="kb hu">“加密货币市场的新闻情绪:与外汇市场的实证比较”</strong> <em class="mr">《国际金融分析评论》</em>69(2020年5月):101462。【https://doi.org/10.1016/j.irfa.2020.101462】T4。</p><p id="d9b2" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">Ji，Suhwan，Jongmin Kim和Hyeonseung Im。<strong class="kb hu">“利用深度学习进行比特币价格预测的对比研究。”</strong>数学7，第10期(2019年9月25日):898。<a class="ae kx" href="https://doi.org/10.3390/math7100898" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.3390/math7100898</a>。</p><p id="db2d" class="pw-post-body-paragraph jz ka ht kb b kc ky ke kf kg kz ki kj kk la km kn ko lb kq kr ks lc ku kv kw hm dt translated">Sean McNally和Jason Roche，<strong class="kb hu">《利用机器学习预测比特币价格》。</strong> Euromicro并行、分布式和基于网络的处理国际会议(2018年3月):第26届。<a class="ae kx" href="http://norma.ncirl.ie/2496/1/seanmcnally.pdf" rel="noopener ugc nofollow" target="_blank">http://norma.ncirl.ie/2496/1/seanmcnally.pdf</a></p><blockquote class="mz"><p id="5b36" class="na nb ht bd nc nd ne nf ng nh ni kw ek translated">加入Coinmonks <a class="ae kx" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae kx" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="531e" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm nj jo jp jq nk js jt ju nl jw jx jy dt translated">另外，阅读</h1><ul class=""><li id="54f2" class="lo lp ht kb b kc kd kg kh kk nm ko nn ks no kw lt lu lv lw dt translated"><a class="ae kx" href="https://coincodecap.com/buy-monero" rel="noopener ugc nofollow" target="_blank">如何购买Monero </a> | <a class="ae kx" href="https://coincodecap.com/idex-review" rel="noopener ugc nofollow" target="_blank"> IDEX评论</a> | <a class="ae kx" href="https://coincodecap.com/bitkan-trading-bot" rel="noopener ugc nofollow" target="_blank"> BitKan交易机器人</a></li><li id="994f" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated"><a class="ae kx" rel="noopener" href="/coinmonks/coindcx-review-8444db3621a2"> CoinDCX评论</a> | <a class="ae kx" href="https://coincodecap.com/crypto-margin-trading-exchanges" rel="noopener ugc nofollow" target="_blank">加密保证金交易交易所</a></li><li id="109e" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated"><a class="ae kx" href="https://coincodecap.com/red-dog-casino-review" rel="noopener ugc nofollow" target="_blank">红狗赌场评论</a> | <a class="ae kx" href="https://coincodecap.com/swyftx-review" rel="noopener ugc nofollow" target="_blank"> Swyftx评论</a> | <a class="ae kx" href="https://coincodecap.com/coingate-review" rel="noopener ugc nofollow" target="_blank"> CoinGate评论</a></li><li id="7713" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated"><a class="ae kx" href="https://coincodecap.com/bookmap-review-2021-best-trading-software" rel="noopener ugc nofollow" target="_blank"> Bookmap评论</a> | <a class="ae kx" href="https://coincodecap.com/crypto-exchange-usa" rel="noopener ugc nofollow" target="_blank">美国5大最佳加密交易所</a></li><li id="104e" class="lo lp ht kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw dt translated"><a class="ae kx" href="https://coincodecap.com/ftx-futures-trading" rel="noopener ugc nofollow" target="_blank">如何在FTX交易所交易期货</a> | <a class="ae kx" href="https://coincodecap.com/okex-vs-binance" rel="noopener ugc nofollow" target="_blank"> OKEx vs币安</a></li></ul></div></div>    
</body>
</html>